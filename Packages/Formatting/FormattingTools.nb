Notebook[{

Cell[CellGroupData[{
Cell["Formatting", "CodeSection",
 CellChangeTimes->{{3.686498003918078*^9, 3.686498012014167*^9}, {
  3.697326882940727*^9, 
  3.697326884082457*^9}},ExpressionUUID->"2cfa20bc-8aec-4990-a4ad-\
19b74055da76"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PillImage\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.721887597201015*^9, 
  3.7218875999840727`*^9}},ExpressionUUID->"a6fe9907-2520-456f-84a5-\
029c53ed98ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PillImage", "::", "usage"}], "=", 
   "\"\<A little frame masked image to look like a pill\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PillGradientImage", "::", "usage"}], "=", 
   "\"\<Applies PillImage to LinearGradientImage\>\""}], ";"}]}], "CodeInput",
 
 CellChangeTimes->{{3.721887602090948*^9, 3.721887609111834*^9}, {
  3.7290969465031137`*^9, 
  3.7290969637495117`*^9}},ExpressionUUID->"b9618002-6199-47f9-924b-\
802d3027fa19"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NinePatchCreate\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.721872002795458*^9, 
  3.7218720071784773`*^9}},ExpressionUUID->"a7f25225-2c0f-47f1-84a0-\
4513efd796aa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NinePatchCreate", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Creates a NinePatch image for use in Appearance\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NinePatchNameTag", "::", "usage"}], "=", "\n", "\t", "\"\<\>\""}],
   ";"}]}], "CodeInput",
 CellChangeTimes->{{3.721872007846663*^9, 3.721872023146223*^9}, {
  3.721932473259704*^9, 
  3.721932476278216*^9}},ExpressionUUID->"66642a68-03b6-48d7-b7ab-\
4383eaf44c60"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Appearance Images\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697549367224042*^9, 
  3.697549370695856*^9}},ExpressionUUID->"cacf25f4-18cc-44d0-80d8-\
03b59c57a559"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"AppearanceReadyImage", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Converts an image into a background appearance for (say) a \
button\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientAppearance", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Converts a gradient type appearance\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FrameMasked", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Creates a mask with Framed for images\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6975493726005163`*^9, 3.6975493869274073`*^9}, {
  3.7004604301708937`*^9, 3.700460438709804*^9}, {3.700463178031394*^9, 
  3.7004631887800922`*^9}, {3.700463327024702*^9, 3.700463337035483*^9}, {
  3.7004862105360107`*^9, 3.700486224596422*^9}, {3.700503105716074*^9, 
  3.700503106043583*^9}},ExpressionUUID->"9093e810-5cf4-4221-9cf0-\
46fc1c4a1aa5"],

Cell[BoxData[
 RowBox[{"PackageScopeBlock", "[", "\n", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FramedButton", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<Formats a button in a frame\>\""}], ";", "\n", "\t", 
    RowBox[{
     RowBox[{"FramedPopupMenu", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<A popup menu that is also framed\>\""}], ";", "\n", "\t", 
    RowBox[{
     RowBox[{"FramedActionMenu", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<A popup menu that is also framed\>\""}]}], ",", "\n", "\t", 
   "\"\<Useless\>\""}], "\n", "\t", "]"}]], "CodeInput",
 CellChangeTimes->{{3.729096399266994*^9, 
  3.729096417104426*^9}},ExpressionUUID->"0ad3a75d-6d16-41b3-980a-\
f672809457a2"],

Cell[BoxData[
 RowBox[{"PackageScopeBlock", "[", "\n", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ColorizedAppearances", "::", "usage"}], "=", "\n", "\t", 
     "\"\<Colorizes appearance images\>\""}], ";", "\n", "\t", 
    RowBox[{
     RowBox[{"ColorizationAdjust", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<Adjusts the colorization so mouseover differences are more \
notable\>\""}], ";", "\n", "\t", 
    RowBox[{
     RowBox[{"ColoredButton", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<Formats a rounded button from a set of predefined choices\>\""}], 
    ";", "\n", "\t", 
    RowBox[{
     RowBox[{"ColoredButtonAppearances", "::", "usage"}], "=", "\n", "\t", 
     "\t", "\"\<Gets the appearance used by ColoredButton\>\""}], ";", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"ColoredPanel", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<Panel equivalent of ColoredButton\>\""}], ";", "\n", "\t", 
    RowBox[{
     RowBox[{"ColoredPanelAppearances", "::", "usage"}], "=", "\n", "\t", 
     "\t", "\"\<Gets the appearance used by ColoredPanel\>\""}], ";", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"ColoredPopupMenu", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<Formats a rounded popup menu using ColoredButton\>\""}], ";", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"ColoredActionMenu", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<Formats a rounded popup menu using ColoredButton\>\""}], ";", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"PopupDropDown", "::", "usage"}], "=", "\n", "\t\t", 
     "\"\<A label-less popup using the standard down-arrow appearance\>\""}], 
    ";", "\n", "\t", 
    RowBox[{
     RowBox[{"ActionDropDown", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<A label-less actionmenu using the standard down-arrow \
appearance\>\""}], ";", "\n", "\t", 
    RowBox[{
     RowBox[{"ButtonPopupMenu", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<A combination button/popup menu\>\""}], ";", "\n", "\t", 
    RowBox[{
     RowBox[{"ButtonActionMenu", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<A combination button/action menu\>\""}], ";", "\n", "\t", 
    RowBox[{
     RowBox[{"ButtonActionPopup", "::", "usage"}], "=", "\n", "\t", "\t", 
     "\"\<A combination button/action menu/popup menu\>\""}], ";"}], ",", 
   "\n", "\t", "\"\<Useless\>\""}], "\n", "\t", "]"}]], "CodeInput",
 CellChangeTimes->{{3.686498015326333*^9, 3.686498030172769*^9}, {
   3.686498245526528*^9, 3.6864982464195232`*^9}, {3.686679018603333*^9, 
   3.6866790420830317`*^9}, {3.688232597768529*^9, 3.688232598420755*^9}, {
   3.688234271311009*^9, 3.688234285730494*^9}, {3.689208153694433*^9, 
   3.689208180766549*^9}, {3.689776372481896*^9, 3.689776373544052*^9}, 
   3.6897764052972813`*^9, {3.694731918018347*^9, 3.694731939401544*^9}, {
   3.694740815723399*^9, 3.694740829759017*^9}, {3.696864454367996*^9, 
   3.6968645037375174`*^9}, {3.697327090885769*^9, 3.697327154603484*^9}, {
   3.6973309795198717`*^9, 3.697331003146343*^9}, {3.6973334592191277`*^9, 
   3.697333494190052*^9}, {3.6973870684514723`*^9, 3.697387182657527*^9}, {
   3.6974153791347017`*^9, 3.697415439512513*^9}, {3.697417926794259*^9, 
   3.697417951245247*^9}, {3.697549339324667*^9, 3.697549345633705*^9}, {
   3.6975497290543747`*^9, 3.69754973014602*^9}, {3.729096423603703*^9, 
   3.729096462686906*^9}, {3.72909654849588*^9, 
   3.729096552259159*^9}},ExpressionUUID->"e864f406-e13a-4670-b1ca-\
5b985a5e4e0f"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Gradient Buttons and Panels\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700492193990694*^9, 
  3.700492200125469*^9}},ExpressionUUID->"6f1a9acc-8675-43e4-9872-\
1abeb91fb706"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GradientPanelAppearance", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Turns a color into panel appearances\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPanel", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A panel with using GradientPanelAppearance\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonAppearance", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Turns a color into button appearances\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButton", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A button with using GradientButtonAppearance\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDropDownAppearance", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Turns two colors into an arrow dropdown\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPopupDropDown", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A popup menu using GradientDropDownAppearance\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientActionDropDown", "::", "usage"}], "=", "\n", "\t", 
   "\"\<An action menu using GradientDropDownAppearance\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPopupMenu", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A popup menu sticking together a GradientPanel and \
GradientPopupDropDown\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientActionMenu", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A popup menu sticking together a GradientPanel and \
GradientPopupDropDown\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonPopupMenu", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A combo Gradient(Button/Popup)\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonActionMenu", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A combo Gradient(Button/ActionMenu)\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonActionPopup", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A combo Gradient(Button/ActionMenu/Popup)\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonBar", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A button bar built on GradientButton\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientSetter", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A setter implemented on top of GradientButtonAppearances\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientSetterBar", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A setter bar based on GradientSetter\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDock", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A convenience function to build a DockedCell Row\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockedCell", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Builds a docked cell from a GradientDock\>\""}], ";"}]}], "CodeInput",
 
 CellChangeTimes->{{3.70049220068178*^9, 3.700492249623479*^9}, {
  3.7005030928942432`*^9, 3.700503175656571*^9}, {3.700504156240264*^9, 
  3.700504196961884*^9}, {3.700512627517212*^9, 3.700512650432909*^9}, {
  3.7005257513817663`*^9, 3.700525781352974*^9}, {3.700784681702886*^9, 
  3.70078468636101*^9}, {3.7007847835697803`*^9, 3.700784791007144*^9}, {
  3.700784834285454*^9, 3.7007848732084713`*^9}, {3.7013751691616507`*^9, 
  3.701375179496614*^9}, {3.7024907952055473`*^9, 3.70249081612073*^9}, {
  3.709248668260511*^9, 
  3.709248687172366*^9}},ExpressionUUID->"60f6e19b-c743-48cc-9ffb-\
67ab016bf949"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Other Interface Elements\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697549691074439*^9, 3.697549700450441*^9}, {
  3.697549803920742*^9, 
  3.697549804557975*^9}},ExpressionUUID->"bd65152b-0116-49a7-afce-\
a125c8571642"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PaneColumn", "::", "usage"}], "=", 
   "\"\<Formats a column in a pane and frame\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HyperlinkBrowse", "::", "usage"}], "=", 
   "\"\<Formats a PaneColumn of hyperlinks\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.686498015326333*^9, 3.686498030172769*^9}, {
   3.686498245526528*^9, 3.6864982464195232`*^9}, {3.686679018603333*^9, 
   3.6866790420830317`*^9}, {3.688232597768529*^9, 3.688232598420755*^9}, {
   3.688234271311009*^9, 3.688234285730494*^9}, {3.689208153694433*^9, 
   3.689208180766549*^9}, {3.689776372481896*^9, 3.689776373544052*^9}, 
   3.6897764052972813`*^9, {3.694731918018347*^9, 3.694731939401544*^9}, {
   3.694740815723399*^9, 3.694740816561796*^9}, {3.6975497689225073`*^9, 
   3.697549769104273*^9}},ExpressionUUID->"9b777b11-11a7-4ec1-bb83-\
b5bd76f47da3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CellOpenerView", "::", "usage"}], "=", 
   "\"\<Imitates opener WholeCellGroupOpener\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.686498015326333*^9, 3.686498030172769*^9}, {
   3.686498245526528*^9, 3.6864982464195232`*^9}, {3.686679018603333*^9, 
   3.6866790420830317`*^9}, {3.688232597768529*^9, 3.688232598420755*^9}, {
   3.688234271311009*^9, 3.688234285730494*^9}, {3.689208153694433*^9, 
   3.689208180766549*^9}, {3.689776372481896*^9, 3.689776373544052*^9}, 
   3.6897764052972813`*^9, {3.694731918018347*^9, 3.694731939401544*^9}, 
   3.694740815723399*^9, 3.696692089472416*^9, {3.6975497655574007`*^9, 
   3.697549789097342*^9}, 
   3.7012063131988487`*^9},ExpressionUUID->"fc0f3a7b-8be5-4e83-87dc-\
5db5e7571c3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"HoverAppearButton", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A button formatted to appear from nothing when hovered over\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"SearchField", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A search input field. Defaults to searching the input \
notebook.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FileBrowser", "::", "usage"}], "=", 
   "\"\<Customizable browser for files\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.686498015326333*^9, 3.686498030172769*^9}, {
   3.686498245526528*^9, 3.6864982464195232`*^9}, {3.686679018603333*^9, 
   3.6866790420830317`*^9}, {3.688232597768529*^9, 3.688232598420755*^9}, {
   3.688234271311009*^9, 3.688234285730494*^9}, {3.689208153694433*^9, 
   3.689208180766549*^9}, {3.689776372481896*^9, 3.689776373544052*^9}, 
   3.6897764052972813`*^9, {3.694731918018347*^9, 3.694731939401544*^9}, 
   3.694740815723399*^9, 3.696692089472416*^9, {3.697510273520454*^9, 
   3.697510319022113*^9}, {3.6975103889467163`*^9, 
   3.6975104060330276`*^9}},ExpressionUUID->"2dd7023d-2574-4812-a5b5-\
7fd0ba8fc93c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FileChooser", "::", "usage"}], "=", 
   "\"\<Mac-esque chooser for files\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DirectoryChooser", "::", "usage"}], "=", 
   "\"\<FileChooser but restricted to dirs\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700238546802636*^9, 
  3.700238575708823*^9}},ExpressionUUID->"09ec16ed-4e7f-4581-9e50-\
a4eaee4a9336"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PaneWindow", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A little embedded window with a title bar\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CloseButton", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A little button that closes its parent\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IButton", "::", "usage"}], "=", "\n", "\t", 
   "\"\<A little info-icon button\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.70136405892197*^9, 3.701364073544018*^9}, 
   3.729096628388356*^9},ExpressionUUID->"2b269bd0-54f2-4c10-9e54-\
ee1fa9aa8924"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DragPane", "::", "usage"}], "=", 
   "\"\<Displays as a draggable Pane\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.729131590119308*^9, 
  3.729131615232939*^9}},ExpressionUUID->"21a35181-8935-401e-9cc5-\
bc053b9fb99c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"84c85ffd-34a6-4430-90da-\
69c027464fb7"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Images\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.721887561609767*^9, 
  3.7218875631607723`*^9}},ExpressionUUID->"b2a16ad3-0c82-4a11-98a3-\
dfedbb1bf0bd"],

Cell[CellGroupData[{

Cell["Approximating", "CodeSubsubsubsection",
 CellChangeTimes->{{3.721927148716874*^9, 
  3.721927157507056*^9}},ExpressionUUID->"7d201839-0987-44ba-b4f2-\
3a6362ddaa77"],

Cell["This can get messy for large radii", "Text",
 CellChangeTimes->{{3.721927163251114*^9, 
  3.721927169259286*^9}},ExpressionUUID->"df486a81-b16a-4521-bb9d-\
979f9f0802d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PillImageApproximating", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "Framed", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PillImageApproximating", "[", 
    RowBox[{"img_", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
      "pill", ",", "\n", "\t\t", "rad", ",", "\n", "\t\t", "reps", ",", "\n", 
       "\t\t", "dims", ",", "\n", "\t\t", "effRad"}], "\n", "\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"pill", "=", "\n", "\t\t\t", 
       RowBox[{"Rasterize", "[", "\n", "\t\t\t\t", 
        RowBox[{"Framed", "[", 
         RowBox[{"img", ",", " ", "\n", "\t\t\t\t\t", 
          RowBox[{"FrameStyle", "\[Rule]", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", " ", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Automatic", "\[Rule]", "Gray"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t", 
               RowBox[{"None", "->", "None"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
               
               RowBox[{
                RowBox[{"c", ":", 
                 RowBox[{"Except", "[", 
                  RowBox[{"_", "?", "ColorQ"}], "]"}]}], ":>", "\n", 
                "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"Flatten", "[", 
                 RowBox[{
                  RowBox[{"Directive", "[", 
                   RowBox[{"Gray", ",", " ", "c"}], "]"}], ",", " ", "2", ",",
                   " ", "Directive"}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
              "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
          "\t\t\t\t\t", "ops", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"FrameMargins", "\[Rule]", 
           RowBox[{"-", "1"}]}]}], "\n", "\t\t\t\t\t", "]"}], "\n", 
        "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"dims", "=", "\n", "\t\t\t", 
       RowBox[{"ImageDimensions", "[", "pill", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"rad", "=", "\n", "\t\t\t", 
       RowBox[{"Min", "@", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Floor", "[", "\n", "\t\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "RoundingRadius", "]"}], ",", "\n", 
             "\t", "\t", "\t\t\t\t", 
             RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Automatic", "\[Rule]", "5"}], ",", "\n", "\t", "\t", 
               "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Except", "[", 
                 RowBox[{"_", "?", "NumericQ"}], "]"}], "\[Rule]", "0"}]}], 
              "\n", "\t", "\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Max", "@", "dims"}], "/", "2"}]}], "\n", "\t\t\t\t", 
         "}"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"reps", "=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", " ", "2"}], "]"}], "&"}], "@", "\n", "\t\t\t\t", 
        RowBox[{"Table", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"rad", "-", "i", "+", "1"}], ",", " ", "2"}], "]"}], 
              "+", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"rad", "-", "j", "+", "1"}], ",", " ", "2"}], "]"}]}],
              ">", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"rad", "^", "2"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Tuples", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", " ", 
                 RowBox[{
                  RowBox[{"dims", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", "i", "+", "1"}]}], 
                "}"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"j", ",", " ", 
                 RowBox[{
                  RowBox[{"dims", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", "1", "-", "j"}]}], 
                "}"}]}], "\n", "\t", "\t\t\t\t\t\t\t", "}"}], "\n", "\t", 
             "\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t\t", 
            "Nothing"}], "\n", "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t", 
          "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"rad", "-", "1"}]}], "}"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"j", ",", " ", 
            RowBox[{"rad", "-", "1"}]}], "}"}]}], "\n", "\t\t\t\t\t", 
         "]"}]}]}], ";", "\n", "\t\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "@", "reps"}], ">", "0"}], ",", "\n", "\t\t\t", 
        RowBox[{"ReplacePixelValue", "[", 
         RowBox[{"pill", ",", "\n", "\t\t\t\t", 
          RowBox[{"reps", "\[Rule]", 
           RowBox[{"GrayLevel", "[", 
            RowBox[{"1", ",", "0"}], "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", 
        "\n", "\t\t\t", "pill"}], "\n", "\t\t\t", "]"}]}]}], "\n", "\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.721886358964252*^9, 3.721887147012986*^9}, {
   3.721887197989937*^9, 3.7218872424279547`*^9}, {3.721887315769346*^9, 
   3.721887540490341*^9}, {3.72188757929565*^9, 3.721887590477776*^9}, {
   3.7218876312285643`*^9, 3.721887637225533*^9}, {3.721887753281001*^9, 
   3.721887833642399*^9}, {3.721889358509594*^9, 3.721889438492688*^9}, {
   3.7218895641545773`*^9, 3.7218900291316757`*^9}, {3.7218900717226763`*^9, 
   3.721890248709799*^9}, {3.721890307789956*^9, 3.7218905288685837`*^9}, {
   3.7218906288932877`*^9, 3.7218909326816797`*^9}, {3.721890979877328*^9, 
   3.7218911258951273`*^9}, {3.721891156025167*^9, 3.721891491595467*^9}, {
   3.721891611114094*^9, 3.7218916909105177`*^9}, {3.721891724009864*^9, 
   3.7218917817139263`*^9}, {3.72189181434352*^9, 3.721891817807066*^9}, {
   3.721891874014392*^9, 3.7218919052920856`*^9}, {3.7218919504350653`*^9, 
   3.7218919514975357`*^9}, {3.721892023409728*^9, 3.721892169685851*^9}, {
   3.721892203038041*^9, 3.721892225268174*^9}, {3.721892280569707*^9, 
   3.721892352161819*^9}, {3.721892411268137*^9, 3.721892459146468*^9}, {
   3.721892536355657*^9, 3.7218927107732697`*^9}, {3.72189277201257*^9, 
   3.7218927923721952`*^9}, {3.72189283228369*^9, 3.721892839674139*^9}, {
   3.721892988842627*^9, 3.721893374287526*^9}, {3.721893425862658*^9, 
   3.7218938127636337`*^9}, {3.721893844432173*^9, 3.7218944164218597`*^9}, {
   3.721894637540482*^9, 3.721894640328547*^9}, {3.721894745470764*^9, 
   3.721894764067148*^9}, {3.721894800010091*^9, 3.7218948047688417`*^9}, {
   3.7218948478785343`*^9, 3.721895385483432*^9}, {3.721895427262989*^9, 
   3.721895489408248*^9}, {3.7219219123020487`*^9, 3.721922090582756*^9}, 
   3.721922151989683*^9, {3.721922189311007*^9, 3.721922240543757*^9}, {
   3.721922310986813*^9, 3.721922434122629*^9}, {3.7219224811036253`*^9, 
   3.72192250597053*^9}, {3.721922569912077*^9, 3.72192271673951*^9}, {
   3.72192276305268*^9, 3.721922876875309*^9}, {3.721922949166438*^9, 
   3.721922961059116*^9}, {3.721922993600816*^9, 3.721923117344499*^9}, {
   3.7219231697942953`*^9, 3.721923247147724*^9}, {3.7219232776446543`*^9, 
   3.721923316817034*^9}, {3.721923392950287*^9, 3.721923421405064*^9}, {
   3.721923465535368*^9, 3.721923465986655*^9}, {3.721923501304455*^9, 
   3.7219235473399467`*^9}, {3.7219235853929243`*^9, 
   3.7219236083497343`*^9}, {3.7219236393768253`*^9, 3.721923797516706*^9}, {
   3.721923872256782*^9, 3.72192393919841*^9}, {3.7219240140091753`*^9, 
   3.7219240982665977`*^9}, 3.7219241484778957`*^9, 3.721924190858392*^9, {
   3.721924244628069*^9, 3.7219242871504717`*^9}, {3.7219243330983467`*^9, 
   3.721924393262899*^9}, {3.721924423414815*^9, 3.721924526173025*^9}, {
   3.72192456198977*^9, 3.721924600780706*^9}, {3.721925059776721*^9, 
   3.721925073850325*^9}, {3.7219251395975246`*^9, 3.7219254607339687`*^9}, {
   3.7219255884967318`*^9, 3.721925648834631*^9}, {3.721925681701956*^9, 
   3.721925811203738*^9}, {3.721926003888638*^9, 3.721926009077545*^9}, {
   3.721926077011135*^9, 3.7219261333034277`*^9}, {3.721926265685639*^9, 
   3.721926275158367*^9}, {3.7219263913778152`*^9, 3.72192639530932*^9}, {
   3.721926436240197*^9, 3.721926441427286*^9}, {3.721926530601535*^9, 
   3.721926566424451*^9}, {3.7219266801990747`*^9, 3.721926681577389*^9}, {
   3.721926751817316*^9, 3.721926972249897*^9}, {3.721927020862883*^9, 
   3.7219270329908447`*^9}, {3.721927069394189*^9, 3.7219270897898483`*^9}, 
   3.721927124608917*^9, {3.721927221800062*^9, 3.721927257106967*^9}, {
   3.7219272989985647`*^9, 3.72192746828815*^9}, {3.721933430701305*^9, 
   3.72193343425951*^9}},ExpressionUUID->"47c8a007-002d-4e64-8569-\
5111a91e2b61"]
}, Closed]],

Cell[CellGroupData[{

Cell["Masking", "CodeSubsubsubsection",
 CellChangeTimes->{{3.721927148716874*^9, 
  3.721927149771304*^9}},ExpressionUUID->"667ab626-298c-4c67-a898-\
3124ad233347"],

Cell["This leaves behind artefacts, unfortunately.", "Text",
 CellChangeTimes->{{3.721924988730987*^9, 
  3.721924996419338*^9}},ExpressionUUID->"00f16664-1d1a-4f29-9959-\
28a893957213"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PillImageMasking", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "Framed", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PillImageMasking", "[", 
    RowBox[{"img_", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"pill", "=", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"ImageQ", "[", "img", "]"}]}], ",", " ", 
          RowBox[{"Rasterize", "[", "img", "]"}], ",", " ", "img"}], "]"}]}], 
       ",", "\n", "\t\t", "dim", ",", "\n", "\t\t", "frame", ",", "\n", 
       "\t\t", "mask", ",", "\n", "\t\t", "frameStyle"}], "\n", "\t\t", "}"}],
      ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"dim", "=", "\n", "\t\t\t", 
       RowBox[{"ImageDimensions", "[", "pill", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"mask", "=", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"ImagePad", "[", 
          RowBox[{"#", ",", " ", "1", ",", " ", "White"}], "]"}], "&"}], "@", 
        "\n", "\t\t\t\t", 
        RowBox[{"Rasterize", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"Framed", "[", 
           RowBox[{
            RowBox[{"Pane", "[", 
             RowBox[{"\"\<\>\"", ",", " ", 
              RowBox[{"dim", "-", "1"}]}], "]"}], ",", " ", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"Background", "\[Rule]", "Black"}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"FrameStyle", "->", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"fs", "=", 
                 RowBox[{"OptionValue", "[", "FrameStyle", "]"}]}], "}"}], 
               ",", "\n", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{"fs", "/.", 
                RowBox[{
                 RowBox[{"c_", "?", "ColorQ"}], "\[Rule]", "White"}]}]}], 
              "\n", "\t", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
            "\t\t\t\t\t", "ops", ",", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"FrameMargins", "\[Rule]", "0"}], ",", "\n", "\t", 
            "\t\t\t\t\t", 
            RowBox[{"RoundingRadius", "\[Rule]", "5"}]}], "\n", "\t", 
           "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"RasterSize", "->", 
           RowBox[{"dim", "-", "1"}]}]}], "\n", "\t\t\t\t\t", "]"}]}]}], ";", 
      "\n", "\t\t", 
      RowBox[{"frame", "=", "\n", "\t\t\t", 
       RowBox[{"Rasterize", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Framed", "[", 
          RowBox[{
           RowBox[{"Pane", "[", 
            RowBox[{"\"\<\>\"", ",", " ", "dim"}], "]"}], ",", " ", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Background", "\[Rule]", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", " ", "\n",
               "\t\t\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"Directive", "[", 
                  RowBox[{"___", ",", " ", 
                   RowBox[{"c_", "?", "ColorQ"}], ",", " ", "___"}], "]"}], ":>",
                  "\n", "\t\t\t\t\t\t\t\t\t", "c"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{
                   RowBox[{"_", "?", "ColorQ"}], "|", "None"}], "]"}], "->", 
                 "\n", "\t\t\t\t\t\t\t\t\t", "Gray"}]}], "\n", 
               "\t\t\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
           ",", "\n", "\t\t\t\t\t", 
           RowBox[{"FrameStyle", "\[Rule]", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", " ", "\n",
               "\t\t\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Automatic", "\[Rule]", "Gray"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{"None", "->", "None"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"c", ":", 
                  RowBox[{"Except", "[", 
                   RowBox[{"_", "?", "ColorQ"}], "]"}]}], ":>", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"Flatten", "[", 
                  RowBox[{
                   RowBox[{"Directive", "[", 
                    RowBox[{"Gray", ",", " ", "c"}], "]"}], ",", " ", "2", 
                   ",", " ", "Directive"}], "]"}]}]}], "\n", 
               "\t\t\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], 
           ",", "\n", "\t\t\t\t\t", "ops", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"FrameMargins", "\[Rule]", "0"}], ",", "\n", "\t\t\t\t\t", 
           
           RowBox[{"RoundingRadius", "\[Rule]", "5"}]}], "\n", "\t\t\t\t\t", 
          "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"RasterSize", "->", "dim"}], ",", "\n", "\t\t\t\t\t\t", 
             "ops"}], "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"Options", "@", "Rasterize"}]}], "\n", "\t\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"mask", "=", "\n", "\t\t\t", 
       RowBox[{"Image", "@", "\n", "\t\t\t\t", 
        RowBox[{"Map", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", ">", "0"}], ",", " ", "1", ",", " ", "0"}], "]"}], 
           "&"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"MorphologicalComponents", "[", "mask", "]"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", "2", "}"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], ";", "\n",
       "\t\t", 
      RowBox[{"mask", "=", "\n", "\t\t\t", 
       RowBox[{"PixelValuePositions", "[", 
        RowBox[{"mask", ",", " ", "Black"}], "]"}]}], ";", "\n", "\t\t", 
      RowBox[{"pill", "=", "\n", "\t\t\t", 
       RowBox[{"ImageResize", "[", 
        RowBox[{"pill", ",", " ", 
         RowBox[{"ImageDimensions", "[", "frame", "]"}]}], "]"}]}], ";", "\n",
       "\t\t", 
      RowBox[{"pill", "=", "\n", "\t\t\t", 
       RowBox[{"ReplacePixelValue", "[", 
        RowBox[{"frame", ",", " ", "\n", "\t\t\t\t", 
         RowBox[{"Thread", "[", 
          RowBox[{"mask", "->", 
           RowBox[{"PixelValue", "[", 
            RowBox[{"pill", ",", " ", "mask"}], "]"}]}], "]"}]}], "\n", 
        "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", "pill"}]}], "\n", "\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.721886358964252*^9, 3.721887147012986*^9}, {
   3.721887197989937*^9, 3.7218872424279547`*^9}, {3.721887315769346*^9, 
   3.721887540490341*^9}, {3.72188757929565*^9, 3.721887590477776*^9}, {
   3.7218876312285643`*^9, 3.721887637225533*^9}, {3.721887753281001*^9, 
   3.721887833642399*^9}, {3.721889358509594*^9, 3.721889438492688*^9}, {
   3.7218895641545773`*^9, 3.7218900291316757`*^9}, {3.7218900717226763`*^9, 
   3.721890248709799*^9}, {3.721890307789956*^9, 3.7218905288685837`*^9}, {
   3.7218906288932877`*^9, 3.7218909326816797`*^9}, {3.721890979877328*^9, 
   3.7218911258951273`*^9}, {3.721891156025167*^9, 3.721891491595467*^9}, {
   3.721891611114094*^9, 3.7218916909105177`*^9}, {3.721891724009864*^9, 
   3.7218917817139263`*^9}, {3.72189181434352*^9, 3.721891817807066*^9}, {
   3.721891874014392*^9, 3.7218919052920856`*^9}, {3.7218919504350653`*^9, 
   3.7218919514975357`*^9}, {3.721892023409728*^9, 3.721892169685851*^9}, {
   3.721892203038041*^9, 3.721892225268174*^9}, {3.721892280569707*^9, 
   3.721892352161819*^9}, {3.721892411268137*^9, 3.721892459146468*^9}, {
   3.721892536355657*^9, 3.7218927107732697`*^9}, {3.72189277201257*^9, 
   3.7218927923721952`*^9}, {3.72189283228369*^9, 3.721892839674139*^9}, {
   3.721892988842627*^9, 3.721893374287526*^9}, {3.721893425862658*^9, 
   3.7218938127636337`*^9}, {3.721893844432173*^9, 3.7218944164218597`*^9}, {
   3.721894637540482*^9, 3.721894640328547*^9}, {3.721894745470764*^9, 
   3.721894764067148*^9}, {3.721894800010091*^9, 3.7218948047688417`*^9}, {
   3.7218948478785343`*^9, 3.721895385483432*^9}, {3.721895427262989*^9, 
   3.721895489408248*^9}, {3.7219219123020487`*^9, 3.721922090582756*^9}, 
   3.721922151989683*^9, {3.721922189311007*^9, 3.721922240543757*^9}, {
   3.721922310986813*^9, 3.721922434122629*^9}, {3.7219224811036253`*^9, 
   3.72192250597053*^9}, {3.721922569912077*^9, 3.72192271673951*^9}, {
   3.72192276305268*^9, 3.721922876875309*^9}, {3.721922949166438*^9, 
   3.721922961059116*^9}, {3.721922993600816*^9, 3.721923117344499*^9}, {
   3.7219231697942953`*^9, 3.721923247147724*^9}, {3.7219232776446543`*^9, 
   3.721923316817034*^9}, {3.721923392950287*^9, 3.721923421405064*^9}, {
   3.721923465535368*^9, 3.721923465986655*^9}, {3.721923501304455*^9, 
   3.7219235473399467`*^9}, {3.7219235853929243`*^9, 
   3.7219236083497343`*^9}, {3.7219236393768253`*^9, 3.721923797516706*^9}, {
   3.721923872256782*^9, 3.72192393919841*^9}, {3.7219240140091753`*^9, 
   3.7219240982665977`*^9}, 3.7219241484778957`*^9, 3.721924190858392*^9, {
   3.721924244628069*^9, 3.7219242871504717`*^9}, {3.7219243330983467`*^9, 
   3.721924393262899*^9}, {3.721924423414815*^9, 3.721924526173025*^9}, {
   3.72192456198977*^9, 3.721924600780706*^9}, {3.721925059776721*^9, 
   3.721925073850325*^9}, {3.721925470140332*^9, 
   3.721925472899984*^9}},ExpressionUUID->"fabc1bcb-dbd0-4e4d-988e-\
86fd8c5c1e7a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Delegator", "CodeSubsubsubsection",
 CellChangeTimes->{{3.721927184092019*^9, 
  3.7219271854741993`*^9}},ExpressionUUID->"687f36c7-30d7-4d22-8210-\
850cc11098c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PillImage", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "Framed", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"PillImage", "[", 
   RowBox[{"img_", ",", " ", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"PillImageApproximating", "[", 
   RowBox[{"img", ",", " ", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"RoundingRadius", "\[Rule]", "5"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.721925093622758*^9, 3.721925103367942*^9}, {
  3.721925484205997*^9, 3.721925573524456*^9}, {3.72192583354458*^9, 
  3.721925844430728*^9}, {3.72192719169759*^9, 
  3.721927210331616*^9}},ExpressionUUID->"7c52e246-031c-4335-8374-\
a57d469b3622"],

Cell[BoxData[
 RowBox[{"(*", "\t", 
  RowBox[{"Switch", "[", 
   RowBox[{
    RowBox[{"OptionValue", "[", "RoundingRadius", "]"}], ",", "\n", "\t\t", 
    RowBox[{"Automatic", "|", 
     RowBox[{"_Integer", "?", 
      RowBox[{"(", 
       RowBox[{"LessEqualThan", "[", "10", "]"}], ")"}]}]}], ",", "\n", 
    "\t\t\t", 
    RowBox[{"PillImageExplicit", "[", 
     RowBox[{
     "img", ",", " ", "\n", "\t\t\t\t", "ops", ",", "\n", "\t\t\t\t", 
      RowBox[{"RoundingRadius", "\[Rule]", "5"}]}], "\n", "\t\t\t\t", "]"}], 
    ",", "\n", "\t\t", "_", ",", "\n", "\t\t\t", 
    RowBox[{"PillImageMasking", "[", 
     RowBox[{"img", ",", " ", "ops", ",", "\n", "\t\t\t\t", 
      RowBox[{"RoundingRadius", "\[Rule]", "5"}]}], "\n", "\t\t\t\t", "]"}]}],
    "\n", "\t\t", "]"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.721925093622758*^9, 3.721925103367942*^9}, {
  3.721925484205997*^9, 3.721925573524456*^9}, {3.72192583354458*^9, 
  3.721925844430728*^9}, {3.72192719169759*^9, 
  3.721927203910399*^9}},ExpressionUUID->"283d67e5-eba8-4216-aeaf-\
3e24cfbd2fda"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PillGradientImage\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7219250786215477`*^9},ExpressionUUID->"c7b53997-e746-4242-92ab-\
1811db657f8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PillGradientImage", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"gradientSpec_:", "Automatic"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "PillImage", "]"}]}]}], "\n", "\t", "]"}],
   ":=", "\n", "\t", 
  RowBox[{"PillImage", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"ImageResize", "[", "\n", "\t", "\t\t", 
     RowBox[{
      RowBox[{"LinearGradientImage", "[", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
        RowBox[{"gradientSpec", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Automatic", "->", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Bottom", ",", "Top"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"GrayLevel", "[", ".4", "]"}], ",", 
                RowBox[{"GrayLevel", "[", ".95", "]"}]}], "}"}]}], ")"}]}], 
           ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"c_", "?", "ColorQ"}], ":>", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Bottom", ",", "Top"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"White", ",", "c"}], "}"}]}], ")"}]}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"c", ":", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "?", "ColorQ"}], ",", 
               RowBox[{"_", "?", "ColorQ"}]}], "}"}]}], ":>", "\n", 
            "\t\t\t\t\t\t\t", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Bottom", ",", "Top"}], "}"}], "\[Rule]", 
              RowBox[{"Reverse", "@", "c"}]}], ")"}]}]}], "\n", 
          "\t\t\t\t\t\t", "}"}]}], "]"}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
      "\t", "\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", "\n", "\t", 
        "\t\t\t", 
        RowBox[{"Automatic", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"25", ",", "50"}], "}"}]}]}], "\n", "\t", "\t\t\t", "]"}]}],
      "\n", "\t", "\t\t", "]"}], ",", "\n", "\t", "\t", "ops"}], "\n", "\t", 
   "\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.721886358964252*^9, 3.721887147012986*^9}, {
   3.721887197989937*^9, 3.7218872424279547`*^9}, {3.721887315769346*^9, 
   3.721887540490341*^9}, {3.72188757929565*^9, 3.721887590477776*^9}, {
   3.7218876312285643`*^9, 3.721887637225533*^9}, {3.721887753281001*^9, 
   3.721887833642399*^9}, {3.721889358509594*^9, 3.721889438492688*^9}, {
   3.7218895641545773`*^9, 3.7218900291316757`*^9}, {3.7218900717226763`*^9, 
   3.721890248709799*^9}, {3.721890307789956*^9, 3.7218905288685837`*^9}, {
   3.7218906288932877`*^9, 3.7218909326816797`*^9}, {3.721890979877328*^9, 
   3.7218911258951273`*^9}, {3.721891156025167*^9, 3.721891491595467*^9}, {
   3.721891611114094*^9, 3.7218916909105177`*^9}, {3.721891724009864*^9, 
   3.7218917817139263`*^9}, {3.72189181434352*^9, 3.721891817807066*^9}, {
   3.721891874014392*^9, 3.7218919052920856`*^9}, {3.7218919504350653`*^9, 
   3.7218919514975357`*^9}, {3.721892023409728*^9, 3.721892169685851*^9}, {
   3.721892203038041*^9, 3.721892225268174*^9}, {3.721892280569707*^9, 
   3.721892352161819*^9}, {3.721892411268137*^9, 3.721892459146468*^9}, {
   3.721892536355657*^9, 3.7218927107732697`*^9}, {3.72189277201257*^9, 
   3.7218927923721952`*^9}, {3.72189283228369*^9, 3.721892839674139*^9}, {
   3.721892988842627*^9, 3.721893374287526*^9}, {3.721893425862658*^9, 
   3.7218938127636337`*^9}, {3.721893844432173*^9, 3.7218944164218597`*^9}, {
   3.721894637540482*^9, 3.721894640328547*^9}, {3.721894745470764*^9, 
   3.721894764067148*^9}, {3.721894800010091*^9, 3.7218948047688417`*^9}, {
   3.7218948478785343`*^9, 3.721895385483432*^9}, {3.721895427262989*^9, 
   3.721895489408248*^9}, {3.7219219123020487`*^9, 3.721922090582756*^9}, 
   3.721922151989683*^9, {3.721922189311007*^9, 3.721922240543757*^9}, {
   3.721922310986813*^9, 3.721922434122629*^9}, {3.7219224811036253`*^9, 
   3.72192250597053*^9}, {3.721922569912077*^9, 3.72192271673951*^9}, {
   3.72192276305268*^9, 3.721922876875309*^9}, {3.721922949166438*^9, 
   3.721922961059116*^9}, {3.721922993600816*^9, 3.721923117344499*^9}, {
   3.7219231697942953`*^9, 3.721923247147724*^9}, {3.7219232776446543`*^9, 
   3.721923316817034*^9}, {3.721923392950287*^9, 3.721923421405064*^9}, {
   3.721923465535368*^9, 3.721923465986655*^9}, {3.721923501304455*^9, 
   3.7219235473399467`*^9}, {3.7219235853929243`*^9, 
   3.7219236083497343`*^9}, {3.7219236393768253`*^9, 3.721923797516706*^9}, {
   3.721923872256782*^9, 3.72192393919841*^9}, {3.7219240140091753`*^9, 
   3.7219240982665977`*^9}, 3.7219241484778957`*^9, 3.721924190858392*^9, {
   3.721924244628069*^9, 3.7219242871504717`*^9}, {3.7219243330983467`*^9, 
   3.721924393262899*^9}, {3.721924423414815*^9, 3.721924526173025*^9}, {
   3.72192456198977*^9, 3.721924600780706*^9}, {3.721925059776721*^9, 
   3.721925073850325*^9}, {3.7219327201007547`*^9, 
   3.721932786131531*^9}},ExpressionUUID->"d34b350c-5ac2-4b76-b461-\
8096e595fc85"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NinePatch\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7219324517498417`*^9, 
  3.721932453734681*^9}},ExpressionUUID->"e2fee1cf-a152-4d56-b147-\
81493c8c8398"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NinePatchNameTag\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7290969044064207`*^9},ExpressionUUID->"38b29d49-392b-4942-91aa-\
79bbede40482"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NinePatchNameTag", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"head", ":", 
     RowBox[{"_", "?", "OptionQ"}]}], ",", "\n", "\t", 
    RowBox[{"main", ":", 
     RowBox[{
      RowBox[{"_", "?", "OptionQ"}], "|", "None"}], ":", "None"}], ",", "\n", 
    "\t", 
    RowBox[{"footer", ":", 
     RowBox[{
      RowBox[{"_", "?", "OptionQ"}], "|", "None"}], " ", ":", "None"}]}], 
   "\n", "\t", "]"}], ":=", "\n", 
  RowBox[{"Module", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{"col", ",", "\n", "\t\t", 
      RowBox[{"headStyle", "=", "\n", "\t\t", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{"head", ",", "\n", "\t\t\t", 
          RowBox[{"FrameStyle", "\[Rule]", "Gray"}], ",", "\n", "\t\t\t", 
          RowBox[{"Background", "\[Rule]", 
           RowBox[{"GrayLevel", "[", ".9", "]"}]}]}], "\n", "\t\t\t", 
         "}"}]}]}], ",", "\n", "\t\t", "mainStyle", ",", "footStyle", ",", 
      "\n", "\t\t", "topSize", ",", "mainSize", ",", "footSize", ",", "\n", 
      "\t\t", "nums"}], "\n", "\t\t", "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"topSize", "=", "\n", "\t", 
      RowBox[{"Replace", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Last", "@", 
         RowBox[{"Flatten", "@", 
          RowBox[{"List", "@", 
           RowBox[{"OptionValue", "[", 
            RowBox[{"Framed", ",", "headStyle", ",", " ", "ImageSize"}], 
            "]"}]}]}]}], ",", "\n", "\t\t", 
        RowBox[{"Automatic", "\[Rule]", "35"}]}], "\n", "\t\t", "]"}]}], ";", 
     "\n", "\t", 
     RowBox[{"mainStyle", "=", "\n", "\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"main", ",", " ", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Except", "[", "None", "]"}], "\[RuleDelayed]", "\n", "\t\t", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "\n", "\t\t\t", 
           RowBox[{"main", ",", "\n", "\t\t\t", 
            RowBox[{"FrameStyle", "\[Rule]", "Gray"}], ",", "\n", "\t\t\t", 
            RowBox[{"Background", "\[Rule]", 
             RowBox[{"GrayLevel", "[", "1", "]"}]}]}], "\n", "\t\t\t", 
           "}"}]}]}]}], "\n", "\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{"footStyle", "=", "\n", "\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"footer", ",", " ", "\n", "\t\t", 
        RowBox[{
         RowBox[{"Except", "[", "None", "]"}], "\[RuleDelayed]", "\n", "\t\t", 
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "\n", "\t\t\t", 
           RowBox[{"footer", ",", "\n", "\t\t\t", 
            RowBox[{"FrameStyle", "\[Rule]", "Gray"}], ",", "\n", "\t\t\t", 
            RowBox[{"Background", "\[Rule]", 
             RowBox[{"GrayLevel", "[", ".8", "]"}]}]}], "\n", "\t\t\t", 
           "}"}]}]}]}], "\n", "\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{"col", "=", "\n", "\t", 
      RowBox[{"Column", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"Framed", "[", 
           RowBox[{"\"\<\>\"", ",", "\n", "\t\t\t\t", 
            RowBox[{"Prepend", "[", 
             RowBox[{"headStyle", ",", "\n", "\t\t\t\t\t", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"2", ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"main", "=!=", "None"}], ",", " ", 
                    RowBox[{"1", "/", "2"}], ",", "0"}], "]"}], "*", 
                   RowBox[{"CurrentValue", "[", "FontSize", "]"}]}], "+", 
                  "topSize"}]}], "\n", "\t\t\t\t\t\t", "}"}]}]}], "\n", 
             "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"main", "=!=", "None"}], ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"mainSize", "=", "\n", "\t\t\t\t", 
              RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Last", "@", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"List", "@", 
                   RowBox[{"OptionValue", "[", 
                    RowBox[{
                    "Framed", ",", "mainStyle", ",", " ", "ImageSize"}], 
                    "]"}]}]}]}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"Automatic", "\[Rule]", "5"}]}], "\n", "\t\t\t\t\t", 
               "]"}]}], ";", "\n", "\t\t\t\t", 
             RowBox[{"Framed", "[", 
              RowBox[{"\"\<\>\"", ",", "\n", "\t\t\t\t\t", 
               RowBox[{"Prepend", "[", "\n", "\t\t\t\t\t\t", 
                RowBox[{"mainStyle", ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"ImageSize", "\[Rule]", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"footer", "=!=", "None"}], ",", " ", 
                    RowBox[{"5", "/", "4"}], ",", " ", 
                    RowBox[{"1", "/", "2"}]}], "]"}], "*", 
                    RowBox[{"CurrentValue", "[", "FontSize", "]"}]}], "+", 
                    "mainSize"}]}], "}"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
              "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", "Nothing"}],
            "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"footer", "=!=", "None"}], ",", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"footSize", "=", "\n", "\t\t\t\t", 
              RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Last", "@", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"List", "@", 
                   RowBox[{"OptionValue", "[", 
                    RowBox[{
                    "Framed", ",", "footStyle", ",", " ", "ImageSize"}], 
                    "]"}]}]}]}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"Automatic", "\[Rule]", "15"}]}], "\n", "\t\t\t\t\t", 
               "]"}]}], ";", "\n", "\t\t\t\t", 
             RowBox[{"Framed", "[", 
              RowBox[{"\"\<\>\"", ",", "\n", "\t\t\t\t\t", 
               RowBox[{"Prepend", "[", "\n", "\t\t\t\t\t\t", 
                RowBox[{"footStyle", ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"ImageSize", "\[Rule]", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"CurrentValue", "[", "FontSize", "]"}], "/", 
                    "2"}], "+", "footSize"}]}], "}"}]}]}], "\n", 
                "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", 
            "\n", "\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
         "\t\t\t", "}"}], ",", "\n", "\t\t", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"-", "1"}]}]}], "\n", "\t\t", "]"}]}], ";", "\n", "\t", 
     RowBox[{"nums", "=", "\n", "\t", 
      RowBox[{
       RowBox[{"Select", "[", "NumericQ", "]"}], "@", 
       RowBox[{"{", 
        RowBox[{"mainSize", ",", " ", "footSize", ",", " ", "topSize"}], 
        "}"}]}]}], ";", "\n", "\t", 
     RowBox[{"NinePatchCreate", "[", "\n", "\t\t", 
      RowBox[{"col", ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"main", "=!=", "None"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Offset", "[", 
            RowBox[{"1", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"Floor", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Total", "[", "nums", "]"}], "/", "2"}], ")"}], "-", 
               "topSize", "-", 
               RowBox[{"mainSize", "/", "2"}]}], "]"}]}], "\n", "\t\t\t\t\t", 
            "]"}], ",", "\n", "\t\t\t\t", "1"}], "\n", "\t\t\t\t", "]"}]}], 
        "}"}]}], "\n", "\t\t", "]"}]}]}], "\n", "\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7219301689591427`*^9, 3.7219307306635427`*^9}, {
  3.721930771648037*^9, 3.7219310071846733`*^9}, {3.721931056707336*^9, 
  3.721931083347877*^9}, {3.721931144268858*^9, 3.721931208687787*^9}, {
  3.721931265410368*^9, 3.721931351956812*^9}, {3.7219314173182907`*^9, 
  3.7219315365866613`*^9}, {3.721931665608379*^9, 3.7219317736252623`*^9}, {
  3.72193182901117*^9, 3.721931967124319*^9}, {3.721932026387779*^9, 
  3.721932062105136*^9}, {3.7219320965443773`*^9, 3.721932127033486*^9}, {
  3.7219322035314093`*^9, 3.721932346354844*^9}, {3.7219324634694777`*^9, 
  3.7219324656048117`*^9}},ExpressionUUID->"cf402605-2c52-4f7b-963a-\
3ac916530b54"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Appearances\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6975494003678303`*^9, 
  3.697549401726478*^9}},ExpressionUUID->"69046f8c-717d-4bf7-8cfa-\
1fe6cb519b7d"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]NinePatchCreate\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.721872026122855*^9, 3.721872028785795*^9}, {
  3.721929093270494*^9, 
  3.721929094020384*^9}},ExpressionUUID->"efe51898-ff3d-4234-b3f4-\
2d5980225de8"],

Cell[CellGroupData[{

Cell["Imp Code", "CodeSubsubsubsection",
 CellChangeTimes->{{3.721872101674282*^9, 
  3.721872103176383*^9}},ExpressionUUID->"9d5283b3-5f6c-4845-a015-\
a52a899d4588"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ninePatchMarkerPatternSingle", "=", "\n", "\t", 
   RowBox[{"_Integer", "|", 
    RowBox[{"Scaled", "[", 
     RowBox[{"i_", "?", "NumericQ"}], "]"}], "|", "\n", "\t", 
    RowBox[{"Offset", "[", "\n", "\t", "\t", 
     RowBox[{
      RowBox[{
       RowBox[{"Scaled", "[", 
        RowBox[{"i_", "?", "NumericQ"}], "]"}], "|", "_Integer"}], ",", "\n", 
      "\t", "\t", 
      RowBox[{
       RowBox[{"Scaled", "[", 
        RowBox[{"i_", "?", "NumericQ"}], "]"}], "|", "_Integer"}]}], "\n", 
     "\t", "\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ninePatchMarkerPattern", "=", "\n", "\t", 
   RowBox[{"ninePatchMarkerPatternSingle", "|", 
    RowBox[{"{", 
     RowBox[{"ninePatchMarkerPatternSingle", ".."}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ninePatchParamClean", "[", 
    RowBox[{"p_", ",", "ind_", ",", "dim_", ",", 
     RowBox[{"doNeg_:", "True"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ReplaceRepeated", "[", 
    RowBox[{"p", ",", "\n", "\t", "\t", 
     RowBox[{"{", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Scaled", "[", "i_", "]"}], ":>", "\n", "\t", "\t\t", 
        RowBox[{"i", "*", 
         RowBox[{"dim", "[", 
          RowBox[{"[", 
           RowBox[{"Mod", "[", 
            RowBox[{"ind", ",", "2", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",",
        "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"i_Integer", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Negative", "[", "#", "]"}], "&&", "doNeg"}], "&"}], 
          ")"}]}], "\[RuleDelayed]", "\n", "\t", "\t\t", 
        RowBox[{"i", "+", 
         RowBox[{"dim", "[", 
          RowBox[{"[", 
           RowBox[{"Mod", "[", 
            RowBox[{"ind", ",", "2", ",", "1"}], "]"}], "]"}], "]"}]}]}], ",",
        "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"i", ":", 
         RowBox[{"Except", "[", 
          RowBox[{"_Integer", ",", 
           RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], ":>", "\n", "\t", 
        "\t\t", 
        RowBox[{"Floor", "[", "i", "]"}]}]}], "\n", "\t", "\t\t", "}"}]}], 
    "\n", "\t", "\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ninePatchStretchZones", "[", 
    RowBox[{"stretch_", ",", "contents_", ",", "dim_"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Module", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "stretchesX", ",", "stretchesY", ",", "\n", "\t", "\t\t", "contentsX", 
       ",", "contentsY", ",", "\n", "\t", "\t\t", "stretchOffsetsX", ",", 
       "stretchOffsetsY", ",", "\n", "\t", "\t\t", "contentOffsetsX", ",", 
       "contentOffsetsY"}], "\n", "\t", "\t\t", "}"}], ",", "\n", "\t", "\t", 
     
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"stretchesX", ",", "stretchesY"}], "}"}], "=", "\n", "\t", 
       "\t", 
       RowBox[{
        RowBox[{"Flatten", "@*", "List"}], "/@", "\n", "\t", "\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"stretch", ",", 
          RowBox[{"Automatic", "->", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}]}], ";", "\n", "\t", 
      "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"contentsX", ",", "contentsY"}], "}"}], "=", "\n", "\t", "\t", 
       RowBox[{
        RowBox[{"Flatten", "@*", "List"}], "/@", "\n", "\t", "\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"contents", ",", "\n", "\t", "\t\t", 
          RowBox[{"Automatic", "->", 
           RowBox[{"{", 
            RowBox[{"stretchesX", ",", "stretchesY"}], "}"}]}]}], "\n", "\t", 
         "\t\t", "]"}]}]}], ";", "\n", "\t", "\t", 
      RowBox[{"stretchOffsetsX", "=", "\n", "\t", "\t", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "@", "stretchesX"}]}], "]"}]}], ";", "\n", "\t", 
      "\t", 
      RowBox[{"stretchOffsetsY", "=", "\n", "\t", "\t", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "@", "stretchesY"}]}], "]"}]}], ";", "\n", "\t", 
      "\t", 
      RowBox[{"contentOffsetsX", "=", "\n", "\t", "\t", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "@", "contentsX"}]}], "]"}]}], ";", "\n", "\t", 
      "\t", 
      RowBox[{"contentOffsetsY", "=", "\n", "\t", "\t", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "@", "contentsY"}]}], "]"}]}], ";", "\n", "\t", 
      "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "stretchesX", ",", "stretchesY", ",", "contentsX", ",", "contentsY"}],
         "}"}], "=", "\n", "\t", "\t", 
       RowBox[{"MapIndexed", "[", "\n", "\t", "\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ind", "=", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "\n", "\t", 
            "\t\t\t", 
            RowBox[{"MapIndexed", "[", "\n", "\t", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"#", ",", "\n", "\t", "\t\t\t\t\t", 
                 RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Offset", "[", 
                    RowBox[{"w_", ",", "s_"}], "]"}], "\[RuleDelayed]", "\n", 
                    "\t", "\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"v", "=", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ninePatchParamClean", "[", 
                    RowBox[{"s", ",", "ind", ",", "dim", ",", "False"}], 
                    "]"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", "}"}], ",", "\n",
                     "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Switch", "[", 
                    RowBox[{
                    "ind", ",", "\n", "\t", "\t\t\t\t\t\t\t\t", "1", ",", 
                    RowBox[{
                    RowBox[{"stretchOffsetsX", "[", 
                    RowBox[{"[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", "v"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t", "2", ",", 
                    RowBox[{
                    RowBox[{"stretchOffsetsY", "[", 
                    RowBox[{"[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", "v"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t", "3", ",", 
                    RowBox[{
                    RowBox[{"contentOffsetsX", "[", 
                    RowBox[{"[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", "v"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t", "4", ",", 
                    RowBox[{
                    RowBox[{"contentOffsetsY", "[", 
                    RowBox[{"[", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", 
                    "v"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t", "]"}], ";", "\n",
                     "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"ninePatchParamClean", "[", 
                    RowBox[{"w", ",", "ind", ",", "dim"}], "]"}]}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t", 
                   RowBox[{"e_", "\[RuleDelayed]", "\n", "\t", "\t\t\t\t\t\t", 
                    RowBox[{"ninePatchParamClean", "[", 
                    RowBox[{"e", ",", "ind", ",", "dim"}], "]"}]}]}], "\n", 
                  "\t", "\t\t\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t\t\t", 
                "]"}], "&"}], ",", "\n", "\t", "\t\t\t\t", "#"}], "\n", "\t", 
             "\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t", "]"}], "&"}], ",", 
         "\n", "\t", "\t\t", 
         RowBox[{"{", 
          RowBox[{
          "stretchesX", ",", "stretchesY", ",", "contentsX", ",", 
           "contentsY"}], "}"}]}], "\n", "\t", "\t\t", "]"}]}], ";", "\n", 
      "\t", "\t", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"AnyTrue", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"{", "\n", "\t", "\t\t\t", 
            RowBox[{
            "stretchesX", ",", "stretchesY", ",", "\n", "\t", "\t\t\t", 
             "contentsX", ",", "contentsY", ",", "\n", "\t", "\t\t\t", 
             "stretchOffsetsX", ",", "stretchOffsetsY", ",", "\n", "\t", 
             "\t\t\t", "contentOffsetsX", ",", "contentOffsetsY"}], "\n", 
            "\t", "\t\t\t", "}"}]}], ",", 
          RowBox[{"Not", "@*", "IntegerQ"}]}], "]"}], ",", "\n", "\t", "\t", 
        RowBox[{"Throw", "[", "$Failed", "]"}], ",", "\n", "\t", "\t", 
        RowBox[{"{", "\n", "\t", "\t\t", 
         RowBox[{
         "stretchesX", ",", "stretchesY", ",", "\n", "\t", "\t\t", 
          "contentsX", ",", "contentsY", ",", "\n", "\t", "\t\t", 
          "stretchOffsetsX", ",", "stretchOffsetsY", ",", "\n", "\t", "\t\t", 
          "contentOffsetsX", ",", "contentOffsetsY"}], "\n", "\t", "\t\t", 
         "}"}]}], "\n", "\t", "\t", "]"}]}]}], "\n", "\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ninePatchImagePad", "[", 
    RowBox[{"img_", ",", "\n", "\t", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
      "stretchesX_", ",", "stretchesY_", ",", "\n", "\t\t", "contentsX_", ",",
        "contentsY_", ",", "\n", "\t\t", "stretchOffsetsX_", ",", 
       "stretchOffsetsY_", ",", "\n", "\t\t", "contentOffsetsX_", ",", 
       "contentOffsetsY_"}], "\n", "\t\t", "}"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dim", "=", 
       RowBox[{
        RowBox[{"ImageDimensions", "[", "img", "]"}], "+", "2"}]}], "}"}], 
     ",", "\n", "\t", "\t", 
     RowBox[{"ReplacePixelValue", "[", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{"ImagePad", "[", 
        RowBox[{"img", ",", " ", "1", ",", " ", "White"}], "]"}], ",", "\n", 
       "\t", "\t\t", 
       RowBox[{
        RowBox[{"Flatten", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Map", "[", "\n", "\t", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"vals", "=", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{"offsets", "=", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                 RowBox[{"f", "=", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", "\n", "\t",
                "\t\t\t\t\t", 
               RowBox[{"MapThread", "[", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"v", "=", "#"}], ",", 
                    RowBox[{"o", "=", "#2"}]}], "}"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"#", ",", "v", ",", "o"}], "]"}], "&"}], ",", 
                    "v"}], "]"}]}], "\n", "\t", "\t\t\t\t\t\t\t", "]"}], 
                  "&"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{"vals", ",", "offsets"}], "}"}]}], "\n", "\t", 
                "\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t", "]"}], 
             "&"}], ",", "\n", "\t", "\t\t\t\t", 
            RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
               "stretchesY", ",", "stretchOffsetsY", ",", "\n", "\t", 
                "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "#2"}], ")"}], "/", 
                    "2"}], "]"}], "+", "#", "+", "#3"}]}], "}"}], "&"}]}], 
               "\n", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
               "stretchesX", ",", "stretchOffsetsX", ",", "\n", "\t", 
                "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "#2"}], ")"}], "/", 
                    "2"}], "]"}], "+", "#", "+", "#3"}], ",", 
                   RowBox[{"dim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}]}], "\n", 
               "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
               "contentsY", ",", "contentOffsetsY", ",", "\n", "\t", 
                "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"dim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "-", "#2"}], ")"}], "/", 
                    "2"}], "]"}], "+", "#", "+", "#3"}]}], "}"}], "&"}]}], 
               "\n", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
               "contentsX", ",", "contentOffsetsX", ",", "\n", "\t", 
                "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"dim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "#2"}], ")"}], "/", 
                    "2"}], "]"}], "+", "#", "+", "#3"}], ",", "1"}], "}"}], 
                 "&"}]}], "\n", "\t", "\t\t\t\t\t\t", "}"}]}], "\n", "\t", 
             "\t\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t\t", "]"}], ",", "\n", 
          "\t", "\t\t\t", "2"}], "\n", "\t", "\t\t\t", "]"}], "\[Rule]", 
        "Black"}]}], "\n", "\t", "\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.721848513225178*^9, 3.72184880434385*^9}, {
   3.721848846039151*^9, 3.721848859731442*^9}, {3.721848902529429*^9, 
   3.72184935867102*^9}, {3.721849403829907*^9, 3.721849456405233*^9}, {
   3.7218495303960133`*^9, 3.7218497695377607`*^9}, {3.7218498056829157`*^9, 
   3.721850166093404*^9}, {3.721850228034122*^9, 3.721850535317425*^9}, {
   3.721850587420295*^9, 3.721850590130868*^9}, {3.721850643503305*^9, 
   3.721850647500181*^9}, {3.721850735492077*^9, 3.72185080321609*^9}, {
   3.721851602567731*^9, 3.721851720067627*^9}, {3.7218517885003843`*^9, 
   3.7218517968599567`*^9}, {3.7218642366873302`*^9, 3.721864249850367*^9}, {
   3.7218643758529177`*^9, 3.7218643834194727`*^9}, {3.721864443096613*^9, 
   3.721864670378875*^9}, {3.721864705415065*^9, 3.721864707220027*^9}, {
   3.721864778193152*^9, 3.721864793929777*^9}, {3.721865708149214*^9, 
   3.721866536714896*^9}, {3.721866569067205*^9, 3.721866958386661*^9}, {
   3.721867005402462*^9, 3.7218670068654203`*^9}, {3.7218678941861563`*^9, 
   3.721867896850622*^9}, {3.721867949998535*^9, 3.721868742539074*^9}, {
   3.721868797972322*^9, 3.7218688121043863`*^9}, {3.7218688862949123`*^9, 
   3.721868907615446*^9}, {3.721868979802943*^9, 3.7218689897955313`*^9}, {
   3.721869056022173*^9, 3.7218690618756027`*^9}, {3.721869148255374*^9, 
   3.7218691637674637`*^9}, {3.7218692981010237`*^9, 3.721869299272758*^9}, {
   3.7218693340962467`*^9, 3.7218693395267887`*^9}, 3.721869399319919*^9, {
   3.7218694997205276`*^9, 3.7218695234717407`*^9}, 3.7218695553832483`*^9, {
   3.721869589705327*^9, 3.721869641491391*^9}, {3.7218696928005047`*^9, 
   3.721869698260674*^9}, {3.721869765646285*^9, 3.7218698294677343`*^9}, {
   3.721872039721369*^9, 3.721872089664703*^9}, {3.721887293865325*^9, 
   3.72188729475187*^9}},ExpressionUUID->"dc4457a8-233b-4a50-b314-\
eb7fa94e83dd"]
}, Closed]],

Cell[CellGroupData[{

Cell["NinePatchCreate", "CodeSubsubsubsection",
 CellChangeTimes->{
  3.721872093718974*^9},ExpressionUUID->"b45a343c-559f-41a2-960c-\
c57b74794f4a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NinePatchCreate", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"img_", "?", "ImageQ"}], ",", "\n", "\t", 
     RowBox[{"stretch", ":", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ninePatchMarkerPattern", ",", " ", "ninePatchMarkerPattern"}], "}"}],
        "|", "Automatic"}], ":", "Automatic"}], ",", "\n", "\t", 
     RowBox[{"content", ":", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "ninePatchMarkerPattern", ",", " ", "ninePatchMarkerPattern"}], "}"}],
        "|", "Automatic"}], ":", "Automatic"}]}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"Catch", "@", "\n", "\t\t", 
    RowBox[{"Image", "[", "\n", "\t", "\t\t", 
     RowBox[{
      RowBox[{"ColorConvert", "[", "\n", "\t", "\t", "\t\t", 
       RowBox[{
        RowBox[{"ninePatchImagePad", "[", 
         RowBox[{"img", ",", "\n", "\t", "\t", "\t\t\t", 
          RowBox[{"ninePatchStretchZones", "[", 
           RowBox[{"stretch", ",", "content", ",", 
            RowBox[{"ImageDimensions", "[", "img", "]"}]}], "]"}]}], "\n", 
         "\t", "\t", "\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t\t", 
        "RGBColor"}], "\n", "\t", "\t", "\t\t", "]"}], ",", "\n", "\t", "\t", 
      "\t", "\"\<Byte\>\"", ",", "\n", "\t", "\t", "\t", 
      RowBox[{"Interleaving", "\[Rule]", "True"}]}], "\n", "\t", "\t", "\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NinePatchCreate", "[", 
   RowBox[{"e_", ",", "\n", "\t", 
    RowBox[{"stretch", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ninePatchMarkerPattern", ",", " ", "ninePatchMarkerPattern"}],
        "}"}], "|", "Automatic"}], ":", "Automatic"}], ",", "\n", "\t", 
    RowBox[{"content", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ninePatchMarkerPattern", ",", " ", "ninePatchMarkerPattern"}],
        "}"}], "|", "Automatic"}], ":", "Automatic"}]}], "\n", "\t", "]"}], ":=",
   "\n", "\t", 
  RowBox[{"NinePatchCreate", "[", 
   RowBox[{
    RowBox[{"Rasterize", "[", "e", "]"}], ",", "stretch", ",", "content"}], 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.721848513225178*^9, 3.72184880434385*^9}, {
   3.721848846039151*^9, 3.721848859731442*^9}, {3.721848902529429*^9, 
   3.72184935867102*^9}, {3.721849403829907*^9, 3.721849456405233*^9}, {
   3.7218495303960133`*^9, 3.7218497695377607`*^9}, {3.7218498056829157`*^9, 
   3.721850166093404*^9}, {3.721850228034122*^9, 3.721850535317425*^9}, {
   3.721850587420295*^9, 3.721850590130868*^9}, {3.721850643503305*^9, 
   3.721850647500181*^9}, {3.721850735492077*^9, 3.72185080321609*^9}, {
   3.721851602567731*^9, 3.721851720067627*^9}, {3.7218517885003843`*^9, 
   3.7218517968599567`*^9}, {3.7218642366873302`*^9, 3.721864249850367*^9}, {
   3.7218643758529177`*^9, 3.7218643834194727`*^9}, {3.721864443096613*^9, 
   3.721864670378875*^9}, {3.721864705415065*^9, 3.721864707220027*^9}, {
   3.721864778193152*^9, 3.721864793929777*^9}, {3.721865708149214*^9, 
   3.721866536714896*^9}, {3.721866569067205*^9, 3.721866958386661*^9}, {
   3.721867005402462*^9, 3.7218670068654203`*^9}, {3.7218678941861563`*^9, 
   3.721867896850622*^9}, {3.721867949998535*^9, 3.721868742539074*^9}, {
   3.721868797972322*^9, 3.7218688121043863`*^9}, {3.7218688862949123`*^9, 
   3.721868907615446*^9}, {3.721868979802943*^9, 3.7218689897955313`*^9}, {
   3.721869056022173*^9, 3.7218690618756027`*^9}, {3.721869148255374*^9, 
   3.7218691637674637`*^9}, {3.7218692981010237`*^9, 3.721869299272758*^9}, {
   3.7218693340962467`*^9, 3.7218693395267887`*^9}, 3.721869399319919*^9, {
   3.7218694997205276`*^9, 3.7218695234717407`*^9}, 3.7218695553832483`*^9, {
   3.721869589705327*^9, 3.721869641491391*^9}, {3.7218696928005047`*^9, 
   3.721869698260674*^9}, {3.721869765646285*^9, 3.7218698294677343`*^9}, {
   3.721872039721369*^9, 3.721872089664703*^9}, 
   3.7219279701793203`*^9},ExpressionUUID->"5c22c301-ac05-4212-874f-\
82924485e497"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]AppearanceReadyImage\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697549444209509*^9, 
  3.697549446775907*^9}},ExpressionUUID->"ec0d5b2b-a260-49c9-92db-\
a4f939d1f633"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "AppearanceReadyImage", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"BorderDimensions", "\[Rule]", "Automatic"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Prolog", "\[Rule]", "Identity"}], ",", "\n", "\t\t\t", 
       RowBox[{"ImagePadding", "\[Rule]", "None"}]}], "\n", "\t\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "Rasterize"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AppearanceReadyImage", "[", 
    RowBox[{
     RowBox[{"i_", "?", 
      RowBox[{"(", "ImageQ", ")"}]}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"img", "=", "\n", "\t\t", 
       RowBox[{"ColorConvert", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"ImagePad", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "ImagePadding", "]"}], ",", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"Except", "[", 
                 RowBox[{"_Integer", "|", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "_Integer"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "_Integer"}], "}"}]}], "}"}]}], 
                 "]"}], ":>", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"OptionValue", "@", "Prolog"}], ",", 
                   RowBox[{"None", "\[Rule]", "Identity"}]}], "]"}], "@", 
                 "i"}]}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"int_", ":>", "\n", "\t\t\t\t\t\t", 
                RowBox[{"ImagePad", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "Prolog"}], ",", 
                    RowBox[{"None", "\[Rule]", "Identity"}]}], "]"}], "@", 
                   "i"}], ",", "\n", "\t\t\t\t\t\t\t", "int", ",", "\n", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"GrayLevel", "[", 
                   RowBox[{"0", ",", "0"}], "]"}]}], "]"}]}]}], "\n", "\t", 
              "\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t\t\t\t", "1", ",", 
           "\n", "\t\t\t\t", 
           RowBox[{"GrayLevel", "[", 
            RowBox[{"0", ",", "0"}], "]"}]}], "]"}], ",", "\n", "\t\t\t", 
         "\"\<RGB\>\""}], "\n", "\t\t\t", "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dims", "=", 
         RowBox[{"ImageDimensions", "@", "img"}]}], "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"mx", "=", 
            RowBox[{
             RowBox[{"Floor", "@", 
              RowBox[{"First", "@", "dims"}]}], "/", "2"}]}], ",", 
           RowBox[{"my", "=", 
            RowBox[{
             RowBox[{"Floor", "@", 
              RowBox[{"Last", "@", "dims"}]}], "/", "2"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"x", "=", 
            RowBox[{"First", "@", "dims"}]}], ",", 
           RowBox[{"y", "=", 
            RowBox[{"Last", "@", "dims"}]}]}], "\n", "\t\t\t\t", "}"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"rleft", "=", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "@", "BorderDimensions"}], ",", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Automatic", "->", 
                    RowBox[{"Scaled", "[", ".5", "]"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"x_", ",", "_"}], "}"}], ",", "_"}], "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"x", ":", 
                    RowBox[{"Except", "[", "_List", "]"}]}], ",", "_"}], 
                    "}"}]}], ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"Automatic", "\[Rule]", 
                    RowBox[{"Scaled", "[", ".5", "]"}]}]}], "]"}]}]}], "\n", 
                   "\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Except", "[", 
                    RowBox[{"_Scaled", "|", 
                    RowBox[{"_", "?", "NumericQ"}]}], "]"}], "\[Rule]", 
                   "None"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"w_", "?", "NumericQ"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"-", "w"}]}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Floor", "@", "w"}], "/", "2"}]}], "]"}]}], ",", 
                  "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Scaled", "[", "w_", "]"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"y", "*", 
                    RowBox[{"w", "/", "2"}]}], ")"}]}]}], ",", 
                    RowBox[{"Floor", "@", 
                    RowBox[{"(", 
                    RowBox[{"y", "*", 
                    RowBox[{"w", "/", "2"}]}], ")"}]}]}], "]"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t", 
             "\t\t\t\t", 
             RowBox[{"rright", "=", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "@", "BorderDimensions"}], ",", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Automatic", "->", 
                    RowBox[{"Scaled", "[", ".5", "]"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "r_"}], "}"}], ",", "_"}], "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"r", ":", 
                    RowBox[{"Except", "[", "_List", "]"}]}], ",", "_"}], 
                    "}"}]}], ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"r", ",", 
                    RowBox[{"Automatic", "\[Rule]", 
                    RowBox[{"Scaled", "[", ".5", "]"}]}]}], "]"}]}]}], "\n", 
                   "\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Except", "[", 
                    RowBox[{"_Scaled", "|", 
                    RowBox[{"_", "?", "NumericQ"}]}], "]"}], "\[Rule]", 
                   "None"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"w_", "?", "NumericQ"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"-", "w"}]}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Floor", "@", "w"}], "/", "2"}]}], "]"}]}], ",", 
                  "\n", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Scaled", "[", "w_", "]"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"y", "*", 
                    RowBox[{"w", "/", "2"}]}], ")"}]}]}], ",", 
                    RowBox[{"Floor", "@", 
                    RowBox[{"(", 
                    RowBox[{"y", "*", 
                    RowBox[{"w", "/", "2"}]}], ")"}]}]}], "]"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t", 
             "\t\t\t\t", 
             RowBox[{"rbottom", "=", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "@", "BorderDimensions"}], ",", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Automatic", "->", 
                    RowBox[{"Scaled", "[", ".8", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", 
                    RowBox[{"{", 
                    RowBox[{"x_", ",", "_"}], "}"}]}], "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "x_"}], "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"x", ",", 
                    RowBox[{"Automatic", "\[Rule]", 
                    RowBox[{"Scaled", "[", ".8", "]"}]}]}], "]"}]}]}], "\n", 
                   "\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"e", ":", 
                    RowBox[{"Except", "[", 
                    RowBox[{"_Scaled", "|", 
                    RowBox[{"_", "?", "NumericQ"}]}], "]"}]}], 
                   "\[RuleDelayed]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Print", "[", "e", "]"}], ";", "None"}], ")"}]}], 
                  ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"w_", "?", "NumericQ"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"-", "w"}]}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Floor", "@", "w"}], "/", "2"}]}], "]"}]}], ",", 
                  "\n", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Scaled", "[", "w_", "]"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"x", "*", 
                    RowBox[{"w", "/", "2"}]}], ")"}]}]}], ",", 
                    RowBox[{"Floor", "@", 
                    RowBox[{"(", 
                    RowBox[{"x", "*", 
                    RowBox[{"w", "/", "2"}]}], ")"}]}]}], "]"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t", 
             "\t\t\t\t", 
             RowBox[{"rtop", "=", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "@", "BorderDimensions"}], ",", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Automatic", "->", 
                    RowBox[{"Scaled", "[", ".5", "]"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "t_"}], "}"}]}], "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "t_"}], "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"t", ",", 
                    RowBox[{"Automatic", "\[Rule]", 
                    RowBox[{"Scaled", "[", ".5", "]"}]}]}], "]"}]}]}], "\n", 
                   "\t", "\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Except", "[", 
                    RowBox[{"_Scaled", "|", 
                    RowBox[{"_", "?", "NumericQ"}]}], "]"}], "\[Rule]", 
                   "None"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"w_", "?", "NumericQ"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"-", "w"}]}], "/", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Floor", "@", "w"}], "/", "2"}]}], "]"}]}], ",", 
                  "\n", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Scaled", "[", "w_", "]"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"Ceiling", "@", 
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"x", "*", 
                    RowBox[{"w", "/", "2"}]}], ")"}]}]}], ",", 
                    RowBox[{"Floor", "@", 
                    RowBox[{"(", 
                    RowBox[{"x", "*", 
                    RowBox[{"w", "/", "2"}]}], ")"}]}]}], "]"}]}]}], "\n", 
                 "\t", "\t\t\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t", 
            "\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"Image", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"ReplacePixelValue", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"img", ",", "\n", "\t", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Join", "[", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"rleft", "===", "None"}], ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}], ",", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"rleft", "+", "my"}]}], "}"}], "]"}]}], "\n", 
                   "\t", "\t", "\t", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                  "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"rright", "===", "None"}], ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}], ",", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", 
                    RowBox[{"rright", "+", "my"}]}], "}"}], "]"}]}], "\n", 
                   "\t", "\t", "\t", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                  "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"rbottom", "===", "None"}], ",", "\n", "\t", "\t",
                     "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rbottom", "+", "mx"}], ",", "1"}], "}"}], 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"rtop", "===", "None"}], ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}], ",", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"rtop", "+", "mx"}], ",", "y"}], "}"}], "]"}]}], 
                   "\n", "\t", "\t", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                 "\t", "\t\t\t\t\t\t", "]"}], "\[Rule]", "Black"}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
             "\"\<Byte\>\"", ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Interleaving", "\[Rule]", "True"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AppearanceReadyImage", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"e", ":", 
      RowBox[{
       RowBox[{"Except", "[", 
        RowBox[{"_Mouseover", "|", "_List", "|", "_Rule"}], "]"}], "?", 
       RowBox[{"(", 
        RowBox[{"Not", "@*", "ImageQ"}], ")"}]}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AppearanceReadyImage", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Rasterize", "[", 
      RowBox[{"e", ",", "\"\<Image\>\"", ",", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", 
         RowBox[{"Options", "@", "Rasterize"}]}], "]"}]}], "]"}], ",", "\n", 
     "\t\t", "ops"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AppearanceReadyImage", "[", 
    RowBox[{
     RowBox[{"k_", "\[Rule]", "img_"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"k", "->", 
    RowBox[{"AppearanceReadyImage", "[", 
     RowBox[{"img", ",", "ops"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AppearanceReadyImage", "[", 
    RowBox[{"l_List", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"AppearanceReadyImage", "[", 
      RowBox[{"#", ",", "ops"}], "]"}], "&"}], "/@", "l"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"AppearanceReadyImage", "[", 
    RowBox[{
     RowBox[{"Mouseover", "[", 
      RowBox[{"e1_", ",", "e2_"}], "]"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Default\>\"", "\[Rule]", 
      RowBox[{"AppearanceReadyImage", "[", 
       RowBox[{"e1", ",", "ops"}], "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Hover\>\"", "\[Rule]", 
      RowBox[{"AppearanceReadyImage", "[", 
       RowBox[{"e2", ",", "ops"}], "]"}]}]}], "\n", "\t\t", "}"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.697548039115933*^9, 3.69754808704403*^9}, {
   3.697548129040959*^9, 3.69754817168885*^9}, {3.697548217219232*^9, 
   3.697548253169911*^9}, {3.697548285712728*^9, 3.6975484112992153`*^9}, {
   3.697548465025194*^9, 3.697548578520487*^9}, {3.6975486110657873`*^9, 
   3.6975486743630447`*^9}, {3.697548719450013*^9, 3.697548851667412*^9}, {
   3.697548901052422*^9, 3.697548906538684*^9}, {3.697548938371066*^9, 
   3.697548942432968*^9}, {3.69754898711906*^9, 3.69754900416632*^9}, 
   3.697549451909645*^9, 3.6975494969852324`*^9, 3.697549545905718*^9, {
   3.697549820793754*^9, 3.697549892883148*^9}, {3.69755004004775*^9, 
   3.697550043228539*^9}, {3.700454144954092*^9, 3.700454926839549*^9}, {
   3.700454971035561*^9, 3.700455002454896*^9}, 3.700455041560227*^9, {
   3.700455092821003*^9, 3.700455195662835*^9}, {3.700455291466454*^9, 
   3.7004553646474247`*^9}, {3.700455493461914*^9, 3.700455543114977*^9}, {
   3.7004556898136578`*^9, 3.700455845443843*^9}, {3.7004558759059963`*^9, 
   3.700455886446145*^9}, {3.700456527696642*^9, 3.700456537566247*^9}, {
   3.7004567283858967`*^9, 3.700456732007115*^9}, {3.700458152550098*^9, 
   3.700458189195717*^9}, {3.700458419063717*^9, 3.700458425707609*^9}, {
   3.700458455741242*^9, 3.70045846450694*^9}, {3.7004597351475973`*^9, 
   3.700459783924851*^9}, {3.7004598558662367`*^9, 3.700459859097538*^9}, {
   3.700459929287546*^9, 3.700459930675515*^9}, {3.7004616210527267`*^9, 
   3.700461625941124*^9}, {3.700487232686942*^9, 3.700487284221874*^9}, {
   3.7004900122622766`*^9, 3.7004900134853783`*^9}, {3.7004901759241133`*^9, 
   3.7004901793422747`*^9}, {3.700490559164678*^9, 3.700490565409151*^9}, {
   3.700490599768713*^9, 3.700490649959519*^9}, {3.70049070196556*^9, 
   3.7004907644041*^9}, {3.700490801459091*^9, 3.700490811727394*^9}, {
   3.700490851475108*^9, 
   3.7004909310071697`*^9}},ExpressionUUID->"4ce03871-d215-49a5-b83e-\
e87fd391216a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientImagePaddingFormat\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.709245199174614*^9, 3.709245209445643*^9}, 
   3.709247168934141*^9},ExpressionUUID->"8c5eebe4-e40d-41b7-8e50-\
9a36306ac777"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GradientImagePaddingFormat", "[", 
    RowBox[{
     RowBox[{"where_:", "None"}], ",", "pad_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Switch", "[", 
    RowBox[{"where", ",", "\n", "\t\t", "Automatic", ",", "\n", "\t\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
      RowBox[{"pad", ",", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Automatic", "\[Rule]", "1"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Center", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t",
          "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "i_"}], "}"}], ":>", "\n", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "i"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t",
          "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "_", ",", 
            RowBox[{"{", 
             RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "t"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t",
          "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "_", ",", "b_"}], "}"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t",
          "\t\t", 
         RowBox[{
          RowBox[{"i", ":", 
           RowBox[{"_Integer", "|", "Automatic"}]}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "i"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}], ",", "\n", "\t",
          "\t", "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", ":", 
             RowBox[{"_Integer", "|", "Automatic"}]}], ",", "j_"}], "}"}], ":>",
           "\n", "\t", "\t", "\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "j"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}], ",", "\n", "\t",
          "\t", "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r_", ",", "l_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", "\t", 
          "\t", "\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", "l"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "t"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}]}], "\n", 
        "\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t\t", "First", ",", "\n", 
     "\t\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
      RowBox[{"pad", ",", 
       RowBox[{"{", "\n", "\t", "\t", "\t\t", 
        RowBox[{
         RowBox[{"Automatic", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t",
          "\t\t", 
         RowBox[{"Center", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t",
          "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "i_"}], "}"}], ":>", "\n", "\t", "\t", 
          "\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "i"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t",
          "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "_", ",", 
            RowBox[{"{", 
             RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", "\t", 
          "\t", "\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "t"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t",
          "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "_", ",", "b_"}], "}"}], ":>", "\n", "\t", 
          "\t", "\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t",
          "\t\t", 
         RowBox[{
          RowBox[{"i", ":", 
           RowBox[{"_Integer", "|", "Automatic"}]}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "i"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}], ",", "\n", "\t",
          "\t", "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", ":", 
             RowBox[{"_Integer", "|", "Automatic"}]}], ",", "j_"}], "}"}], ":>",
           "\n", "\t", "\t", "\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "j"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}], ",", "\n", "\t",
          "\t", "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r_", ",", "l_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", "\t", 
          "\t", "\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", 
                RowBox[{"l", "/.", 
                 RowBox[{"Automatic", "\[Rule]", "0"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "t"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}]}], "\n", 
        "\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t\t", "Last", ",", "\n", 
     "\t\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
      RowBox[{"pad", ",", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Automatic", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Center", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "i_"}], "}"}], ":>", "\n", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "i"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "i_", ",", 
            RowBox[{"{", 
             RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "t"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "i_", ",", "b_"}], "}"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"i", ":", 
           RowBox[{"_Integer", "|", "Automatic"}]}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "i"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "i"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", ":", 
             RowBox[{"_Integer", "|", "Automatic"}]}], ",", "j_"}], "}"}], ":>",
           "\n", "\t\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "i"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "j"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r_", ",", "l_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", "l"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "t"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}]}], "\n", 
        "\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t\t", "_", ",", "\n", 
     "\t\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
      RowBox[{"pad", ",", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Automatic", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Center", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "i_"}], "}"}], ":>", "\n", "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "i"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "i_", ",", 
            RowBox[{"{", 
             RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "t"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Center", ",", "i_", ",", "b_"}], "}"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "b"}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"i", ":", 
           RowBox[{"_Integer", "|", "Automatic"}]}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "i"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", ":", 
             RowBox[{"_Integer", "|", "Automatic"}]}], ",", "j_"}], "}"}], ":>",
           "\n", "\t\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "j"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"r_", ",", "l_"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"r", ",", 
                RowBox[{"l", "/.", 
                 RowBox[{"Automatic", "\[Rule]", "0"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "t"}], "}"}]}], "}"}], "/.", 
            RowBox[{"Automatic", "\[Rule]", "1"}]}], ")"}]}]}], "\n", 
        "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7092452162536383`*^9, 3.709245240168849*^9}, {
   3.709245308130383*^9, 3.7092453288273773`*^9}, {3.709246011614871*^9, 
   3.709246039745996*^9}, {3.7092460956953363`*^9, 3.70924609640464*^9}, 
   3.709247168948461*^9, {3.709510132324119*^9, 3.709510159960669*^9}, {
   3.709510198649727*^9, 
   3.7095102488628607`*^9}},ExpressionUUID->"383de9d5-8b82-45ee-84cc-\
5e4484a29278"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientAppearance\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700460406959663*^9, 
  3.7004604094783287`*^9}},ExpressionUUID->"84ee0dd5-9ddd-4575-a5db-\
c44907d639b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientAppearance", "]"}], "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"9", ",", "24"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"ImagePadding", "\[Rule]", "1"}], ",", "\n", "\t", 
     RowBox[{"FrameStyle", "\[Rule]", "Automatic"}], ",", "\n", "\t", 
     RowBox[{"ImageAdjust", "\[Rule]", "Automatic"}], ",", "\n", "\t", 
     RowBox[{"ImageCompose", "\[Rule]", "None"}]}], "\n", "\t", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientAppearance", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"color", ":", 
      RowBox[{
       RowBox[{"_", "?", "ColorQ"}], "|", 
       RowBox[{"{", 
        RowBox[{"__", "?", "ColorQ"}], "}"}]}]}], ",", "\n", "\t", 
     RowBox[{"center", ":", "\n", "\t\t", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}], ",", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}]}], "}"}]}], ":", 
      "\n", "\t\t", 
      RowBox[{"Scaled", "[", "0", "]"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"adj", "=", "\n", "\t\t\t", 
        RowBox[{"Take", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Flatten", "@", "\n", "\t\t\t\t\t", 
           RowBox[{"ConstantArray", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"OptionValue", "@", "ImageAdjust"}], ",", "\n", "\t", 
               "\t\t\t\t\t\t", 
               RowBox[{
               "Automatic", "\[RuleDelayed]", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"ColorQ", "@", "color"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", ".025", ",", 
                    RowBox[{"-", ".05"}]}], "}"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t", "0"}], "\n", "\t\t\t\t\t\t\t\t\t", 
                 "]"}]}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}], ",", "\n", 
             "\t\t\t\t\t\t", "3"}], "]"}]}], ",", "\n", "\t\t\t\t", "3"}], 
         "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"imageSize", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"n_", "?", "NumericQ"}], "\[RuleDelayed]", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"n", ",", "20"}], "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"frameColor", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"c", ":", 
              RowBox[{
               RowBox[{"_", "?", "ColorQ"}], "|", 
               RowBox[{"{", 
                RowBox[{"_", ",", "_"}], "}"}]}]}], "\[RuleDelayed]", "\n", 
             "\t\t\t\t\t", "c"}], ",", "\n", "\t\t\t\t", 
            RowBox[{"e_", ":>", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"e", "===", "Automatic"}], ",", "Darker", ",", "e"}], 
               "]"}], "@", 
              RowBox[{"First", "@", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "color", "}"}]}]}]}]}]}], "\n", "\t\t\t\t", 
           "}"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"pad", "=", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "@", "FrameStyle"}], "===", "None"}], ",", 
          "\n", "\t\t\t\t", "None", ",", "\n", "\t\t\t\t", 
          RowBox[{"GradientImagePaddingFormat", "[", 
           RowBox[{"Automatic", ",", 
            RowBox[{"OptionValue", "[", "ImagePadding", "]"}]}], "]"}]}], 
         "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cents", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"center", ",", 
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"n_", "?", "NumericQ"}], ":>", "\n", "\t\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Scaled", "[", "1", "]"}], ",", "n"}], "}"}]}], ",",
                "\n", "\t\t\t\t\t", 
               RowBox[{"s_Scaled", ":>", "\n", "\t\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Scaled", "[", "1", "]"}], ",", "s"}], "}"}]}]}], 
              "\n", "\t\t\t\t\t", "}"}]}], "]"}], ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"Scaled", "[", "s_", "]"}], ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"s", "*", 
               RowBox[{"Last", "@", "imageSize"}]}]}], ",", "\n", "\t\t\t\t", 
             
             RowBox[{
              RowBox[{"Except", "[", 
               RowBox[{"_", "?", "NumericQ"}], "]"}], ":>", "\n", 
              "\t\t\t\t\t", "0"}]}], "\n", "\t\t\t\t", "}"}], ",", "\n", 
           "\t\t\t", "1"}], "]"}]}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "@", "ImageCompose"}], "=!=", "None"}], ",",
           "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Fold", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ImageCompose", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Sequence", "@@", "#2"}]}], "]"}], "&"}], ",", "\n", 
             "\t\t\t\t\t", "#", ",", "\n", "\t\t\t\t\t", 
             RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"OptionValue", "@", "ImageCompose"}], "}"}], ",", 
                 "1"}], "]"}], ",", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"i_", "?", "ImageQ"}], ":>", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"{", "i", "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"g_Graphics", ":>", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"List", "@", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"ImageSize", "/.", 
                    RowBox[{"Options", "[", 
                    RowBox[{"g", ",", "ImageSize"}], "]"}]}], ",", 
                    "Automatic"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Rasterize", "[", 
                    RowBox[{
                    "g", ",", "\"\<Image\>\"", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"RasterSize", "\[Rule]", 
                    RowBox[{"First", "@", "imageSize"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Rasterize", "[", 
                    RowBox[{
                    "g", ",", "\"\<Image\>\"", ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", "None"}]}], "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t", "]"}]}]}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"e", ":", 
                   RowBox[{"Except", "[", "_List", "]"}]}], ":>", "\n", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"{", "e", "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"l_List", ":>", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{"l", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"i_", "?", "ImageQ"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "i", "}"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    "g_Graphics", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"ImageSize", "/.", 
                    RowBox[{"Options", "[", 
                    RowBox[{"g", ",", "ImageSize"}], "]"}]}], ",", 
                    "Automatic"}], "]"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Rasterize", "[", 
                    RowBox[{
                    "g", ",", "\"\<Image\>\"", ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"RasterSize", "\[Rule]", 
                    RowBox[{"First", "@", "imageSize"}]}], ",", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", "None"}]}], "]"}], ",", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Rasterize", "[", 
                    RowBox[{
                    "g", ",", "\"\<Image\>\"", ",", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", "None"}]}], "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    "1"}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", "1"}], 
              "]"}]}], "\n", "\t\t\t\t\t", "]"}], "&"}], ",", "\n", 
          "\t\t\t\t", "Identity"}], "\n", "\t\t\t\t", "]"}], "@", "\n", 
        "\t\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"pad", "=!=", "None"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{"frameColor", ",", 
              RowBox[{"{", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"_", "?", "ColorQ"}], ":>", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"ImagePad", "[", 
                  RowBox[{
                  "#", ",", "\n", "\t\t\t\t\t\t\t", "pad", ",", "\n", 
                   "\t\t\t\t\t\t\t", "frameColor"}], "]"}]}], ",", "\n", 
                "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"c1", ":", 
                    RowBox[{
                    RowBox[{"_", "?", "ColorQ"}], "|", "Automatic"}]}], ",", 
                   RowBox[{"c2", ":", 
                    RowBox[{
                    RowBox[{"_", "?", "ColorQ"}], "|", "Automatic"}]}]}], 
                  "}"}], ":>", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Replace", "[", 
                  RowBox[{"pad", ",", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"n_", "?", "NumericQ"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "c2"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "n"}], "}"}]}], "}"}], ",", "c2"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "c1"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "c1"}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "#"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"h_", "?", "NumericQ"}], ",", 
                    RowBox[{"v_", "?", "NumericQ"}]}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "c2"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", "v"}], "}"}]}], "}"}], ",", "c2"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "c1"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"h", ",", "h"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "c1"}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "#"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l_", ",", "r_"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "c2"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "t"}], "}"}]}], "}"}], ",", "c2"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "c1"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l", ",", "r"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "c1"}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "#"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}]}], "\n", 
                    "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
                "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"cl_", ",", "cr_"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"cb_", ",", "ct_"}], "}"}]}], "}"}], ":>", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"Replace", "[", 
                  RowBox[{"pad", ",", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"n_", "?", "NumericQ"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "ct"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "n"}], "}"}]}], "}"}], ",", "ct"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "cb"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "0"}], "}"}]}], "}"}], ",", "cb"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "cr"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "cr"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "cl"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "cl"}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "#"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"h_", "?", "NumericQ"}], ",", 
                    RowBox[{"v_", "?", "NumericQ"}]}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "ct"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "v"}], "}"}]}], "}"}], ",", "ct"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "cb"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", "0"}], "}"}]}], "}"}], ",", "cb"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "cr"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "h"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "cr"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "cl"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"h", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "cl"}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "#"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l_", ",", "r_"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "ct"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "t"}], "}"}]}], "}"}], ",", "ct"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "cb"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "0"}], "}"}]}], "}"}], ",", "cb"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Function", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "cr"}], ",", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "r"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "cr"}], 
                    "]"}], ",", "#"}], "]"}], "]"}], "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ColorQ", "@", "cl"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePad", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", "cl"}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "#"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}]}]}]}], "\n", 
                    "\t\t\t\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t\t", 
               "}"}]}], "]"}], "&"}], ",", "\n", "\t\t\t\t", "Identity"}], 
          "]"}], "@", "\n", "\t\t\t\t", 
         RowBox[{"LinearGradientImage", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Thread", "@", 
             RowBox[{"{", 
              RowBox[{"Center", ",", "cents"}], "}"}]}], "\[Rule]", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"MapThread", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"c", "=", "#"}], ",", 
                   RowBox[{"a", "=", "#2"}]}], "}"}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Hue", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "+", "a"}]}], "]"}], 
                   "&"}], "@", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"ColorConvert", "[", 
                   RowBox[{"c", ",", "Hue"}], "]"}]}]}], "\n", "\t", 
                "\t\t\t\t\t\t\t", "]"}], "&"}], ",", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Take", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "@", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"color", ",", "3"}], "]"}]}], ",", "3"}], "]"}], 
                ",", "\n", "\t\t\t\t\t\t\t\t", "adj"}], "\n", 
               "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
           "imageSize"}], "\n", "\t\t\t\t\t", "]"}]}]}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700458957448905*^9, 3.700459029481658*^9}, 
   3.700459492140767*^9, {3.7004595801231003`*^9, 3.70045966526825*^9}, {
   3.700459703210812*^9, 3.700459716475171*^9}, {3.700459988036233*^9, 
   3.700460023210744*^9}, {3.700460057212079*^9, 3.700460156119011*^9}, {
   3.7004603004193068`*^9, 3.700460484334387*^9}, {3.700460700666788*^9, 
   3.700461223049522*^9}, 3.700461253963832*^9, {3.700461288572207*^9, 
   3.700461418350814*^9}, {3.700461455967881*^9, 3.700461574770636*^9}, {
   3.700461707126129*^9, 3.7004617837464457`*^9}, {3.7004618334869013`*^9, 
   3.7004619189468184`*^9}, {3.700461987530231*^9, 3.7004619887764263`*^9}, 
   3.7004620305526037`*^9, {3.700462127741519*^9, 3.700462128755385*^9}, {
   3.700462392682232*^9, 3.700462420680292*^9}, {3.700463027649415*^9, 
   3.7004630279676523`*^9}, {3.700463170075385*^9, 3.700463198269919*^9}, 
   3.700463305217304*^9, {3.70046381341571*^9, 3.7004640135785933`*^9}, {
   3.700464059026053*^9, 3.700464079413685*^9}, {3.7004641267483673`*^9, 
   3.700464149384679*^9}, {3.700464269055256*^9, 3.7004643199010572`*^9}, {
   3.700464362161337*^9, 3.70046436394983*^9}, 3.7004645298252993`*^9, {
   3.70046456827986*^9, 3.7004646471447687`*^9}, {3.700485742606063*^9, 
   3.700485772565588*^9}, {3.7004916889034567`*^9, 3.70049169929042*^9}, 
   3.700491733616725*^9, {3.700494082085135*^9, 3.700494156087429*^9}, {
   3.700494521204948*^9, 3.7004946083577023`*^9}, {3.700495088102195*^9, 
   3.700495142345359*^9}, {3.700497093770906*^9, 3.70049709500959*^9}, {
   3.700500991866345*^9, 3.700501009242313*^9}, {3.700501087129702*^9, 
   3.700501089599375*^9}, {3.700502465399914*^9, 3.700502538211138*^9}, {
   3.700502570332106*^9, 3.70050257457124*^9}, {3.7005078762728443`*^9, 
   3.700507898148306*^9}, {3.700507930725875*^9, 3.700507935504838*^9}, {
   3.700511506007275*^9, 3.700511512551751*^9}, {3.700511601810211*^9, 
   3.700511620579771*^9}, {3.700784101447976*^9, 3.7007841240076237`*^9}, {
   3.700840749077574*^9, 3.700840780801944*^9}, {3.700841252455727*^9, 
   3.70084130421943*^9}, {3.700842632066333*^9, 3.700842632373752*^9}, 
   3.700842716766119*^9, {3.7027552906604643`*^9, 3.702755323387905*^9}, {
   3.702755465245118*^9, 3.7027555186371307`*^9}, {3.702755553453618*^9, 
   3.702755579918476*^9}, 3.709247150090434*^9, {3.709247198999119*^9, 
   3.70924724493752*^9}, {3.709510171952511*^9, 
   3.709510175156005*^9}},ExpressionUUID->"a08cb96c-3217-41f2-b3f1-\
49e4e0c10e15"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FrameMasked\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700485753537999*^9, 3.700485762592361*^9}, {
  3.7004858428591213`*^9, 
  3.7004858432786083`*^9}},ExpressionUUID->"4badea99-256a-4fb6-bd6f-\
e77864144c30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FrameMasked", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "@", "Framed"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "Rasterize"}], ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"Epilog", "\[Rule]", "Identity"}], "\n", "\t\t", "}"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FrameMasked", "[", 
    RowBox[{
     RowBox[{"img_", "?", "ImageQ"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"id", "=", 
        RowBox[{"ImageDimensions", "@", "img"}]}], ",", "\n", "\t\t", 
       RowBox[{"keyColor", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "@", "FrameStyle"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"ColorQ", "@", "#"}], "&&", 
                 RowBox[{
                  RowBox[{"ColorDistance", "[", 
                   RowBox[{"Black", ",", "#"}], "]"}], "<", ".01"}]}], "&"}], 
               ")"}]}], "->", "\n", "\t\t\t\t\t", "Purple"}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"ColorQ", "@", "#"}], "&&", 
                 RowBox[{
                  RowBox[{"ColorDistance", "[", 
                   RowBox[{"White", ",", "#"}], "]"}], "<", ".01"}]}], "&"}], 
               ")"}]}], "\[Rule]", "\n", "\t\t\t\t\t", "Green"}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{
             RowBox[{"c_", "?", "ColorQ"}], ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"ColorNegate", "[", "c", "]"}]}], ",", "\n", "\t\t\t\t", 
            
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{"___", ",", 
               RowBox[{"c_", "?", "ColorQ"}], ",", "___"}], "]"}], ":>", "\n",
              "\t\t\t\t\t", 
             RowBox[{"ColorNegate", "[", "c", "]"}]}], ",", "\n", "\t\t\t\t", 
            
            RowBox[{"_", "\[Rule]", "Black"}]}], "\n", "\t\t\t\t", "}"}]}], 
         "]"}]}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{"template", "=", "\n", "\t\t\t\t", 
         RowBox[{"Rasterize", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Framed", "[", 
            RowBox[{"\"\<\>\"", ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Background", "\[Rule]", "keyColor"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"ImageSize", "\[Rule]", "id"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"FrameStyle", "\[Rule]", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", "\n", 
                "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{
                   RowBox[{"_", "?", "ColorQ"}], "|", "_Directive", "|", 
                   "Thick", "|", "Thin", "|", "None"}], "]"}], ":>", "\n", 
                 "\t\t\t\t\t\t\t\t\t", "None"}]}], "\n", "\t\t\t\t\t\t\t\t", 
               "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Options", "@", "Framed"}]}], "]"}]}], "\n", 
            "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", "\"\<Image\>\"", 
           ",", "\n", "\t\t\t\t\t", 
           RowBox[{"RasterSize", "\[Rule]", "id"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", 
             RowBox[{"Options", "@", "Rasterize"}]}], "]"}]}], "\n", 
          "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"OptionValue", "[", "Epilog", "]"}], "@", "\n", "\t\t\t\t\t", 
        
        RowBox[{"ReplacePixelValue", "[", 
         RowBox[{"template", ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Thread", "[", "\n", "\t\t\t\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ppos", "=", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"PixelValuePositions", "[", 
                  RowBox[{
                  "template", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "keyColor", 
                   ",", "\n", "\t\t\t\t\t\t\t\t\t\t", ".5"}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "}"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t\t", 
               RowBox[{"ppos", "\[Rule]", 
                RowBox[{"PixelValue", "[", 
                 RowBox[{"img", ",", "ppos"}], "]"}]}]}], "\n", 
              "\t\t\t\t\t\t\t\t\t", "]"}], "\n", "\t\t\t\t\t\t\t\t", "]"}], 
            ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ppos", "=", 
                RowBox[{"PixelValuePositions", "[", 
                 RowBox[{"template", ",", "White"}], "]"}]}], "}"}], ",", 
              "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "->", 
                  RowBox[{"{", 
                   RowBox[{"1.", ",", "1.", ",", "1.", ",", "0."}], "}"}]}], 
                 "&"}], ",", "ppos"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", 
         "]"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FrameMasked", "[", 
    RowBox[{
     RowBox[{"k_", "\[Rule]", 
      RowBox[{"i_", "?", "ImageQ"}]}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"k", "->", 
    RowBox[{"FrameMasked", "[", 
     RowBox[{"i", ",", "ops"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FrameMasked", "[", 
    RowBox[{
     RowBox[{"r", ":", 
      RowBox[{"{", "__Rule", "}"}]}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"FrameMasked", "[", 
      RowBox[{"#", ",", "ops"}], "]"}], "&"}], "/@", "r"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBGIQHWU+84LspNeOUvf7LoPoWV3at0C0W8JFNjkgvSFj
hRiIfv7gnzSIfvH5lAKInvNfRg1EP7mbbgSidY6vAdOrLl+2BNEyU9OtwfTr
+ggQXVEjHAOid30zTALRYoI+ySCa51hlLog2YW2rAtEu9izTQPRaEREwzb3F
bh6ITty68RiIVrrz/QKIDqnnugiiV75MvQGirVp0noLoPw0BL8H6EtP+gOhL
nJFs8kD6zmkFfhB9yyvuLojep5cKpj9rWzIpAOmggFJmEP3s7HV2EJ3FIcIB
okWe3eYB0f/Xi/GCaO/1ruIg+viNnYog+p0LTymILmyeVQWi9Vr+d4LoKW0V
XSD6n3+ZhxKQ9l231R9EHz6+qUgZFF7P95SA6D/5zt9BNMfV/j8gGgB7kMCl

  "],ExpressionUUID->"8fc29572-c2c5-489e-a827-fb5c47653466"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ColorizedAppearances\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697397193246132*^9, 3.6973972022373543`*^9}, 
   3.697417921588291*^9, 3.697417955995948*^9, {3.697549580036457*^9, 
   3.6975495852344217`*^9}},ExpressionUUID->"80a488c6-5300-4047-85b3-\
f0040f49386e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"gradientPreservingColoration", "[", 
     RowBox[{
      RowBox[{"image_", "?", "ImageQ"}], ",", 
      RowBox[{"colorValue_", "?", "ColorQ"}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"img", "=", 
         RowBox[{"ColorConvert", "[", 
          RowBox[{"image", ",", "Hue"}], "]"}]}], ",", "\n", "\t", "\t\t", 
        RowBox[{"color", "=", 
         RowBox[{"ColorConvert", "[", 
          RowBox[{"colorValue", ",", "Hue"}], "]"}]}]}], "\n", "\t", "\t\t", 
       "}"}], ",", "\n", "\t", "\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"brightnessDistance", "=", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"color", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "-", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Median", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"ImageData", "@", 
                RowBox[{"ColorConvert", "[", 
                 RowBox[{"img", ",", "Hue"}], "]"}]}], ",", "1"}], "]"}], 
             "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "\n", "\t", "\t\t\t", "}"}], 
        ",", "\n", "\t\t\t", 
        RowBox[{"Image", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"ImageAdjust", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"ImageMultiply", "[", 
             RowBox[{
              RowBox[{"Lighter", "[", 
               RowBox[{"img", ",", "brightnessDistance"}], "]"}], ",", 
              "color"}], "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", 
              RowBox[{"-", ".1"}]}], "}"}]}], "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Interleaving", "\[Rule]", "True"}]}], "\n", "\t\t\t\t", 
         "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.697555329330236*^9, 3.6975553823399363`*^9}, {
   3.6975554548894567`*^9, 3.6975554678117332`*^9}, 3.697555756608281*^9, {
   3.70023459450353*^9, 
   3.7002346040772552`*^9}},ExpressionUUID->"0fee8e73-a631-497c-8ef1-\
dd5c22b3f7ab"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"$colorizerDefaultColors", "=", "\n", "\t", 
    RowBox[{"Hue", "@@@", "\n", "\t\t", 
     RowBox[{"Join", "[", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "1", ",", ".1"}], "]"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{".5", ",", "1", ",", ".25"}], "]"}]}], "}"}], "]"}], ",", 
       "\n", "\t", "\t\t", 
       RowBox[{"Tuples", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "1", ",", ".1"}], "]"}]}], "}"}], "]"}]}], "\n", 
      "\t\t\t", "]"}]}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColorizedAppearances", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"im_", "?", "ImageQ"}], ",", "\n", "\t", 
      RowBox[{"pixelValues", ":", 
       RowBox[{"{", 
        RowBox[{"__", "?", "ColorQ"}], "}"}], ":", "\n", "\t\t", 
       "$colorizerDefaultColors"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gradientPreservingColoration", "[", 
        RowBox[{"im", ",", "#"}], "]"}], "&"}], ",", "pixelValues"}], "]"}]}],
    ";", "\n", 
   RowBox[{
    RowBox[{"ColorizedAppearances", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"im_", "?", "ImageQ"}], ",", "\n", "\t", 
      RowBox[{"c_", "?", "ColorQ"}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"gradientPreservingColoration", "[", 
     RowBox[{"im", ",", "c"}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColorizedAppearances", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"assoc_Association", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Normal", "@", "#"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "\[Rule]", 
               RowBox[{"_", "?", "ImageQ"}]}], ")"}], ".."}], "}"}]}], "]"}], 
         "&"}], ")"}]}], ",", "\n", "\t", 
      RowBox[{"pixelValues", ":", 
       RowBox[{
        RowBox[{"_", "?", "ColorQ"}], "|", 
        RowBox[{"{", 
         RowBox[{"__", "?", "ColorQ"}], "}"}]}], ":", "\n", "\t\t", 
       "$colorizerDefaultColors"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
    RowBox[{"Normal", "@", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ColorizedAppearances", "[", 
         RowBox[{"#", ",", "pixelValues"}], "]"}], "&"}], ",", "assoc"}], 
      "]"}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ColorizedAppearances", "[", 
     RowBox[{
      RowBox[{"ims", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "\[Rule]", 
           RowBox[{"_", "?", "ImageQ"}]}], ")"}], ".."}], "}"}]}], ",", "\n", 
      "\t", 
      RowBox[{"pixelValues", ":", 
       RowBox[{
        RowBox[{"_", "?", "ColorQ"}], "|", 
        RowBox[{"{", 
         RowBox[{"__", "?", "ColorQ"}], "}"}]}], ":", "\n", "\t\t", 
       "$colorizerDefaultColors"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"assoc", "=", 
        RowBox[{"Association", "@", "ims"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ColorizedAppearances", "[", 
       RowBox[{"assoc", ",", "pixelValues"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ColorizedAppearances", "[", 
     RowBox[{
      RowBox[{"ims", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "\[Rule]", "_FrontEnd`FileName"}], ")"}], ".."}], 
        "}"}]}], ",", "\n", "\t", 
      RowBox[{"pixelValues", ":", 
       RowBox[{
        RowBox[{"_", "?", "ColorQ"}], "|", 
        RowBox[{"{", 
         RowBox[{"__", "?", "ColorQ"}], "}"}]}], ":", "\n", "\t\t", 
       "$colorizerDefaultColors"}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"ColorizedAppearances", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", "#"}], "\[Rule]", 
          RowBox[{"FEImport", "[", 
           RowBox[{"Last", "@", "#"}], "]"}]}], "&"}], ",", "ims"}], "]"}], 
      ",", "\n", "\t\t", "pixelValues"}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColorizedAppearances", "[", 
     RowBox[{
      RowBox[{"ims", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_", "\[Rule]", "_RawBoxes"}], ")"}], ".."}], "}"}]}], ",", 
      "\n", "\t", 
      RowBox[{"pixelValues", ":", 
       RowBox[{
        RowBox[{"_", "?", "ColorQ"}], "|", 
        RowBox[{"{", 
         RowBox[{"__", "?", "ColorQ"}], "}"}]}], ":", "\n", "\t\t", 
       "$colorizerDefaultColors"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"assoc", "=", 
        RowBox[{
         RowBox[{"ToExpression", "@*", "First"}], "/@", 
         RowBox[{"Association", "@", "ims"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ColorizedAppearances", "[", 
       RowBox[{"assoc", ",", "pixelValues"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColorizedAppearances", "[", 
     RowBox[{"s_String", ",", "\n", "\t", 
      RowBox[{"pixelValues", ":", 
       RowBox[{
        RowBox[{"_", "?", "ColorQ"}], "|", 
        RowBox[{"{", 
         RowBox[{"__", "?", "ColorQ"}], "}"}]}], ":", "\n", "\t\t", 
       "$colorizerDefaultColors"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"resource", "=", 
        RowBox[{"FEResourceFind", "[", "s", "]"}]}], "}"}], ",", "\n", "\t\t", 
      RowBox[{"Replace", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"FEFormatResource", "@", "\n", "\t\t\t\t", 
         RowBox[{"FirstCase", "[", 
          RowBox[{"resource", ",", "\n", "\t", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"_", "?", "ImageQ"}], "|", "_FrontEnd`FileName"}], 
                ")"}]}], ")"}], ".."}], "}"}], ",", "\n", "\t\t\t\t\t", 
           "$Failed", ",", "\[Infinity]"}], "]"}]}], ",", 
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"$Failed", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
           RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"FirstCase", "[", 
              RowBox[{"resource", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"_", "?", "ImageQ"}], "|", "_RawBoxes"}], ",", "\n", 
               "\t\t\t\t\t\t\t", "$Failed", ",", "\[Infinity]"}], "]"}], ",", 
             
             RowBox[{"{", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"i", ":", 
                RowBox[{"Except", "[", "$Failed", "]"}]}], ":>", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"ColorizedAppearances", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<Default\>\"", "->", "i"}], "}"}], ",", 
                 "pixelValues"}], "]"}]}], "\n", "\t\t\t\t\t\t\t", "}"}]}], 
            "]"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"l_", ":>", "\n", "\t\t\t\t", 
           RowBox[{"ColorizedAppearances", "[", 
            RowBox[{"l", ",", "pixelValues"}], "]"}]}]}], "\n", "\t\t\t", 
         "}"}]}], "]"}]}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColorizedAppearances", "[", 
     RowBox[{"spec_", ",", "\n", "\t", 
      RowBox[{"cd", ":", 
       RowBox[{"_Integer", "|", 
        RowBox[{"_String", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"ColorData", "[", "#", "]"}], ",", 
             "_ColorDataFunction"}], "]"}], "&"}], ")"}]}]}]}]}], "]"}], ":=",
     "\n", "\t", 
    RowBox[{"ColorizedAppearances", "[", 
     RowBox[{"spec", ",", "\n", "\t\t", 
      RowBox[{"DeleteDuplicates", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ColorData", "[", "cd", "]"}], "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "100"}], "}"}]}], "]"}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"List", "@@", "#"}], "-", 
             RowBox[{"List", "@@", "#2"}]}], ")"}]}], "<", ".05"}], "&"}]}], 
       "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", "\t", 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.697394298049162*^9, 3.6973944136896763`*^9}, {
   3.697394492345326*^9, 3.6973946223575373`*^9}, {3.697394654803451*^9, 
   3.697394699505722*^9}, {3.697394765324621*^9, 3.6973949211259537`*^9}, {
   3.6973949646795797`*^9, 3.6973949930543833`*^9}, {3.697395177066114*^9, 
   3.697395206832327*^9}, {3.697395242513982*^9, 3.6973952438492813`*^9}, {
   3.69739528254456*^9, 3.697395322377616*^9}, {3.69739583402759*^9, 
   3.6973958921761217`*^9}, {3.697396450223111*^9, 3.6973964505084753`*^9}, {
   3.6973965083260193`*^9, 3.6973965951861773`*^9}, {3.697396642912468*^9, 
   3.697396650624254*^9}, {3.69739720804174*^9, 3.697397217338519*^9}, 
   3.697416182709385*^9, {3.697417906800169*^9, 3.697417913689952*^9}, {
   3.697417956627666*^9, 3.697418080404922*^9}, {3.697418141395026*^9, 
   3.697418178168582*^9}, {3.697549589786792*^9, 3.697549604679359*^9}, {
   3.697549926710011*^9, 3.6975499905518703`*^9}, {3.697550236575471*^9, 
   3.697550254252295*^9}, {3.697550378932375*^9, 3.697550392080571*^9}, {
   3.69755045791966*^9, 3.697550578409801*^9}, {3.6975554720428658`*^9, 
   3.697555546603106*^9}, {3.697555617371747*^9, 3.6975557342628813`*^9}, {
   3.697555828681278*^9, 3.697555832391267*^9}, {3.69755589893139*^9, 
   3.697555933043363*^9}, {3.6975559805980663`*^9, 3.697555980941732*^9}, {
   3.697584818961259*^9, 3.6975848459023657`*^9}, {3.697584917227098*^9, 
   3.697584919395719*^9}, {3.697584963289647*^9, 3.69758511122325*^9}, {
   3.697585144156979*^9, 3.6975851563710546`*^9}, {3.697585198337326*^9, 
   3.697585219977169*^9}, {3.697681242220056*^9, 3.697681267496002*^9}, {
   3.697681318597995*^9, 3.697681391890024*^9}, {3.69768145859993*^9, 
   3.6976815489172487`*^9}, {3.700233241073114*^9, 3.7002333204865427`*^9}, {
   3.7002443713589487`*^9, 3.700244389577536*^9}, 
   3.700244421333446*^9},ExpressionUUID->"2f6171e5-2ddc-4c40-afef-\
ebc46ac9e5a6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ColorizationAdjust\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6980193055602903`*^9, 3.69801930987129*^9}, {
  3.6980194204492807`*^9, 3.6980194261762457`*^9}, {3.729096881073338*^9, 
  3.729096882416157*^9}},ExpressionUUID->"d1ee34ac-9aa9-433c-835f-\
abf07850bdd2"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"ColorizationAdjust", "[", 
     RowBox[{"color_", ",", "appearanceList_List"}], "]"}], ":=", "\n", "\t", 
    
    RowBox[{"MapThread", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"First", "@", "#2"}], "->", "\n", "\t\t\t", 
        RowBox[{"#", "@", 
         RowBox[{"Last", "@", "#2"}]}]}], "&"}], ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Take", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"cd", "=", "\n", "\t", "\t\t\t\t", 
              RowBox[{"ColorDistance", "[", 
               RowBox[{"color", ",", "Black", ",", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"DistanceFunction", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], ")"}]}]}],
                "]"}]}], "\n", "\t", "\t\t\t\t", "}"}], ",", "\n", "\t", 
            "\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"rescale", "=", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"cd", "<", ".5"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                  
                  RowBox[{
                   RowBox[{"Cos", "[", 
                    RowBox[{"\[Pi]", "*", "cd"}], "]"}], "^", "3"}], ",", 
                  "\n", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"1", "/", "6"}], 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", 
                    RowBox[{"2", "\[Pi]", " ", "cd"}], "]"}], ",", 
                    RowBox[{"Tan", "[", 
                    RowBox[{"\[Pi]", " ", "cd"}], "]"}]}], "}"}]}]}], "-", 
                   ".01"}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}]}], "\n", "\t",
                "\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"rescale", "<", "0"}], ",", "\n", "\t", 
                "\t\t\t\t\t\t", 
                RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Image", "[", 
                    RowBox[{
                    RowBox[{"Darker", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"-", "rescale"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Interleaving", "\[Rule]", "True"}]}], "\n", "\t",
                     "\t\t\t\t\t\t\t\t\t", "]"}], "&"}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t", "Identity", ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t", "Identity"}], "\n", "\t", 
                 "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"Identity", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Image", "[", 
                    RowBox[{
                    RowBox[{"Lighter", "[", 
                    RowBox[{"#", ",", "rescale"}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Interleaving", "\[Rule]", "True"}]}], "\n", "\t",
                     "\t", "\t", "\t", "\t\t\t\t\t", "]"}], "&"}], ",", "\n", 
                  "\t", "\t\t\t\t\t\t\t", "Identity"}], "}"}]}], "\n", "\t", 
               "\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t", "]"}]}], 
           "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"UpTo", "@", 
           RowBox[{"Length", "@", "appearanceList"}]}]}], "\n", "\t\t\t\t", 
         "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"Take", "[", 
         RowBox[{"appearanceList", ",", 
          RowBox[{"UpTo", "[", "3", "]"}]}], "]"}]}], "\n", "\t\t\t", "}"}]}],
      "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.6980193141576*^9, 3.698019428526352*^9}, 
   3.6980194845918007`*^9},ExpressionUUID->"0bdb44ab-8b2e-4f7a-ab6b-\
a7d60f822f3c"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]UUID stuff\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7025929983013906`*^9, 
  3.702593002275985*^9}},ExpressionUUID->"fde4063e-cf7c-4b82-a647-\
d371d21366dc"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]UUIDButton\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.702593877718526*^9, 
  3.702593880149219*^9}},ExpressionUUID->"74da6ca5-ecec-418b-95ee-\
349d7af2d4f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "UUIDButton", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<UUID\>\"", "\[Rule]", "Automatic"}], ",", "\n", "\t", 
       "\t\t", 
       RowBox[{"ControlType", "\[Rule]", "Button"}]}], "\n", "\t", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "Button", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"UUIDButton", "[", 
    RowBox[{"lab_", ",", "cmd_", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"uuid", "=", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "\"\<UUID\>\"", "]"}], ",", 
          RowBox[{"Automatic", ":>", 
           RowBox[{"CreateUUID", "[", "\"\<Button-\>\"", "]"}]}]}], "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"but", "=", 
        RowBox[{"OptionValue", "[", "ControlType", "]"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"EventHandler", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"but", "[", 
          RowBox[{"lab", ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"CheckAll", "[", 
             RowBox[{"cmd", ",", " ", 
              RowBox[{
               RowBox[{"UUIDActive", "[", "uuid", "]"}], "=", "False"}]}], 
             "]"}], ";", "\n", "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"UUIDActive", "[", "uuid", "]"}], "=", "False"}]}], ",", 
           "\n", "\t\t\t\t\t", 
           RowBox[{"Evaluate", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t", "\t\t\t\t\t", 
               RowBox[{"Options", "@", "but"}]}], "\n", "\t\t\t\t\t\t\t", 
              "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
          "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Appearance", "\[Rule]", "a_"}], ")"}], ":>", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{"Appearance", "\[Rule]", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"a", ",", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Dynamic", "@", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"TrueQ", "@", 
                   RowBox[{"UUIDActive", "[", "uuid", "]"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t", "\"\<Pressed\>\"", ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t", "Automatic"}], "\n", 
                 "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t", 
              "}"}]}]}], ")"}]}], ",", "\n", "\t\t\t\t", "1"}], "]"}], ",", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nab", "=", 
             RowBox[{"OptionValue", "[", "Enabled", "]"}]}], "}"}], ",", "\n",
            "\t\t\t\t", 
           RowBox[{
           "\"\<MouseClicked\>\"", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"TrueQ", "@", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{"nab", ",", " ", 
                   RowBox[{"d_Dynamic", "\[RuleDelayed]", 
                    RowBox[{"First", "[", "d", "]"}]}]}], "]"}], ",", " ", 
                 RowBox[{"Automatic", "\[Rule]", "True"}]}], "]"}]}], ",", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"UUIDActive", "[", "uuid", "]"}], "=", "True"}]}], 
             "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", 
         "\n", "\t\t\t", 
         RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "\n", "\t\t\t", 
        "}"}]}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"UUIDButton", "~", "SetAttributes", "~", "HoldAll"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.702592886712421*^9, 3.702592987053321*^9}, {
  3.702593209586042*^9, 3.7025934610446672`*^9}, {3.702593584373427*^9, 
  3.702593590223167*^9}, {3.702594040794379*^9, 3.7025941010471487`*^9}, {
  3.702594920660507*^9, 3.702594924864311*^9}, {3.702594991450612*^9, 
  3.7025950031275*^9}, {3.7205585699698343`*^9, 3.7205586362845783`*^9}, {
  3.7206597242087927`*^9, 3.7206597335754843`*^9}, {3.720980932840157*^9, 
  3.7209809663879232`*^9}, {3.720981289975881*^9, 3.7209813086231117`*^9}, {
  3.723236419324596*^9, 
  3.723236445267488*^9}},ExpressionUUID->"df96d909-cbbe-4706-b712-\
8b374e2fdae1"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientStuff\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700492152375885*^9, 3.700492156565686*^9}, {
  3.7019967002958*^9, 
  3.701996700910913*^9}},ExpressionUUID->"798ea36b-85a7-482d-91ed-\
1788d4ace0c8"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientPanelAppearance\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700463201267091*^9, 
  3.7004632063311653`*^9}},ExpressionUUID->"6260171f-530d-4c56-95ed-\
c03d69bc1fda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientPanelAppearance", "]"}], "=", "\n", "\t", 
   
   RowBox[{"Options", "@", "GradientAppearance"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPanelAppearance", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"c", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"_", "?", "ColorQ"}], ",", 
        RowBox[{"_", "?", "ColorQ"}], ",", 
        RowBox[{"_", "?", "ColorQ"}]}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"center", ":", "\n", "\t\t", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}], ",", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}]}], "}"}]}], ":", 
      "\n", "\t\t", 
      RowBox[{"Scaled", "[", "0", "]"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AppearanceReadyImage", "@", "\n", "\t\t", 
    RowBox[{"GradientAppearance", "[", 
     RowBox[{"c", ",", "center", ",", "ops"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPanelAppearance", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"c_", "?", "ColorQ"}], "}"}], ",", "\n", "\t", 
     RowBox[{"center", ":", "\n", "\t\t", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}], ",", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}]}], "}"}]}], ":", 
      "\n", "\t\t", 
      RowBox[{"Scaled", "[", "0", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AppearanceReadyImage", "@", "\n", "\t\t", 
    RowBox[{"GradientAppearance", "[", 
     RowBox[{"c", ",", "center", ",", "ops"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPanelAppearance", "[", 
    RowBox[{
     RowBox[{"c_", "?", "ColorQ"}], ",", "\n", "\t", 
     RowBox[{"center", ":", "\n", "\t\t", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}], ",", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}]}], "}"}]}], ":", 
      "\n", "\t\t", 
      RowBox[{"Scaled", "[", "0", "]"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AppearanceReadyImage", "@", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "->", 
        RowBox[{"GradientAppearance", "[", 
         RowBox[{"c", ",", "center", ",", "ops"}], "]"}]}], "&"}], ",", "\n", 
      "\t\t", 
      RowBox[{"{", 
       RowBox[{"\"\<Default\>\"", ",", "\"\<Hover\>\""}], "}"}]}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPanelAppearance", "[", 
    RowBox[{
     RowBox[{"Optional", "[", 
      RowBox[{
       RowBox[{"Automatic", "|", "Generic"}], ",", "Automatic"}], "]"}], ",", 
     "\n", "\t", 
     RowBox[{"center", ":", "\n", "\t\t", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled", "|", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}], ",", 
         RowBox[{
          RowBox[{"_", "?", "NumericQ"}], "|", "_Scaled"}]}], "}"}]}], ":", 
      "\n", "\t\t", 
      RowBox[{"Scaled", "[", "0", "]"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"GradientPanelAppearance", "[", 
    RowBox[{
     RowBox[{"GrayLevel", "[", ".95", "]"}], ",", "center", ",", "ops"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"GradientPanelAppearance", "[", 
   RowBox[{"\"\<Palette\>\"", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"GradientPanelAppearance", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"GrayLevel", "[", ".85", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"GrayLevel", "[", ".9", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"GrayLevel", "[", ".96", "]"}]}], "\n", "\t\t\t", "}"}], ",", 
    "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"GrayLevel", "[", ".6", "]"}]}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7004632141782618`*^9, 3.700463248307304*^9}, {
   3.700463306145042*^9, 3.700463321052073*^9}, {3.700492102710752*^9, 
   3.700492105170932*^9}, {3.700492607860506*^9, 3.700492690983967*^9}, {
   3.7004938713909273`*^9, 3.7004939007136307`*^9}, {3.700493947204206*^9, 
   3.700493954032761*^9}, {3.70050734192731*^9, 3.700507343079566*^9}, {
   3.700784273788157*^9, 3.7007842823376827`*^9}, {3.700784315825326*^9, 
   3.7007843376122427`*^9}, 3.700788968645438*^9, {3.700789035324016*^9, 
   3.7007890495796547`*^9}, 
   3.7007891739383793`*^9},ExpressionUUID->"f34086df-cc08-4076-942f-\
f333d476ff20"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientPanel\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700492167799342*^9, 
  3.7004921706141033`*^9}},ExpressionUUID->"6e169556-a9b1-40a6-af55-\
63def734ef14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientPanel", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "Panel", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPanel", "[", 
    RowBox[{"lab_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"Panel", "[", 
    RowBox[{"lab", ",", "\n", "\t\t", 
     RowBox[{"Appearance", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"GradientPanelAppearance", "@@", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"c", ":", 
            RowBox[{
             RowBox[{"Except", "[", "_List", "]"}], "|", 
             RowBox[{"{", 
              RowBox[{"__", "?", "ColorQ"}], "}"}]}]}], "\[RuleDelayed]", 
           "\n", "\t\t\t\t\t\t", 
           RowBox[{"{", "c", "}"}]}], "\n", "\t\t\t\t\t", "}"}]}], "]"}]}]}], 
     ",", "\n", "\t\t", "ops"}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700493481566371*^9, 3.7004935010790586`*^9}, {
   3.700493607801939*^9, 3.700493628526143*^9}, {3.700493778324984*^9, 
   3.700493804800324*^9}, {3.700784197205201*^9, 3.70078423402464*^9}, 
   3.700784348054968*^9},ExpressionUUID->"7015fd44-e269-4941-89a0-\
d6b8ffbda31e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientButtonAppearance\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700462979549238*^9, 
  3.700462988229282*^9}},ExpressionUUID->"11840900-2e90-4dd8-b9c1-\
7eeff8f7114d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientButtonAppearance", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{"Appearance", "\[Rule]", "Automatic"}], "\n", "\t\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "GradientAppearance", "]"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "FrameMasked", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonAppearance", "[", 
    RowBox[{
     RowBox[{"c", ":", 
      RowBox[{"{", 
       RowBox[{"__", "?", "ColorQ"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"AppearanceReadyImage", "@", "\n", "\t\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"OptionValue", "[", "RoundingRadius", "]"}], ">", "0"}], "||",
          "\n", "\t\t\t\t", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"OptionValue", "@", "FrameStyle"}], ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"Thick", "|", "Thin", "|", "_Directive"}]}], "]"}]}], "//",
         "TrueQ"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"FrameMasked", "[", 
         RowBox[{"#", ",", "\n", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"FrameStyle", "\[Rule]", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Darker", "@", 
                    RowBox[{"First", "@", "c"}]}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"d", ":", 
                    RowBox[{"Thick", "|", "Thin", "|", "_Thickness"}]}], ":>",
                     "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"d", ",", 
                    RowBox[{"Darker", "@", 
                    RowBox[{"First", "@", "c"}]}]}], "]"}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{"f_", ":>", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"First", "@", "c"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Except", "[", 
                    RowBox[{"_", "?", "ColorQ"}], "]"}], "\[Rule]", "f"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                  "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t",
               "ops"}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Options", "@", "FrameMasked"}]}], "\n", "\t\t\t\t\t", 
           "]"}]}], "\n", "\t\t\t\t", "]"}], "&"}], ",", "\n", "\t\t\t", 
       "Identity"}], "\n", "\t\t\t", "]"}], "@", "\n", "\t\t", 
     RowBox[{"MapThread", "[", 
      RowBox[{"Rule", ",", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<Default\>\"", ",", "\"\<Hover\>\"", ",", "\"\<Pressed\>\""}], 
          "}"}], ",", "\n", "\t\t\t", 
         RowBox[{"{", "\t", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"GradientAppearance", "[", 
            RowBox[{"c", ",", 
             RowBox[{"Scaled", "[", ".25", "]"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "RoundingRadius", "]"}], ">", 
                    "0"}], "||", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "FrameStyle"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thick", "|", "Thin", "|", "_Directive"}]}], 
                    "]"}]}], "//", "TrueQ"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", "\n", 
                   "\t\t\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t\t\t", 
                  "]"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"ImageAdjust", "->", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{
                    RowBox[{"OptionValue", "@", "ImageAdjust"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"n", ":", 
                    RowBox[{"{", 
                    RowBox[{"__", "?", "NumericQ"}], "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "n"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n_", ",", "_", ",", "_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "n"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                    "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t\t", "ops"}], 
                "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Options", "@", "GradientAppearance"}]}], "\n", 
              "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"GradientAppearance", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Lighter", "[", 
                RowBox[{"#", ",", ".2"}], "]"}], "&"}], "/@", "c"}], ",", 
             RowBox[{"Scaled", "[", ".25", "]"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "RoundingRadius", "]"}], ">", 
                    "0"}], "||", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "FrameStyle"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thick", "|", "Thin", "|", "_Directive"}]}], 
                    "]"}]}], "//", "TrueQ"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", "\n", 
                   "\t\t\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t\t\t", 
                  "]"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"ImageAdjust", "->", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{
                    RowBox[{"OptionValue", "@", "ImageAdjust"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"n", ":", 
                    RowBox[{"{", 
                    RowBox[{"__", "?", "NumericQ"}], "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "n"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "n_", ",", "_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "n"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                    "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t\t", "ops"}], 
                "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Options", "@", "GradientAppearance"}]}], "\n", 
              "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"GradientAppearance", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Darker", "[", 
                RowBox[{"#", ",", ".1"}], "]"}], "&"}], "/@", "c"}], ",", 
             "\n", "\t\t\t\t\t", 
             RowBox[{"Scaled", "/@", 
              RowBox[{"{", 
               RowBox[{".65", ",", ".25"}], "}"}]}], ",", "\n", "\t\t\t\t\t", 
             
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "RoundingRadius", "]"}], ">", 
                    "0"}], "||", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "FrameStyle"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Thick", "|", "Thin", "|", "_Directive"}]}], 
                    "]"}]}], "//", "TrueQ"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", "\n", 
                   "\t\t\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t\t\t", 
                  "]"}], ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"ImageAdjust", "->", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{
                    RowBox[{"OptionValue", "@", "ImageAdjust"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"n", ":", 
                    RowBox[{"{", 
                    RowBox[{"__", "?", "NumericQ"}], "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Reverse", "@", "n"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_", ",", "n_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"n", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Automatic", "->", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", ".05"}], ",", "0", ",", "0."}], "}"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Automatic", "->", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", ".05"}], ",", "0", ",", "0."}], "}"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t\t", "}"}], ",", 
               "\n", "\t\t\t\t\t\t", 
               RowBox[{"Options", "@", "GradientAppearance"}]}], "\n", 
              "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
          "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t\t", 
      "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonAppearance", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"c_", "?", "ColorQ"}], ",", 
     RowBox[{"app", ":", 
      RowBox[{"_String", "|", "_Symbol"}], ":", "Automatic"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"Except", "[", 
       RowBox[{"_", "?", "OptionQ"}], "]"}], "..."}], ",", "\n", "\t\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientButtonAppearance", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"app", ",", 
         RowBox[{"Automatic", ":>", 
          RowBox[{"OptionValue", "@", "Appearance"}]}]}], "]"}], ",", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"\"\<Palette\>\"", "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"Lighter", "[", 
             RowBox[{"c", ",", ".2"}], "]"}], ",", 
            RowBox[{"Lighter", "[", 
             RowBox[{"c", ",", ".4"}], "]"}]}], "}"}]}], ",", "\n", "\t\t\t", 
         
         RowBox[{"Flat", ":>", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"Darker", "[", 
             RowBox[{"c", ",", ".05"}], "]"}], ",", 
            RowBox[{"Lighter", "[", 
             RowBox[{"c", ",", ".05"}], "]"}]}], "}"}]}], ",", "\n", "\t\t\t", 
         RowBox[{"\"\<Shiny\>\"", "\[RuleDelayed]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Darker", "[", 
             RowBox[{"c", ",", ".2"}], "]"}], ",", 
            RowBox[{"Lighter", "[", 
             RowBox[{"c", ",", ".2"}], "]"}], ",", "c"}], "}"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"\"\<Retro\>\"", ":>", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"Gray", ",", "c", ",", "Gray"}], "}"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"\"\<Test1\>\"", ":>", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Lighter", "[", 
             RowBox[{"c", ",", ".6"}], "]"}], ",", "c", ",", 
            RowBox[{"Darker", "[", 
             RowBox[{"c", ",", ".6"}], "]"}]}], "}"}]}], ",", "\n", "\t\t\t", 
         
         RowBox[{"\"\<Test2\>\"", ":>", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"Darker", "[", 
             RowBox[{"c", ",", ".2"}], "]"}], ",", "c"}], "}"}]}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"\"\<Negative\>\"", ":>", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"ColorNegate", "[", "c", "]"}], ",", "c"}], "}"}]}], ",", 
         "\n", "\t\t\t", 
         RowBox[{"_", "->", 
          RowBox[{"{", 
           RowBox[{"c", ",", "c", ",", "c"}], "}"}]}]}], "\n", "\t\t\t", 
        "}"}]}], "]"}], ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
     RowBox[{"ImageAdjust", "->", 
      RowBox[{"{", 
       RowBox[{"0", ",", ".025", ",", 
        RowBox[{"-", ".05"}]}], "}"}]}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GradientButtonAppearance", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"app", ":", 
       RowBox[{"_String", "|", "_Symbol"}], ":", "Automatic"}], ",", "\n", 
      "\t\t", 
      RowBox[{
       RowBox[{"Except", "[", 
        RowBox[{"_", "?", "ColorQ"}], "]"}], "..."}], ",", "\n", "\t\t", 
      RowBox[{"c_", "?", "ColorQ"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Except", "[", 
        RowBox[{"_", "?", "OptionQ"}], "]"}], "..."}], ",", "\n", "\t\t", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t\t", 
    RowBox[{"GradientButtonAppearance", "[", 
     RowBox[{"c", ",", "app", ",", "ops"}], "]"}]}], ";"}], 
  RowBox[{"(*", "\n", "\t", 
   RowBox[{
    RowBox[{"GradientButtonAppearance", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Replace", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"app", ",", 
          RowBox[{"Automatic", ":>", 
           RowBox[{"OptionValue", "@", "Appearance"}]}]}], "]"}], ",", "\n", 
        "\t\t\t", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"\"\<Palette\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"c", ",", 
             RowBox[{"Lighter", "[", 
              RowBox[{"c", ",", ".2"}], "]"}], ",", 
             RowBox[{"Lighter", "[", 
              RowBox[{"c", ",", ".7"}], "]"}]}], "}"}]}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"Flat", ":>", 
           RowBox[{"{", 
            RowBox[{"c", ",", 
             RowBox[{"Darker", "[", 
              RowBox[{"c", ",", ".05"}], "]"}], ",", 
             RowBox[{"Lighter", "[", 
              RowBox[{"c", ",", ".05"}], "]"}]}], "}"}]}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"\"\<Shiny\>\"", "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"c", ",", 
             RowBox[{"Darker", "[", 
              RowBox[{"c", ",", ".2"}], "]"}], ",", 
             RowBox[{"Lighter", "[", 
              RowBox[{"c", ",", ".2"}], "]"}]}], "}"}]}], ",", "\n", "\t\t\t", 
          RowBox[{"_", "->", 
           RowBox[{"{", 
            RowBox[{"c", ",", "c", ",", "c"}], "}"}]}]}], "\n", "\t\t\t", 
         "}"}]}], "]"}], ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
      RowBox[{"ImageAdjust", "->", 
       RowBox[{"{", 
        RowBox[{"0", ",", ".025", ",", 
         RowBox[{"-", ".05"}]}], "}"}]}]}], "\n", "\t\t", "]"}], ";"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonAppearance", "[", 
    RowBox[{"\"\<Palette\>\"", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientButtonAppearance", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"GrayLevel", "[", ".85", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"GrayLevel", "[", ".9", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"GrayLevel", "[", ".96", "]"}]}], "\n", "\t\t\t", "}"}], ",", 
     "\n", "\t\t", "ops", ",", "\n", "\t\t", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"GrayLevel", "[", ".6", "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonAppearance", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Optional", "[", 
      RowBox[{
       RowBox[{"Automatic", "|", "Generic"}], ",", "Automatic"}], "]"}], ",", 
     "\n", "\t", 
     RowBox[{"app", ":", 
      RowBox[{"_String", "|", "_Symbol"}], ":", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientButtonAppearance", "[", 
    RowBox[{
     RowBox[{"GrayLevel", "[", ".95", "]"}], ",", "app", ",", "ops"}], 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700462992537507*^9, 3.700463130487561*^9}, 
   3.700463174753429*^9, 3.700463287891272*^9, {3.700463424345334*^9, 
   3.7004634418726263`*^9}, {3.700464555470748*^9, 3.7004645615741653`*^9}, {
   3.7004914241489553`*^9, 3.700491428062978*^9}, {3.7004915636589117`*^9, 
   3.700491582315206*^9}, {3.700491618535198*^9, 3.700491639878587*^9}, {
   3.7004917608050203`*^9, 3.7004917686860027`*^9}, {3.7004922886199923`*^9, 
   3.700492443540325*^9}, {3.70049270131384*^9, 3.700492795218608*^9}, {
   3.700493045516602*^9, 3.700493049244883*^9}, {3.7004930907975903`*^9, 
   3.700493093315671*^9}, {3.700495261347177*^9, 3.700495584287294*^9}, {
   3.700496749736239*^9, 3.700496779463526*^9}, {3.700496924902636*^9, 
   3.700496973524117*^9}, {3.7004971277701693`*^9, 3.700497222883629*^9}, {
   3.700497467414592*^9, 3.70049750250895*^9}, {3.700497567171321*^9, 
   3.700497602904437*^9}, 3.700497659132999*^9, {3.700497704425103*^9, 
   3.700497779884336*^9}, {3.7004978332588453`*^9, 3.700497836746065*^9}, {
   3.700497888140436*^9, 3.700497935153451*^9}, {3.70049797347258*^9, 
   3.700497980319928*^9}, {3.700498498748843*^9, 3.70049855432268*^9}, {
   3.700498590885943*^9, 3.700498614337384*^9}, {3.7005073288479013`*^9, 
   3.700507329303821*^9}, {3.7007843553534117`*^9, 3.700784360231141*^9}, {
   3.700788950091518*^9, 3.7007889566586533`*^9}, {3.7007890635007763`*^9, 
   3.7007891473832808`*^9}, {3.700790459671113*^9, 3.700790493943561*^9}, 
   3.70079073858556*^9, {3.700837346243087*^9, 3.700837353226426*^9}, 
   3.700837402802116*^9, {3.7008374769174767`*^9, 3.700837547674756*^9}, {
   3.700837592280816*^9, 3.700837624526127*^9}, {3.7008376731581583`*^9, 
   3.700837746156818*^9}, {3.700837834785203*^9, 3.700837843358156*^9}, {
   3.700837874902844*^9, 3.700837891787603*^9}, {3.700837932149024*^9, 
   3.700837946817214*^9}, {3.700837992658744*^9, 3.7008380064067707`*^9}, {
   3.700931440992087*^9, 3.7009314683179007`*^9}, {3.709510551916675*^9, 
   3.709510608694951*^9}, {3.70951070184511*^9, 3.7095111087821407`*^9}, 
   3.709511174638545*^9, {3.7281004666824923`*^9, 
   3.728100481200728*^9}},ExpressionUUID->"39940ce1-a2b5-4a6e-a71e-\
35849e622c70"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientButton\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7004921758299913`*^9, 
  3.700492181333725*^9}},ExpressionUUID->"1a064e9f-2a13-4627-ba6b-\
edb316e1d0db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientButton", "]"}], "=", "\n", "\t", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Options", "[", "Button", "]"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<UUID\>\"", "\[Rule]", "None"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"notRules", "=", "\n", "\t", 
      RowBox[{"Except", "[", 
       RowBox[{"_FilterRules", "|", "_Rule", "|", "_RuleDelayed", "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}]}], 
       "]"}]}], "\n", "\t", "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"GradientButton", "[", 
      RowBox[{"lab_", ",", "\n", "\t", 
       RowBox[{"expr", ":", "notRules", ":", "Null"}], ",", "\n", "\t", 
       RowBox[{"ops", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
     "\n", "\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"a", "=", "\n", "\t\t\t", 
          RowBox[{"(", 
           RowBox[{"GradientButtonAppearance", "@@", "\n", "\t", "\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
              RowBox[{"{", "\n", "\t", "\t\t\t\t", 
               RowBox[{
                RowBox[{"c", ":", 
                 RowBox[{
                  RowBox[{"Except", "[", "_List", "]"}], "|", 
                  RowBox[{"{", 
                   RowBox[{"__", "?", "ColorQ"}], "}"}]}]}], ":>", "\n", "\t",
                 "\t\t\t\t\t", 
                RowBox[{"{", "c", "}"}]}], "\n", "\t", "\t\t\t\t", "}"}]}], 
             "]"}]}], ")"}]}], ",", "\n", "\t\t", 
         RowBox[{"uuid", "=", "\n", "\t\t\t", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<UUID\>\"", "]"}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"Automatic", "|", "_String"}]}], "\n", "\t\t\t\t", 
           "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{"uuid", ",", "\n", "\t\t\t", 
         RowBox[{"UUIDButton", "[", 
          RowBox[{"lab", ",", "expr", ",", "\n", "\t\t\t\t", 
           RowBox[{"Appearance", "\[Rule]", "a"}], ",", "\n", "\t\t\t\t", 
           "ops"}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"Button", "[", 
          RowBox[{"lab", ",", "expr", ",", "\n", "\t", "\t\t\t", 
           RowBox[{"Appearance", "\[Rule]", "a"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"Except", "[", "\"\<UUID\>\"", "]"}]}], "\n", 
            "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
        "]"}]}], "\n", "\t\t", "]"}]}]}], "\n", "\t", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"GradientButton", "~", "SetAttributes", "~", "HoldRest"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700492446658334*^9, 3.700492583296794*^9}, {
   3.700493271763996*^9, 3.700493273187358*^9}, {3.7004933420212603`*^9, 
   3.700493381449629*^9}, {3.7004934297022257`*^9, 3.7004934326536407`*^9}, {
   3.700493522325367*^9, 3.7004935324802628`*^9}, {3.700493572903902*^9, 
   3.700493576629732*^9}, {3.700493635879431*^9, 3.700493642572928*^9}, {
   3.700493679301999*^9, 3.700493769284583*^9}, {3.700494190480699*^9, 
   3.700494192977995*^9}, {3.7005065659931602`*^9, 3.7005065990579576`*^9}, {
   3.700784262090879*^9, 3.7007842633996964`*^9}, {3.70204333323367*^9, 
   3.7020434808172207`*^9}, {3.7021654018134613`*^9, 3.7021654073497963`*^9}, 
   3.70216545092865*^9, {3.702593505092306*^9, 3.702593676574094*^9}, {
   3.702593889871243*^9, 3.702593904022414*^9}, {3.702594308977186*^9, 
   3.702594348092828*^9}, {3.7025948422673607`*^9, 3.7025948606770678`*^9}, {
   3.702596509003627*^9, 
   3.702596521073514*^9}},ExpressionUUID->"7dd64a8d-4b19-4972-90b3-\
243c030fecd6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientDropDownAppearance\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.700503052904605*^9},ExpressionUUID->"d3eb8500-a497-4530-a369-\
653916988739"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientDropDownAppearance", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Options", "@", "GradientButtonAppearance"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDropDownAppearance", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"h1", ":", 
      RowBox[{
       RowBox[{"_", "?", "ColorQ"}], "|", 
       RowBox[{"{", 
        RowBox[{"__", "?", "ColorQ"}], "}"}]}]}], ",", "\n", "\t", 
     RowBox[{"h2", ":", 
      RowBox[{
       RowBox[{"_", "?", "ColorQ"}], "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"_", "?", "ColorQ"}], ",", 
         RowBox[{"_", "?", "ColorQ"}]}], "}"}]}], ":", 
      RowBox[{"{", 
       RowBox[{"Black", ",", "Gray"}], "}"}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"base", "=", "\n", "\t\t", 
       RowBox[{"GradientButtonAppearance", "[", "\n", "\t\t\t", 
        RowBox[{"h1", ",", "\n", "\t", "\t\t", "ops", ",", "\n", "\t", "\t\t", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"20", ",", "24"}], "}"}]}], ",", "\n", "\t", "\t\t", 
         RowBox[{"ImageCompose", "\[Rule]", 
          RowBox[{"{", "\n", "\t", "\t\t\t", 
           RowBox[{"Graphics", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"First", "@", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"{", "h2", "}"}]}]}], ",", "\n", "\t\t\t\t\t", 
               RowBox[{"Triangle", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"2", ",", "0"}], "}"}]}], "}"}], "]"}]}], "\n", 
              "\t", "\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t", 
             RowBox[{"ImageSize", "\[Rule]", "10"}]}], "\n", "\t", "\t\t\t\t",
             "]"}], "\n", "\t\t\t\t", "}"}]}]}], "\n", "\t\t\t", "]"}]}], 
      "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "@", "h2"}], ",", "\n", "\t\t\t", 
       RowBox[{"Append", "[", 
        RowBox[{"base", ",", "\n", "\t\t\t\t", 
         RowBox[{"\"\<Disabled\>\"", "->", 
          RowBox[{"Lookup", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"GradientButtonAppearance", "[", 
             RowBox[{
             "h1", ",", "\n", "\t", "\t\t\t\t\t", "ops", ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"20", ",", "24"}], "}"}]}], ",", "\n", "\t", "\t", 
              "\t", "\t", "\t\t", 
              RowBox[{"ImageCompose", "\[Rule]", 
               RowBox[{"{", "\n", "\t", "\t", "\t", "\t", "\t\t\t", 
                RowBox[{"Graphics", "[", 
                 RowBox[{
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Last", "@", "h2"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"Triangle", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "0"}], "}"}]}], "}"}], "]"}]}], "\n", 
                   "\t", "\t", "\t", "\t", "\t\t\t\t", "}"}], ",", "\n", "\t",
                   "\t", "\t", "\t", "\t\t\t\t", 
                  RowBox[{"ImageSize", "\[Rule]", "10"}]}], "\n", "\t", "\t", 
                 "\t", "\t", "\t\t\t\t", "]"}], "\n", "\t\t\t\t\t\t\t", 
                "}"}]}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", 
            "\t\t\t\t\t", "\"\<Default\>\""}], "\n", "\t\t\t\t\t", "]"}]}]}], 
        "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", "base"}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDropDownAppearance", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Optional", "[", 
      RowBox[{
       RowBox[{"Generic", "|", "Automatic"}], ",", "Automatic"}], "]"}], ",", 
     "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientDropDownAppearance", "[", 
    RowBox[{
     RowBox[{"GrayLevel", "[", ".95", "]"}], ",", 
     RowBox[{"GrayLevel", "[", ".4", "]"}], ",", "\n", "\t\t", "ops"}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDropDownAppearance", "[", 
    RowBox[{"PopupMenu", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientDropDownAppearance", "[", 
    RowBox[{
     RowBox[{"Hue", "[", 
      RowBox[{"0.59", ",", "0.71", ",", "0.75"}], "]"}], ",", "White", ",", 
     "\n", "\t\t", "ops"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDropDownAppearance", "[", 
    RowBox[{"ActionMenu", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientDropDownAppearance", "[", 
    RowBox[{
     RowBox[{"GrayLevel", "[", ".2", "]"}], ",", "White", ",", "\n", "\t\t", 
     "ops"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDropDownAppearance", "[", 
    RowBox[{"\"\<Palette\>\"", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientDropDownAppearance", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"GrayLevel", "[", ".85", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"GrayLevel", "[", ".9", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"GrayLevel", "[", ".96", "]"}]}], "\n", "\t\t\t", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Black", ",", "Gray"}], "}"}], ",", "\n", "\t\t", "ops", ",", 
     "\n", "\t\t", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"GrayLevel", "[", ".6", "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7005030675754747`*^9, 3.700503081823474*^9}, {
   3.7005036767100677`*^9, 3.700503680779554*^9}, {3.7005037121469793`*^9, 
   3.700503737075513*^9}, {3.700503802772626*^9, 3.700503803230426*^9}, {
   3.7005038459451857`*^9, 3.700503846271948*^9}, {3.700503890992347*^9, 
   3.7005038911426363`*^9}, {3.700507353871735*^9, 3.700507428715609*^9}, {
   3.700785796623324*^9, 3.700785817060293*^9}, {3.7007878989895353`*^9, 
   3.7007879045704393`*^9}, {3.7007879430181503`*^9, 3.700788021175866*^9}, {
   3.7007891823911333`*^9, 3.7007891974617567`*^9}, {3.700790535185852*^9, 
   3.700790678730435*^9}, {3.700795823653222*^9, 3.700795825642577*^9}, {
   3.7008402325612593`*^9, 3.7008402460797462`*^9}, {3.700840684654228*^9, 
   3.700840686788254*^9}, {3.7027537311345873`*^9, 3.7027537438804483`*^9}, {
   3.7027538914178667`*^9, 3.702753910849309*^9}, 
   3.728099477829649*^9},ExpressionUUID->"323f54d7-5989-4b97-9eb9-\
84d0e385fd37"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientPopupDropDown\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700503032285844*^9, 3.700503035588952*^9}, {
  3.700784613977169*^9, 
  3.700784615303112*^9}},ExpressionUUID->"bbc01321-3836-44cf-a8be-\
28853e9be1a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GradientPopupDropDown"}], "=", "\n", "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
    RowBox[{"Join", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"ImageSize", "->", "\n", "\t\t\t\t\t", "Automatic"}], ",", 
        "\n", "\t\t\t\t", 
        RowBox[{"Appearance", "->", "\n", "\t\t\t\t\t", "PopupMenu"}], ",", 
        "\n", "\t\t\t\t", 
        RowBox[{"\"\<UUID\>\"", "->", "\n", "\t\t\t\t\t", "None"}]}], "\n", 
       "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"Options", "@", "GradientDropDownAppearance"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"Options", "@", "PopupMenu"}]}], "\n", "\t\t\t", "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPopupDropDown", "[", "\n", "\t", 
    RowBox[{"var_", ",", "settings_List", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<UUID\>\"", "]"}], ",", 
         RowBox[{"Automatic", "\[RuleDelayed]", 
          RowBox[{"CreateUUID", "[", "\"\<PopupMenu-\>\"", "]"}]}]}], "]"}]}],
       "}"}], ",", "\n", "\t", 
     RowBox[{"PopupMenu", "[", "\n", "\t\t", 
      RowBox[{"var", ",", "\n", "\t\t", "settings", ",", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"var", ",", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
           RowBox[{"e_", ",", "___"}], "]"}], "\[RuleDelayed]", "e"}]}], "\n",
         "\t\t\t", "]"}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"u", ",", "_String"}], "]"}], ",", "\n", "\t\t\t", 
          "Button", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"UUIDButton", "[", 
             RowBox[{"##", ",", 
              RowBox[{"\"\<UUID\>\"", "\[Rule]", 
               RowBox[{"OptionValue", "[", "\"\<UUID\>\"", "]"}]}]}], "]"}], 
            "&"}], "*)"}], ",", "\n", "\t\t\t", "Button"}], "]"}], "[", 
        RowBox[{"\"\<\>\"", ",", "Null", ",", "\n", "\t\t\t", 
         RowBox[{"Appearance", "->", "\n", "\t\t\t\t", 
          RowBox[{"GradientDropDownAppearance", "@@", "\n", "\t\t\t\t\t", 
           RowBox[{"Append", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"c_", "?", "ColorQ"}], "\[RuleDelayed]", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorDistance", "[", 
                    RowBox[{"c", ",", "Black"}], "]"}], ">", ".5"}], ",", 
                    "Black", ",", "White"}], "]"}]}], "}"}]}], "\n", "\t", 
                   "\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], "\n", 
                "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
               "1"}], "\n", "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"ImageSize", "\[Rule]", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", 
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"20", ",", "24"}], "}"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", "h_"}], "}"}], "\[RuleDelayed]",
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"20", ",", "h"}], "}"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"w_", ",", "Automatic"}], "}"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"w", ",", "24"}], "}"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t\t\t",
             "]"}]}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"ImageMargins", "\[Rule]", "0"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t", 
           "BaselinePosition"}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
        "]"}], ",", "\n", "\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"Appearance", "\[Rule]", "None"}], ",", "\n", "\t\t\t", 
           "ops"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
         RowBox[{"FilterRules", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Options", "@", "PopupMenu"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Except", "[", "\n", "\t\t\t\t\t", 
            RowBox[{"Alternatives", "@@", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{"First", ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"FilterRules", "[", 
                  RowBox[{
                   RowBox[{"Options", "@", "GradientDropDownAppearance"}], 
                   ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Except", "[", "BaselinePosition", "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}], ",", 
               RowBox[{
               "{", "\n", "\t\t\t\t\t\t\t", "\"\<UUID\>\"", "\n", 
                "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t\t\t\t", 
            "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n",
       "\t\t", "]"}]}], "\n", "\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700503210640039*^9, 3.7005032594140167`*^9}, {
   3.700503297677294*^9, 3.700503390019752*^9}, {3.70050345970533*^9, 
   3.700503640678771*^9}, {3.700503833355227*^9, 3.7005038337694597`*^9}, {
   3.700503882328356*^9, 3.700503882862698*^9}, {3.7005039369702883`*^9, 
   3.700503953987442*^9}, {3.700503997091798*^9, 3.700504025553093*^9}, {
   3.700505015384385*^9, 3.7005050292403812`*^9}, {3.70050512474932*^9, 
   3.700505140790506*^9}, {3.7005056580389833`*^9, 3.7005056703062067`*^9}, {
   3.700506008417292*^9, 3.7005060224200974`*^9}, 3.70050607777988*^9, {
   3.7005072820590067`*^9, 3.700507298673085*^9}, {3.7005074467280483`*^9, 
   3.7005074646838913`*^9}, {3.700508173786201*^9, 3.700508196887068*^9}, {
   3.7007846358224983`*^9, 3.700784637029245*^9}, {3.70079138328021*^9, 
   3.7007914152522497`*^9}, {3.700791446390483*^9, 3.700791447678445*^9}, {
   3.7007915247755136`*^9, 3.70079152650254*^9}, {3.7008399498467617`*^9, 
   3.700839950101499*^9}, {3.702593716157872*^9, 3.702593723476099*^9}, {
   3.70259393125581*^9, 3.7025939913929377`*^9}, {3.7025941087689238`*^9, 
   3.702594135875113*^9}, {3.702594239973281*^9, 3.702594273242485*^9}, {
   3.702594365655095*^9, 3.7025944126234303`*^9}, {3.7025944780729647`*^9, 
   3.7025944788252296`*^9}, 3.7025966355818*^9, {3.702597606229949*^9, 
   3.702597662248047*^9}, {3.709251295742587*^9, 3.709251302744779*^9}, {
   3.709251339332933*^9, 3.7092513488477707`*^9}, {3.709251445871786*^9, 
   3.709251454390226*^9}, 3.7092514876639557`*^9, {3.709251714952917*^9, 
   3.709251727241068*^9}, {3.709251799469145*^9, 3.709251820467211*^9}, 
   3.7092519546296062`*^9, {3.728099488419568*^9, 
   3.728099498537134*^9}},ExpressionUUID->"3c3e7521-028e-483b-b9c5-\
7101eb80c1ba"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientActionDropDown\[RightFloor]", "CodeSubsubsection",
 
 Evaluatable->True,
 CellChangeTimes->{3.7005031857944107`*^9, 
  3.7007846177458687`*^9},ExpressionUUID->"a1f756ea-f8b9-481a-8894-\
988c621ab062"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GradientActionDropDown"}], "=", "\n", "\t", 
   RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Join", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"ImageSize", "\[Rule]", "\n", "\t\t\t\t\t", "Automatic"}], 
         ",", "\n", "\t\t\t\t", 
         RowBox[{"Appearance", "->", "\n", "\t\t\t\t\t", "ActionMenu"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"\"\<UUID\>\"", "->", "\n", "\t\t\t\t\t", "None"}]}], "\n", 
        "\t\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "GradientDropDownAppearance"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Options", "@", "ActionMenu"}]}], "\n", "\t\t\t", "]"}], ",", 
     "\n", "\t\t", "First"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientActionDropDown", "[", 
    RowBox[{"actions_List", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<UUID\>\"", "]"}], ",", 
         RowBox[{"Automatic", "\[RuleDelayed]", 
          RowBox[{"CreateUUID", "[", "\"\<ActionMenu-\>\"", "]"}]}]}], 
        "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"ActionMenu", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"u", ",", "_String"}], "]"}], ",", " ", 
          RowBox[{
           RowBox[{"UUIDButton", "[", 
            RowBox[{"##", ",", 
             RowBox[{"\"\<UUID\>\"", "\[Rule]", "u"}]}], "]"}], "&"}], ",", 
          "Button"}], "]"}], "[", 
        RowBox[{"\"\<\>\"", ",", "Null", ",", "\n", "\t", "\t\t\t", 
         RowBox[{"Appearance", "->", "\n", "\t", "\t\t\t\t", 
          RowBox[{
          "GradientDropDownAppearance", "@@", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"Append", "[", "\n", "\t\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
                  RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"c_", "?", "ColorQ"}], "\[RuleDelayed]", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ColorDistance", "[", 
                    RowBox[{"c", ",", "Black"}], "]"}], ">", ".5"}], ",", 
                    "Black", ",", "White"}], "]"}]}], "}"}]}], "\n", "\t", 
                   "\t", "\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], "\n", 
                "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}],
              ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"ImageSize", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", 
                RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Automatic", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"20", ",", "24"}], "}"}]}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"Automatic", ",", "h_"}], "}"}], "\[RuleDelayed]",
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"20", ",", "h"}], "}"}]}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"w_", ",", "Automatic"}], "}"}], ":>", "\n", "\t",
                    "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", 
                    RowBox[{"w", ",", "24"}], "}"}]}]}], "\n", "\t", 
                 "\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}]}], "\n", 
            "\t\t\t\t\t\t\t", "]"}]}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n",
        "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"u", ",", "_String"}], "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"actions", ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"l_", "\[RuleDelayed]", "a_"}], ")"}], ":>", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"(", 
               RowBox[{"l", "\[RuleDelayed]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"CheckAbort", "[", 
                   RowBox[{"a", ",", 
                    RowBox[{
                    RowBox[{"UUIDActive", "[", "u", "]"}], "=", "False"}]}], 
                   "]"}], ";", 
                  RowBox[{
                   RowBox[{"UUIDActive", "[", "u", "]"}], "=", "False"}]}], 
                 ")"}]}], ")"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{"e_", ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"(", 
               RowBox[{"e", "\[RuleDelayed]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"UUIDActive", "[", "u", "]"}], "=", "False"}], 
                  ";"}], ")"}]}], ")"}]}]}], "\n", "\t\t\t\t", "}"}], ",", 
           "\t", "\n", "\t\t\t\t", "1"}], "]"}], ",", "\n", "\t\t\t", 
         "actions"}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
       RowBox[{"Appearance", "\[Rule]", "None"}], ",", "\n", "\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"Options", "@", "ActionMenu"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Except", "[", "\n", "\t\t\t\t\t", 
            RowBox[{"Alternatives", "@@", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Map", "[", 
                RowBox[{"First", ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"FilterRules", "[", 
                  RowBox[{
                   RowBox[{"Options", "@", "GradientDropDownAppearance"}], 
                   ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Except", "[", "BaselinePosition", "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}], ",", 
               RowBox[{
               "{", "\n", "\t\t\t\t\t\t\t", "\"\<UUID\>\"", "\n", 
                "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t\t\t\t", 
            "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n",
       "\t\t", "]"}]}], "\n", "\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.696865192381896*^9, 3.696865238747184*^9}, {
   3.696865285153688*^9, 3.696865292721414*^9}, {3.696865332903081*^9, 
   3.69686534710107*^9}, {3.69686538782873*^9, 3.696865417478325*^9}, {
   3.696865705192381*^9, 3.6968657053971*^9}, {3.696866381315271*^9, 
   3.69686641218851*^9}, {3.6968664690484447`*^9, 3.69686648155205*^9}, {
   3.698019026736598*^9, 3.698019047217126*^9}, {3.700505047042243*^9, 
   3.7005050822205133`*^9}, {3.700505159172861*^9, 3.700505212896052*^9}, {
   3.700506029238995*^9, 3.700506051636026*^9}, {3.700506084270906*^9, 
   3.700506086671277*^9}, {3.700507475608274*^9, 3.700507491590396*^9}, 
   3.700508206107225*^9, {3.700784620798543*^9, 3.700784622821178*^9}, {
   3.700784905329165*^9, 3.7007849469216843`*^9}, {3.7007858792355623`*^9, 
   3.700785880865556*^9}, {3.700791535723764*^9, 3.7007915360228043`*^9}, {
   3.700840005517496*^9, 3.7008400105705214`*^9}, {3.7025941414678164`*^9, 
   3.702594164241317*^9}, {3.7025941956474333`*^9, 3.7025942166929283`*^9}, {
   3.702594490989944*^9, 3.7025945159543533`*^9}, {3.702596611754429*^9, 
   3.7025966250416117`*^9}, {3.702597223166436*^9, 3.702597240852873*^9}, {
   3.702597271131122*^9, 3.702597452311322*^9}, {3.7025974825288057`*^9, 
   3.702597540813685*^9}, {3.7092512243494463`*^9, 3.70925125386553*^9}, {
   3.728099511868886*^9, 
   3.728099537931966*^9}},ExpressionUUID->"ebea4299-7ba8-4e73-ba97-\
69d30331608d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientButtonDropDownRow\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700838637315802*^9, 
  3.7008386427143593`*^9}},ExpressionUUID->"52ab1731-74aa-43a8-a053-\
204fdd361e16"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientButtonDropDownRow", "]"}], "=", "\n", 
   "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", 
    RowBox[{"Join", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Options", "@", "GradientButton"}], ",", "\n", "\t\t", 
      RowBox[{"Options", "@", "GradientPopupDropDown"}], ",", "\n", "\t\t", 
      RowBox[{"Options", "@", "GradientActionDropDown"}]}], "\n", "\t\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonDropDownRow", "[", "\n", "\t", 
    RowBox[{"buttonLbl_", ",", "buttonCommand_", ",", "\n", "\t", 
     RowBox[{"static", ":", 
      RowBox[{"_", "?", "BooleanQ"}], ":", "False"}], ",", 
     RowBox[{"enabled", ":", 
      RowBox[{
       RowBox[{"_", "?", "BooleanQ"}], "|", "Automatic"}], ":", "Automatic"}],
      ",", "\n", "\t", "dropDownType_", ",", "dropDownVar_", ",", 
     "dropDownList_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{"imgSize", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i_", "?", "NumericQ"}], ",", "h_"}], "}"}], ",", 
              "_"}], "}"}], ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "-", "22"}], ",", "h"}], "}"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{"i_", "?", "NumericQ"}], ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"i", "-", "22"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i_", "?", "NumericQ"}], ",", "h_"}], "}"}], ":>", "\n",
             "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"i", "-", "22"}], ",", "h"}], "}"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"b_List", ",", "_"}], "}"}], ":>", "\n", "\t\t\t\t\t", 
            "b"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
             RowBox[{"d_", ",", " ", "e___"}], "]"}], ":>", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Dynamic", "[", 
             RowBox[{
              RowBox[{"d", "-", "22"}], ",", " ", "e"}], "]"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                  RowBox[{"d_", ",", " ", "e___"}], "]"}], ",", " ", "h_"}], 
                "}"}], ",", "_"}], "}"}], "|", "\n", "\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                RowBox[{"d_", ",", " ", "e___"}], "]"}], ",", " ", "h_"}], 
              "}"}]}], ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Dynamic", "[", 
               RowBox[{
                RowBox[{"d", "-", "22"}], ",", " ", "e"}], "]"}], ",", " ", 
              "h"}], "}"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"e", ":", 
             RowBox[{"Except", "[", "_List", "]"}]}], ":>", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"e", ",", " ", "Automatic"}], "}"}]}]}], "\n", 
          "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t", "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"uuid", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "\"\<UUID\>\"", "]"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"Automatic", "\[RuleDelayed]", 
            RowBox[{"CreateUUID", "[", "\"\<ButtonRow-\>\"", "]"}]}]}], 
          "]"}]}], "}"}], ",", "\n", "\t\t", 
       RowBox[{"Row", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"GradientButton", "[", 
             RowBox[{"buttonLbl", ",", "buttonCommand", ",", "\n", "\t\t\t\t", 
              RowBox[{"Evaluate", "@", "\n", "\t\t\t\t", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "\n", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Appearance", "->", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"aBase", "=", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "Appearance"}], ",", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a_List", ",", "___"}], "}"}], "\[RuleDelayed]", 
                    "a"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a_", ",", "___", ",", "_List"}], "}"}], 
                    "\[RuleDelayed]", "a"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FrameStyle", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"OptionValue", "[", "FrameStyle", "]"}]}]}], "\n",
                     "\t", "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", "1"}], "\n", "\t", "\t\t\t\t\t\t\t\t",
                     "]"}]}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{"aBase", ",", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"c", ":", "\"\<Palette\>\""}], ":>", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "c"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"PopupMenu", "|", "ActionMenu"}], ":>", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t", "White"}], ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Automatic", "|", "Generic"}], "\[RuleDelayed]", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", "Automatic"}], 
                    ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ImagePadding", "\[Rule]", "_"}], ")"}], 
                    "\[Rule]", "Nothing"}]}], "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "1"}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ImagePadding", "->", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "GradientImagePaddingFormat", "[", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "First", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"aBase", ",", "OptionQ"}], "]"}], ",", 
                    "ImagePadding", ",", "Automatic"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                   "\t\t\t\t\t", 
                   RowBox[{
                   "ImageSize", "\[Rule]", "\n", "\t\t\t\t\t\t", "imgSize"}], 
                   ",", "\n", "\t\t\t\t\t", 
                   RowBox[{"FrameMargins", "->", "\n", "\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "FrameMargins"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    "i_Integer", "\[RuleDelayed]", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
                   RowBox[{"\"\<UUID\>\"", "->", "uuid"}], ",", "\n", 
                   "\t\t\t\t\t", "ops", ",", "\n", "\t\t\t\t\t", 
                   RowBox[{"If", "[", "\n", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"BooleanQ", "@", "enabled"}], ",", "\n", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"Enabled", "\[Rule]", "enabled"}], ",", "\n", 
                    "\t\t\t\t\t\t", "Nothing"}], "\n", "\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
                 "\t\t\t\t\t", 
                 RowBox[{"Options", "@", "GradientButton"}]}], "\n", 
                "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}], "//", 
            RowBox[{"If", "[", 
             RowBox[{"static", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"ReplaceAll", "[", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Button", "[", 
                 RowBox[{"a___", ",", 
                  RowBox[{"Appearance", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"d_", ",", "___"}], "}"}]}], ",", "b___"}], "]"}],
                 "\[RuleDelayed]", "\n", "\t", "\t", "\t", "\t", "\t", 
                "\t\t\t", 
                RowBox[{"Button", "[", 
                 RowBox[{"a", ",", 
                  RowBox[{"Appearance", "\[Rule]", "d"}], ",", "b"}], "]"}]}],
                "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
              "Identity"}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", 
           "\t\t\t", 
           RowBox[{"dropDownType", "[", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"dropDownType", "===", "GradientPopupDropDown"}], ",", 
               "\n", "\t", "\t", "\t\t\t", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"{", 
                 RowBox[{"dropDownVar", ",", "dropDownList"}], "}"}]}], ",", 
               "\n", "\t", "\t", "\t\t\t", "dropDownList"}], "\n", 
              "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Appearance", "->", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"base", "=", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"List", "@", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "Appearance"}], ",", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"___", ",", "a_List"}], "}"}], "\[RuleDelayed]", 
                    "a"}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_List", ",", "___", ",", "a_"}], "}"}], 
                    "\[RuleDelayed]", "a"}]}], "\n", "\t\t\t\t\t\t\t\t\t", 
                    "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t\t\t\t", "1"}], 
                    "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t",
                     "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"base", ",", " ", 
                    RowBox[{"Not", "@*", "OptionQ"}]}], "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FilterRules", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"base", ",", " ", "OptionQ"}], "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Except", "[", "ImagePadding", "]"}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ImagePadding", "->", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "GradientImagePaddingFormat", "[", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Last", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"base", ",", "OptionQ"}], "]"}], ",", 
                    "ImagePadding", ",", "Automatic"}], "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FrameStyle", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Automatic", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"base", ",", "Automatic"}], "]"}], ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"c", "=", 
                    RowBox[{"Darker", "@", 
                    RowBox[{"GrayLevel", "[", ".95", "]"}]}]}], "}"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "{", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Lighter", "@", "c"}], ",", "c"}], "}"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "c"}], "}"}]}], "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "Automatic"}], "\n", "\t", "\t",
                     "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t",
                     "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"c_", "?", "ColorQ"}], ":>", "\n", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Lighter", "@", "c"}], ",", "c"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"c", ",", "c"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t", "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"c_", "?", "ColorQ"}], ",", "v_"}], "}"}], ":>", 
                    "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Lighter", "@", "c"}], ",", "c"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"v", ",", "v"}], "}"}]}], "}"}]}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"ImageSize", "->", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{
                    RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
                    RowBox[{"{", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i_", "?", "NumericQ"}], ",", "h_"}], "}"}]}], 
                    "}"}], ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Automatic", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NumericQ", "@", "h"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"h", "-", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Switch", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<Palette\>\"", "|", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Palette\>\"", ",", "___"}], "}"}]}], ",", 
                    "1", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "_", ",", 
                    "2"}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "h"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"i_", "?", "NumericQ"}], ":>", "\n", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t", "Automatic"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", ":", 
                    RowBox[{"Except", "[", "_List", "]"}]}], ",", "h_"}], 
                    "}"}], ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Automatic", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"NumericQ", "@", "h"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"h", "-", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Switch", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<Palette\>\"", "|", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Palette\>\"", ",", "___"}], "}"}]}], ",", 
                    "1", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "_", ",", 
                    "2"}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "h"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "b_"}], "}"}], ":>", "\n", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t", "b"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Except", "[", "_List", "]"}], "->", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", "Automatic"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t", "\t",
                  "\t", "\t", "\t\t", 
                 RowBox[{
                 "FrameMargins", "->", "\n", "\t", "\t", "\t", "\t", "\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{
                    RowBox[{"OptionValue", "@", "FrameMargins"}], ",", "\n", 
                    "\t", "\t", "\t", "\t", "\t\t\t\t", 
                    RowBox[{
                    "i_Integer", "\[RuleDelayed]", "\n", "\t", "\t", "\t", 
                    "\t", "\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "\n", "\t", 
                   "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t\t\t\t\t", 
                 RowBox[{
                 "\"\<UUID\>\"", "->", "\n", "\t", "\t\t\t\t\t\t", "uuid"}], 
                 ",", "\n", "\t\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t\t", 
                "}"}], ",", "\n", "\t\t\t\t", 
               RowBox[{"Options", "@", "dropDownType"}]}], "\n", "\t\t\t\t", 
              "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "}"}], ",", 
         "\n", "\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t", 
           "BaselinePosition"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
        "]"}]}], "\n", "\t\t", "]"}]}], "\n", "\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "GradientButtonDropDownRow", "~", "SetAttributes", "~", "HoldRest"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7008386461703653`*^9, 3.700838730406691*^9}, {
   3.700838769519746*^9, 3.700838787431769*^9}, {3.700838829875992*^9, 
   3.700838961410016*^9}, {3.700839005617916*^9, 3.700839014417569*^9}, {
   3.7008391045513268`*^9, 3.7008391532232103`*^9}, {3.7008392007022877`*^9, 
   3.700839262764604*^9}, {3.7008393302078342`*^9, 3.700839338373472*^9}, 
   3.700839427114698*^9, {3.700839494446719*^9, 3.700839499894109*^9}, {
   3.700839882734414*^9, 3.700839905722983*^9}, {3.700839965161257*^9, 
   3.7008399825254717`*^9}, {3.700840042171557*^9, 3.700840085039885*^9}, {
   3.700840353022912*^9, 3.7008404097406054`*^9}, {3.700841355368526*^9, 
   3.700841364683321*^9}, {3.7008417380737057`*^9, 3.700841775921069*^9}, {
   3.700842370897859*^9, 3.7008424017105*^9}, {3.700842510611196*^9, 
   3.700842520763089*^9}, {3.70087654712731*^9, 3.700876571531476*^9}, {
   3.700876633643985*^9, 3.7008766461924257`*^9}, {3.7008766888599777`*^9, 
   3.700876710502865*^9}, {3.700931316613411*^9, 3.7009313191449823`*^9}, {
   3.700931603002557*^9, 3.700931637680344*^9}, {3.700937979930539*^9, 
   3.700937984177497*^9}, {3.7020504080419617`*^9, 3.702050514881446*^9}, {
   3.7025945368059587`*^9, 3.702594648343597*^9}, {3.702753929030608*^9, 
   3.702753958439002*^9}, {3.702753999546646*^9, 3.7027540018106203`*^9}, {
   3.702754038415498*^9, 3.70275410301766*^9}, {3.702755373698288*^9, 
   3.702755374856666*^9}, {3.702755405306161*^9, 3.702755460197689*^9}, {
   3.7027555958421793`*^9, 3.702755604786187*^9}, {3.702755690549447*^9, 
   3.7027557052040577`*^9}, {3.7027557637968283`*^9, 
   3.7027557932972527`*^9}, {3.702755830281205*^9, 3.702755844104879*^9}, {
   3.702755890950479*^9, 3.702755922899041*^9}, {3.702833661302393*^9, 
   3.702833694505722*^9}, {3.702833735767105*^9, 3.7028337821641283`*^9}, {
   3.702833828024316*^9, 3.702833830521888*^9}, {3.702833865173785*^9, 
   3.702833908039085*^9}, {3.7092443942328997`*^9, 3.709244506461384*^9}, {
   3.7092448205544662`*^9, 3.709244828895358*^9}, {3.709245133612287*^9, 
   3.709245144440819*^9}, {3.7092461185015707`*^9, 3.70924616862683*^9}, {
   3.709246234564866*^9, 3.709246456037438*^9}, {3.7092471689633827`*^9, 
   3.7092471689735107`*^9}, {3.709250479772695*^9, 3.7092505280673313`*^9}, {
   3.7092505821399193`*^9, 3.709250632405702*^9}, {3.709250679359593*^9, 
   3.709250686174121*^9}, {3.709251091254203*^9, 3.709251121630039*^9}, {
   3.709252265503997*^9, 3.709252287221089*^9}, {3.7204883582454767`*^9, 
   3.720488395231039*^9}, {3.720488501542358*^9, 3.7204885062605667`*^9}, {
   3.720488751171389*^9, 3.720488756065875*^9}, {3.720489022730616*^9, 
   3.7204890538459663`*^9}, {3.720489086718197*^9, 3.7204891398971148`*^9}, 
   3.720981336799672*^9, {3.728099275082674*^9, 3.7280993164619207`*^9}, {
   3.728099422793439*^9, 3.728099425120593*^9}, 
   3.728099463232279*^9},ExpressionUUID->"6b9f1030-e818-4c8e-a7ca-\
891debf19b3d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientPopupMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.700784896598871*^9},ExpressionUUID->"8d61b299-6646-4f2b-bce1-\
b1d3ad10bff0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GradientPopupMenu"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "GradientPopupDropDown"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientPopupMenu", "[", "\n", "\t", 
    RowBox[{"var_", ",", "settings_List", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"GradientButtonDropDownRow", "[", 
    RowBox[{
    "var", ",", "Null", ",", "True", ",", "Automatic", ",", "\n", "\t\t", 
     "GradientPopupDropDown", ",", "var", ",", "settings", ",", "\n", "\t\t", 
     
     RowBox[{"Evaluate", "@", "\n", "\t\t\t", 
      RowBox[{"Join", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Options", "@", "GradientPopupMenu"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Alternatives", "@@", 
           RowBox[{"Options", "@", "PopupMenu"}]}]}], "]"}]}], "\n", 
       "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700784951822261*^9, 3.700785018073098*^9}, {
   3.700785063427917*^9, 3.700785066361291*^9}, {3.7007852058924923`*^9, 
   3.7007852188312893`*^9}, {3.700785313925479*^9, 3.700785327052663*^9}, {
   3.700785902538699*^9, 3.700785934099382*^9}, {3.700786006952278*^9, 
   3.700786018734619*^9}, {3.700786198885645*^9, 3.700786215773713*^9}, {
   3.700787759876421*^9, 3.700787767187687*^9}, {3.7007878023149967`*^9, 
   3.700787802665142*^9}, {3.70078808805689*^9, 3.70078809612667*^9}, {
   3.700788294433755*^9, 3.7007882976111803`*^9}, {3.700838981568778*^9, 
   3.7008390537320023`*^9}, 3.7008391192718143`*^9, {3.700839242711689*^9, 
   3.7008393132777443`*^9}, {3.7008394115502234`*^9, 3.700839414923931*^9}, {
   3.7008400967662773`*^9, 3.700840165464163*^9}, {3.700842416827373*^9, 
   3.700842417376731*^9}, {3.700931757768483*^9, 
   3.7009317583806953`*^9}},ExpressionUUID->"940a894f-9ce4-456c-94a1-\
b9833ee18a1e"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientActionMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700785071656389*^9, 3.700785092438558*^9}, 
   3.700785258900218*^9},ExpressionUUID->"96f2892a-ea53-4fd1-afc4-\
4fb7b062f790"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GradientActionMenu"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "GradientActionDropDown"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientActionMenu", "[", 
    RowBox[{"lbl_", ",", "actions_List", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientButtonDropDownRow", "[", 
    RowBox[{
    "lbl", ",", "Null", ",", "True", ",", "Automatic", ",", "\n", "\t\t", 
     "GradientActionDropDown", ",", "None", ",", "actions", ",", "\n", "\t\t", 
     RowBox[{"Evaluate", "@", "\n", "\t\t\t", 
      RowBox[{"Join", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Options", "@", "GradientActionMenu"}], ",", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Alternatives", "@@", 
           RowBox[{"Options", "@", "ActionMenu"}]}]}], "]"}]}], "\n", 
       "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700785182155294*^9, 3.700785255545412*^9}, {
   3.700785300695485*^9, 3.700785310983694*^9}, {3.700785385838251*^9, 
   3.700785391639229*^9}, {3.700785627058934*^9, 3.7007856395930853`*^9}, {
   3.700785705860763*^9, 3.70078571437359*^9}, {3.700786044327199*^9, 
   3.700786045428112*^9}, {3.7007861510727997`*^9, 3.700786186591969*^9}, 
   3.700786222235882*^9, {3.700786519307118*^9, 3.700786522640746*^9}, {
   3.700786559536498*^9, 3.700786668301523*^9}, {3.7007874675958633`*^9, 
   3.700787483035265*^9}, {3.700787513074724*^9, 3.700787536064699*^9}, {
   3.700787680332942*^9, 3.700787747203174*^9}, {3.700788046434741*^9, 
   3.700788080031116*^9}, {3.700788306704432*^9, 3.700788307560217*^9}, {
   3.700840336145183*^9, 3.700840342462709*^9}, {3.700841410279455*^9, 
   3.700841455076386*^9}, {3.7008424205862293`*^9, 3.700842421114933*^9}, 
   3.7009317628170958`*^9},ExpressionUUID->"032bf1c2-3b7c-42eb-8688-\
b8a2cd9bf59b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientButtonPopupMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700504108834217*^9, 
  3.7005041288075113`*^9}},ExpressionUUID->"59717e0e-c29e-4db3-9f1d-\
6bf8282fcd47"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GradientButtonPopupMenu"}], "=", "\n", "\t", 
   RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Join", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Options", "@", "GradientPopupDropDown"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "GradientButton"}]}], "\n", "\t\t\t", "]"}], 
     ",", "\n", "\t\t", "First"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"notRules", "=", "\n", "\t", 
      RowBox[{"Except", "[", 
       RowBox[{"_FilterRules", "|", "_Rule", "|", "_RuleDelayed", "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}]}], 
       "]"}]}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"GradientButtonPopupMenu", "[", "\n", "\t", 
       RowBox[{"label_", ",", "\n", "\t", 
        RowBox[{"varList", ":", 
         RowBox[{"_List", "|", 
          RowBox[{"(", 
           RowBox[{"_List", "\[Rule]", "_"}], ")"}]}]}], ",", "\n", "\t", 
        RowBox[{"buttonCall", ":", "notRules", ":", "None"}], ",", "\n", "\t", 
        RowBox[{"ops", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
      "\n", "\t", 
      RowBox[{"GradientButtonPopupMenu", "[", 
       RowBox[{
       "Automatic", ",", "label", ",", "varList", ",", "buttonCall", ",", 
        "ops"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"GradientButtonPopupMenu", "[", "\n", "\t", 
       RowBox[{
        RowBox[{"varList", ":", 
         RowBox[{"_List", "|", 
          RowBox[{"(", 
           RowBox[{"_List", "\[Rule]", "_"}], ")"}]}]}], ",", "\n", "\t", 
        RowBox[{"buttonCall", ":", "notRules", ":", "None"}], ",", "\n", "\t", 
        RowBox[{"ops", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
      "\n", "\t", 
      RowBox[{"GradientButtonPopupMenu", "[", 
       RowBox[{
       "Automatic", ",", "Automatic", ",", "varList", ",", "buttonCall", ",", 
        "ops"}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"GradientButtonPopupMenu", "[", "\n", "\t", 
       RowBox[{"buttonLabel_", ",", "\n", "\t", "label_", ",", "\n", "\t", 
        RowBox[{"varList", ":", 
         RowBox[{"_List", "|", 
          RowBox[{"(", 
           RowBox[{"_List", "\[Rule]", "_"}], ")"}]}]}], ",", "\n", "\t", 
        RowBox[{"buttonCall", ":", "notRules", ":", "None"}], ",", "\n", "\t", 
        RowBox[{"ops", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
      "\n", "\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t", 
         RowBox[{
          RowBox[{"popVar", "=", "\n", "\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{"label", ",", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"s", "=", 
                    RowBox[{"Unique", "@", "\"\<FE`popupVar$\>\""}]}], "}"}], 
                  ",", "\n", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"s", "=", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"varList", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"k_", "\[Rule]", 
                    RowBox[{"v_", "\[RuleDelayed]", "v"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k_", "\[Rule]", "v_"}], ",", "___"}], "}"}], 
                    "\[RuleDelayed]", "v"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v_", ",", "___"}], "}"}], "\[RuleDelayed]", 
                    "v"}]}], "\n", "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ";", 
                   "\n", "\t\t\t\t\t\t", 
                   RowBox[{"Dynamic", "[", "s", "]"}]}]}], "\n", 
                 "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                 RowBox[{
                  RowBox[{"h_", "[", 
                   RowBox[{"s_Symbol", ",", "___"}], "]"}], ",", "e___"}], 
                 "]"}], ":>", "\n", "\t\t\t\t\t", 
                RowBox[{"Dynamic", "[", 
                 RowBox[{"s", ",", "e"}], "]"}]}]}], "\n", "\t\t\t\t", 
              "}"}]}], "]"}]}], ",", "\n", "\t\t", 
          RowBox[{"defaultElement", "=", "\n", "\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{"varList", ",", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"_List", "\[Rule]", "d_"}], ")"}], "\[RuleDelayed]", 
                "\n", "\t\t\t\t\t", "d"}], ",", "\n", "\t\t\t\t", 
               RowBox[{"_", "\[Rule]", "\"\<\>\""}]}], "\n", "\t\t\t\t", 
              "}"}]}], "]"}]}], ",", "\n", "\t\t", 
          RowBox[{"appearanceAssoc", "=", "\n", "\t\t\t", 
           RowBox[{"Association", "@", "\n", "\t\t\t\t", 
            RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Replace", "[", 
               RowBox[{"varList", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"l_List", "\[Rule]", "_"}], ")"}], "\[RuleDelayed]",
                  "l"}]}], "]"}], ",", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"RuleDelayed", "[", 
                  RowBox[{"a_", ",", "b_"}], "]"}], ":>", "\n", "\t", "\t", 
                 "\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"a", "\[Rule]", "b"}], ")"}]}], ",", "\n", "\t", 
                "\t", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"a", ":", 
                  RowBox[{"Except", "[", "_Rule", "]"}]}], ":>", "\n", "\t", 
                 "\t", "\t\t\t\t\t", 
                 RowBox[{"(", 
                  RowBox[{"a", "\[Rule]", "a"}], ")"}]}]}], "\n", "\t", 
               "\t\t\t\t", "}"}], ",", "1"}], "]"}]}]}]}], "\n", "\t\t", 
         "}"}], ",", "\n", "\t\t", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"call", "=", "\n", "\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"Unevaluated", "[", "buttonCall", "]"}], ",", 
              RowBox[{"{", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{"f_Function", ":>", "\n", "\t\t\t\t\t", 
                 RowBox[{"Hold", "@", 
                  RowBox[{"f", "[", 
                   RowBox[{"First", "@", "popVar"}], "]"}]}]}], ",", "\n", 
                "\t\t\t\t", 
                RowBox[{"e_", ":>", "\n", "\t\t\t\t\t", 
                 RowBox[{"Hold", "[", "e", "]"}]}]}], "\n", "\t\t\t\t", 
               "}"}]}], "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
          RowBox[{"GradientButtonDropDownRow", "[", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{"buttonLabel", ",", "\n", "\t\t\t\t\t", 
              RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{"label", ",", 
                   RowBox[{
                    RowBox[{"Except", "[", "_Dynamic", "]"}], ":>", 
                    "popVar"}]}], "]"}], ",", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                    RowBox[{"v_Symbol", ",", "f___"}], "]"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"appearanceAssoc", ",", 
                    RowBox[{"Key", "@", "v"}], ",", "defaultElement"}], "]"}],
                     ",", "f"}], "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                    RowBox[{
                    RowBox[{"h_", "[", 
                    RowBox[{"v_Symbol", ",", "s___"}], "]"}], ",", "f___"}], 
                    "]"}], ":>", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Dynamic", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"h", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"appearanceAssoc", ",", 
                    RowBox[{"Key", "@", "v"}], ",", "defaultElement"}], "]"}],
                     ",", "\n", "\t\t\t\t\t\t\t\t\t\t", "s"}], "]"}], ",", 
                    "f"}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "}"}]}], 
                "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ReleaseHold", "[", "call", "]"}], "===", "None"}], 
              ",", "Null"}], "]"}], ",", "\n", "\t\t\t\t", "False", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Unevaluated", "[", "buttonCall", "]"}], "=!=", 
              "None"}], ")"}], ",", "\n", "\t\t\t\t", "GradientPopupDropDown",
             ",", "popVar", ",", 
            RowBox[{"Replace", "[", 
             RowBox[{"varList", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"l_", "\[Rule]", "_"}], ")"}], "\[RuleDelayed]", 
               "l"}]}], "]"}], ",", "\n", "\t\t\t\t", 
            RowBox[{"Evaluate", "@", "\n", "\t\t\t\t\t", 
             RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"Options", "@", "GradientButtonPopupMenu"}], ",", 
                 "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"Alternatives", "@@", 
                  RowBox[{"Options", "@", "PopupMenu"}]}]}], "]"}]}], "\n", 
              "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
         "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]}]}], "\n", "\t", "]"}], 
  ";"}], "\n", 
 RowBox[{"GradientButtonPopupMenu", "~", "SetAttributes", "~", 
  "HoldRest"}]}], "CodeInput",
 CellChangeTimes->{{3.700240620543836*^9, 3.700240636115891*^9}, {
   3.700240929628191*^9, 3.7002409556170473`*^9}, 3.70024101055221*^9, {
   3.700241136919565*^9, 3.700241142462316*^9}, {3.7002413978260307`*^9, 
   3.70024140216656*^9}, {3.7002414408576603`*^9, 3.700241474790752*^9}, {
   3.700241517606447*^9, 3.700241533852529*^9}, {3.700242351194996*^9, 
   3.700242362565137*^9}, {3.700242825944888*^9, 3.700242866047015*^9}, {
   3.7002430561568537`*^9, 3.700243243132367*^9}, {3.700243967587541*^9, 
   3.700243999874667*^9}, {3.7002440397203913`*^9, 3.700244054143649*^9}, {
   3.700244583829852*^9, 3.7002446112831497`*^9}, {3.700244659668789*^9, 
   3.70024466359721*^9}, {3.7002448510321836`*^9, 3.700244891716278*^9}, {
   3.700504290854192*^9, 3.700504453912334*^9}, {3.700504552278141*^9, 
   3.70050457309803*^9}, {3.700504691053522*^9, 3.700504719977631*^9}, {
   3.700505324991569*^9, 3.700505361340032*^9}, {3.70050539679854*^9, 
   3.700505439211648*^9}, {3.700505731430544*^9, 3.700505757224812*^9}, {
   3.7005058547701883`*^9, 3.700505929491617*^9}, {3.700506159884739*^9, 
   3.700506163834482*^9}, {3.700506225095208*^9, 3.700506228989717*^9}, {
   3.7005063978161907`*^9, 3.700506401524138*^9}, {3.700506480579801*^9, 
   3.700506489247376*^9}, {3.7005072672110977`*^9, 3.7005072709799557`*^9}, {
   3.7005081154506073`*^9, 3.700508152666272*^9}, {3.700508288969207*^9, 
   3.7005082946841803`*^9}, {3.700508352871112*^9, 3.700508382936812*^9}, {
   3.7007846594457417`*^9, 3.7007846692435513`*^9}, {3.700786438475251*^9, 
   3.700786451374434*^9}, {3.700788124971163*^9, 3.700788129486199*^9}, {
   3.700788320130721*^9, 3.7007883246904488`*^9}, {3.700836798167253*^9, 
   3.7008367984784403`*^9}, {3.7008415011363783`*^9, 3.70084163067947*^9}, {
   3.7008416642700157`*^9, 3.7008417065451107`*^9}, {3.70084178884186*^9, 
   3.700841793352212*^9}, {3.700841911357386*^9, 3.700841957309564*^9}, {
   3.7008424318921013`*^9, 
   3.700842442755291*^9}},ExpressionUUID->"4fe99837-3c88-415a-bcc0-\
91f98742f5f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientButtonActionMenu\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700504108834217*^9, 
  3.700504127056251*^9}},ExpressionUUID->"b2916ad4-b60b-49dd-a935-\
6286ec71a33b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "GradientButtonActionMenu"}], "=", "\n", "\t", 
   RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Join", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Options", "@", "GradientActionDropDown"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Options", "@", "GradientButton"}]}], "\n", "\t\t\t", "]"}], 
     ",", "\n", "\t\t", "First"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonActionMenu", "[", "\n", "\t", 
    RowBox[{"label_", ",", "\n", "\t", 
     RowBox[{"actions_", "?", 
      RowBox[{"(", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}], 
        "]"}], ")"}]}], ",", "\n", "\t", 
     RowBox[{"buttonCall", ":", "\n", "\t\t", 
      RowBox[{"Except", "[", 
       RowBox[{"_FilterRules", "|", "_Rule", "|", "_RuleDelayed", "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}]}], 
       "]"}], ":", "\n", "\t\t", "None"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"GradientButtonDropDownRow", "[", 
    RowBox[{"label", ",", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"buttonCall", "===", "None"}], ",", "Null"}], "]"}], ",", "\n",
      "\t\t", "False", ",", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Unevaluated", "[", "buttonCall", "]"}], "=!=", "None"}], 
      ")"}], ",", "\n", "\t\t", "GradientActionDropDown", ",", "None", ",", 
     "actions", ",", "\n", "\t\t", 
     RowBox[{"Evaluate", "@", "\n", "\t\t\t", 
      RowBox[{"Join", "[", "\n", "\t\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{
          RowBox[{"Options", "@", "GradientActionDropDown"}], ",", "\n", "\t",
           "\t\t\t\t\t", 
          RowBox[{"Alternatives", "@@", 
           RowBox[{"Options", "@", "ActionMenu"}]}]}], "]"}]}], "\n", 
       "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{"GradientButtonActionMenu", "~", "SetAttributes", "~", 
  "HoldRest"}]}], "CodeInput",
 CellChangeTimes->{{3.6973821656920156`*^9, 3.697382183402545*^9}, {
   3.697382289313423*^9, 3.69738259279594*^9}, {3.697382625381299*^9, 
   3.697382738304822*^9}, {3.697382800911607*^9, 3.697383088167427*^9}, {
   3.697383135389296*^9, 3.697383205909336*^9}, {3.697383259721154*^9, 
   3.697383312990768*^9}, {3.697383378276988*^9, 3.697383442345158*^9}, {
   3.697383482694412*^9, 3.6973835595318193`*^9}, {3.6973836784156027`*^9, 
   3.6973838254589977`*^9}, {3.697383920251945*^9, 3.69738401175099*^9}, {
   3.697384198074231*^9, 3.697384215689941*^9}, {3.6973843171511602`*^9, 
   3.697384318339758*^9}, {3.6973843886865377`*^9, 3.697384509783372*^9}, {
   3.697384579367085*^9, 3.697384580329123*^9}, {3.697384620885165*^9, 
   3.69738475764298*^9}, {3.6973848239222*^9, 3.697384830095316*^9}, {
   3.697390386351933*^9, 3.6973904172845573`*^9}, {3.697390556513154*^9, 
   3.697390571903576*^9}, {3.697390688046825*^9, 3.697390812845055*^9}, {
   3.697416011825642*^9, 3.697416020701692*^9}, {3.697549719532386*^9, 
   3.697549719537388*^9}, {3.6980233870940742`*^9, 3.698023567274208*^9}, {
   3.698023636090556*^9, 3.698023724238296*^9}, {3.70024102587894*^9, 
   3.700241029737842*^9}, {3.700242591483098*^9, 3.70024260748868*^9}, {
   3.700242655823845*^9, 3.70024268176204*^9}, {3.700244635140917*^9, 
   3.700244645571203*^9}, {3.7002446768758793`*^9, 3.700244692782206*^9}, {
   3.700244738712452*^9, 3.700244739077037*^9}, {3.700244809215576*^9, 
   3.700244835602167*^9}, {3.7005044784907293`*^9, 3.700504533395769*^9}, {
   3.7005046319101057`*^9, 3.700504676327197*^9}, {3.70050578982644*^9, 
   3.7005057919294367`*^9}, {3.700505946805485*^9, 3.700505956384796*^9}, {
   3.700506266636044*^9, 3.70050627028273*^9}, {3.700506324103567*^9, 
   3.7005063883715477`*^9}, {3.700527847712803*^9, 3.700527849804213*^9}, {
   3.700527902285245*^9, 3.700527935437706*^9}, {3.700528073917115*^9, 
   3.7005280889585447`*^9}, {3.7005281964094763`*^9, 3.700528200505031*^9}, {
   3.70052834022314*^9, 3.700528362166013*^9}, {3.70078626912754*^9, 
   3.700786281321033*^9}, {3.700786408821116*^9, 3.700786425885166*^9}, {
   3.7007864598115387`*^9, 3.70078646114522*^9}, 3.7007881784550247`*^9, {
   3.70078834063951*^9, 3.7007883437030907`*^9}, {3.700841855295882*^9, 
   3.700841899468749*^9}, {3.700841964986493*^9, 3.700842041388377*^9}, {
   3.700842077677964*^9, 3.700842094636468*^9}, {3.700842356625996*^9, 
   3.7008423604095793`*^9}, {3.700842453020772*^9, 
   3.700842498483387*^9}},ExpressionUUID->"437eb66f-fbc4-4431-b82f-\
581685754f95"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientButtonActionPopup\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700504108834217*^9, 
  3.7005041346554813`*^9}},ExpressionUUID->"41e67346-e4fe-4aba-a6da-\
e51a8a4a590d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientButtonActionPopup", "]"}], "=", "\n", 
   "\t", 
   RowBox[{"Options", "[", "GradientButtonPopupMenu", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"notRules", "=", 
      RowBox[{"Except", "[", 
       RowBox[{"_FilterRules", "|", "_Rule", "|", "_RuleDelayed", "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}]}], 
       "]"}]}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"GradientButtonActionPopup", "[", "\n", "\t", 
      RowBox[{
       RowBox[{"label_:", "Automatic"}], ",", "\n", "\t", 
       RowBox[{"setList", ":", 
        RowBox[{"_List", "|", 
         RowBox[{"(", 
          RowBox[{"_List", "\[Rule]", "_"}], ")"}]}]}], ",", "\n", "\t", 
       RowBox[{"function", ":", "notRules"}], ",", "\n", "\t", 
       RowBox[{"setfunction", ":", "notRules", ":", "Set"}], ",", "\n", "\t", 
       
       RowBox[{"ops", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
     "\n", "\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{"dynamicVar", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"label", ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
               RowBox[{"v_Symbol", ",", "___"}], "]"}], ":>", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"Hold", "[", "v", "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
               RowBox[{
                RowBox[{"_", "[", 
                 RowBox[{"v_Symbol", ",", "___"}], "]"}], ",", "___"}], "]"}],
               ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"Hold", "[", "v", "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{"_", ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"s", "=", 
                  RowBox[{"Unique", "@", "\"\<FE`popupVar$\>\""}]}], "}"}], 
                ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"s", "=", "\"\<\>\""}], ";", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Hold", "[", "s", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
               "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t", 
        "}"}], ",", "\n", "\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"dynamicVar", ",", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Hold", "[", "dv_", "]"}], ":>", "\n", "\t\t\t", 
          RowBox[{"GradientButtonPopupMenu", "[", "\n", "\t\t\t\t", 
           RowBox[{"Automatic", ",", "\n", "\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{"label", ",", 
              RowBox[{"{", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                  RowBox[{"v_", ",", 
                   RowBox[{"dops", ":", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], 
                    "..."}]}]}], "]"}], ":>", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"v", ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}], ",", "\n", 
                   "\t\t\t\t\t\t\t", "dops"}], "]"}]}], ",", "\n", 
                "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                  RowBox[{"v_", ",", 
                   RowBox[{"f", ":", 
                    RowBox[{"Except", "[", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}], "]"}]}], ",", 
                   "___"}], "]"}], ":>", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"v", ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"f", "[", "#", "]"}], ";"}], "&"}]}], "]"}]}], 
                ",", "\n", "\t\t\t\t\t", 
                RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"dv", ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}]}], "]"}]}], 
                ",", "\n", "\t\t\t\t\t", 
                RowBox[{"f_Function", ":>", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{
                   RowBox[{"f", "[", "dv", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}]}], "]"}]}], 
                ",", "\n", "\t\t\t\t\t", 
                RowBox[{"None", ":>", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"\"\<\>\"", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}]}], "]"}]}], 
                ",", "\n", "\t\t\t\t\t", 
                RowBox[{"_", ":>", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"label", ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}]}], 
                  "]"}]}]}], "\n", "\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", 
            "\t\t\t\t", "setList", ",", "\n", "\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{"label", ",", 
              RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                  RowBox[{"v_", ",", "___"}], "]"}], ":>", "\n", "\t", "\t", 
                 "\t\t\t\t", 
                 RowBox[{"function", "[", "v", "]"}]}], ",", "\n", "\t", "\t",
                 "\t\t\t", 
                RowBox[{"_", ":>", "\n", "\t", "\t\t\t\t\t", 
                 RowBox[{"function", "[", "dv", "]"}]}]}], "\n", "\t", 
               "\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t", "\t\t\t", "ops"}],
            "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], "\n", 
      "\t\t", "]"}]}]}], "\n", "]"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6973908696001577`*^9, 3.6973908832291307`*^9}, {
   3.697390922653412*^9, 3.697390988408297*^9}, {3.697391026230762*^9, 
   3.697391764777125*^9}, {3.697391880513711*^9, 3.69739188867336*^9}, {
   3.6973919202721767`*^9, 3.69739219323368*^9}, {3.697392263139155*^9, 
   3.697392315390504*^9}, {3.697392693001898*^9, 3.697392795446224*^9}, {
   3.69739283564532*^9, 3.697392843420106*^9}, {3.697392897324534*^9, 
   3.697392925930339*^9}, 3.697392971658926*^9, {3.697393137441835*^9, 
   3.6973931560312777`*^9}, {3.697419475499773*^9, 3.697419478670046*^9}, {
   3.697419988855276*^9, 3.697419991415325*^9}, {3.69802375882127*^9, 
   3.698023802669241*^9}, {3.6980243745851297`*^9, 3.6980243856324873`*^9}, {
   3.6980244336289263`*^9, 3.698024436242886*^9}, 3.698024539369495*^9, {
   3.698024630561202*^9, 3.698024633727955*^9}, {3.698024669232151*^9, 
   3.698024670621889*^9}, {3.7005047558072367`*^9, 3.7005048300925627`*^9}, {
   3.700506415749167*^9, 3.700506417210273*^9}, {3.700836629530117*^9, 
   3.700836630521283*^9}, {3.700836763407372*^9, 3.700836764270741*^9}, {
   3.7008368469170427`*^9, 3.700836866603655*^9}, {3.709252390751587*^9, 
   3.709252405607543*^9}},ExpressionUUID->"8db3025f-17e4-4323-bc67-\
cc5c3ea5daf2"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientButtonBar\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7013749710476437`*^9, 
  3.701374973704074*^9}},ExpressionUUID->"a43a62b5-e437-46c5-a609-\
0f6bb6478d36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientButtonBar", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "@", "ButtonBar"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "GradientButton"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientButtonBar", "[", 
    RowBox[{
     RowBox[{"args", ":", 
      RowBox[{"{", 
       RowBox[{"_", ",", "__"}], "}"}]}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Row", "@", "\n", "\t\t", 
    RowBox[{"MapIndexed", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"k", "=", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"val", "=", 
            RowBox[{"Extract", "[", 
             RowBox[{"#", ",", "2", ",", "Hold"}], "]"}]}], ",", 
           RowBox[{"ind", "=", 
            RowBox[{"First", "@", "#2"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"uuid", "=", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<UUID\>\"", "]"}], ",", 
              RowBox[{"Automatic", "|", "_String"}]}], "]"}]}]}], "}"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Function", "[", 
           RowBox[{"Null", ",", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{"uuid", ",", "\n", "\t\t\t\t\t  ", 
              RowBox[{"UUIDButton", "[", "##", "]"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"Button", "[", 
               RowBox[{"#", ",", "#2", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"FilterRules", "[", 
                 RowBox[{
                  RowBox[{"List", "@@", 
                   RowBox[{
                    RowBox[{"Hold", "[", "##", "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ";;"}], "]"}], "]"}]}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Options", "[", "Button", "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}],
              "\n", "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
            "HoldAll"}], "]"}], "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"k", "===", "None"}], ",", "val", ",", "k"}], "]"}], ",",
            "\n", "\t\t\t\t\t", 
           RowBox[{"ReleaseHold", "@", "val"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"Appearance", "\[Rule]", "\n", "\t\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"app", "=", 
                RowBox[{"OptionValue", "[", "Appearance", "]"}]}], "}"}], ",",
               "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
              "GradientButtonAppearance", "@@", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"DeleteCases", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", "app", "}"}], ",", " ", "1"}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePadding", "\[Rule]", "_"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                   "ImagePadding", "\[Rule]", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Switch", "[", 
                    RowBox[{
                    "ind", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", "1", 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "GradientImagePaddingFormat", "[", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "First", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Lookup", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", "app", "}"}], ",", " ", "1"}], "]"}], ",", 
                    "OptionQ"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "ImagePadding", ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "Automatic"}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Length", "@", "args"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "GradientImagePaddingFormat", "[", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Last", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", "app", "}"}], ",", " ", "1"}], "]"}], ",", 
                    "OptionQ"}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "ImagePadding", ",", 
                    "Automatic"}], "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "_", ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "GradientImagePaddingFormat", "[", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{
                    RowBox[{"{", "app", "}"}], ",", " ", "1"}], "]"}], ",", 
                    "OptionQ"}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "ImagePadding", ",", 
                    "Automatic"}], "]"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", "1"}], "\n", "\t\t\t\t\t\t\t\t\t", 
                "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
           "\t\t\t\t\t", 
           RowBox[{"ImageSize", "->", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                  RowBox[{
                   RowBox[{"Scaled", "[", "s_", "]"}], ",", "e___"}], "]"}], ":>",
                  "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"l", "=", 
                    RowBox[{"Length", "@", "args"}]}], "}"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"s", "/", "l"}], "]"}], ",", "e"}], "]"}]}], "\n",
                   "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                  RowBox[{"s_", ",", "e___"}], "]"}], ":>", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"l", "=", 
                    RowBox[{"Length", "@", "args"}]}], "}"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"s", "/", "l"}], ",", "e"}], "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                
                RowBox[{
                 RowBox[{"i_", "?", "NumericQ"}], ":>", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{"i", "/", 
                  RowBox[{"Length", "@", "args"}]}]}], ",", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Scaled", "[", "s_", "]"}], ":>", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{"Scaled", "[", 
                  RowBox[{"s", "/", 
                   RowBox[{"Length", "@", "args"}]}], "]"}]}]}], "\n", 
               "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"Evaluate", "[", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"Except", "[", "Appearance", "]"}]}], "\n", 
              "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
          "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], "&"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"args", ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"lb", ":", 
          RowBox[{"Except", "[", "_RuleDelayed", "]"}]}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"lb", "\[RuleDelayed]", "None"}], ")"}]}], ",", "\n", 
        "\t\t\t\t", "1"}], "]"}]}], "\n", "\t\t\t", "]"}]}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700512122944421*^9, 3.700512268237938*^9}, {
   3.7005123169032707`*^9, 3.700512619839299*^9}, {3.7005126929910917`*^9, 
   3.700512703447763*^9}, {3.700512769064736*^9, 3.7005127849212923`*^9}, {
   3.700512819103607*^9, 3.700512851170483*^9}, {3.700512937051017*^9, 
   3.700513045836028*^9}, {3.700513120990026*^9, 3.700513280853647*^9}, {
   3.700525820668559*^9, 3.7005259303830833`*^9}, {3.7005261110838547`*^9, 
   3.700526203011155*^9}, {3.700526282415947*^9, 3.7005263120224447`*^9}, {
   3.700526459353752*^9, 3.7005265103015957`*^9}, {3.7005267476954536`*^9, 
   3.70052679230914*^9}, {3.700780133203979*^9, 3.700780134754773*^9}, {
   3.700845939822226*^9, 3.7008459414362392`*^9}, {3.701374975898838*^9, 
   3.7013750101522903`*^9}, {3.701375040858726*^9, 3.701375160859192*^9}, {
   3.7019927124591007`*^9, 3.7019930609426823`*^9}, {3.701993098991232*^9, 
   3.701993172867688*^9}, {3.7019932118251343`*^9, 3.701993280835425*^9}, {
   3.701993388558378*^9, 3.7019934206410513`*^9}, {3.701993450828978*^9, 
   3.701993517148587*^9}, {3.701993601197282*^9, 3.7019936324443283`*^9}, {
   3.701993662740088*^9, 3.701993704173225*^9}, {3.7019938216671343`*^9, 
   3.701993835564724*^9}, {3.70216546122864*^9, 3.702165620453418*^9}, {
   3.702165654774122*^9, 3.7021656671049213`*^9}, {3.7026057276969423`*^9, 
   3.7026060398889647`*^9}, {3.7026060834741592`*^9, 3.702606084609248*^9}, {
   3.702606130160078*^9, 3.702606185826933*^9}, {3.702606220906892*^9, 
   3.702606227917294*^9}, {3.702606261629553*^9, 3.702606312083878*^9}, {
   3.70260634374159*^9, 3.702606381898932*^9}, {3.70260648279453*^9, 
   3.702606483939363*^9}, {3.702606518788135*^9, 3.7026065643265133`*^9}, 
   3.702606600630868*^9, {3.702606642363503*^9, 3.702606651806712*^9}, {
   3.709245258464669*^9, 3.709245296142103*^9}, {3.709246063717216*^9, 
   3.709246087995907*^9}, {3.709247168983884*^9, 3.709247168996355*^9}, {
   3.720470779399405*^9, 3.7204708852469263`*^9}, {3.728184333250717*^9, 
   3.728184339312952*^9}, {3.728184597618541*^9, 
   3.72818462765571*^9}},ExpressionUUID->"7deff51d-9bf7-41f9-a1e6-\
654d8c1b4004"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientSetter\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7005121201886873`*^9, 
  3.7005121221403027`*^9}},ExpressionUUID->"4e120229-cfe6-439b-96f5-\
779ad2883aac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientSetter", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "@", "Setter"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "Button"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cont", "=", "$Context"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"GradientSetter", "[", 
      RowBox[{"v_", ",", "val_", ",", 
       RowBox[{"lbl", ":", 
        RowBox[{"Except", "[", 
         RowBox[{"_", "?", "OptionQ"}], "]"}], ":", "None"}], ",", 
       RowBox[{"ops", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{"dvar", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", "var_", "]"}], 
              "\[RuleDelayed]", "\n", "\t", "\t\t\t\t", 
              RowBox[{"HoldPattern", "[", "var", "]"}]}], ",", "\n", 
             "\t\t\t\t", 
             RowBox[{"e_", ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"s", "=", 
                  RowBox[{"Unique", "@", 
                   RowBox[{"(", 
                    RowBox[{"cont", "<>", "\"\<$$setter\>\""}], ")"}]}]}], 
                 "}"}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"s", "=", "v"}], ";", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"HoldPattern", "[", "s", "]"}]}]}], "\n", 
               "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], 
        "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{"setFun", "=", "\n", "\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{"v", ",", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                 RowBox[{"_", ",", "f_"}], "]"}], "\[RuleDelayed]", "\n", 
                "\t", "\t\t\t\t\t", "f"}], ",", "\n", "\t", "\t\t\t\t", 
               RowBox[{"e_", ":>", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Set", "[", 
                   RowBox[{"dvar", ",", "#"}], "]"}], "&"}], ")"}]}]}], "\n", 
              "\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t\t\t", "}"}], ",", 
         "\n", "\t\t\t", 
         RowBox[{"Button", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"lbl", "===", "None"}], ",", "val", ",", "lbl"}], "]"}], 
           ",", "\n", "\t", "\t\t\t", 
           RowBox[{"setFun", "[", "val", "]"}], ",", "\n", "\t", "\t\t\t", 
           RowBox[{"Appearance", "\[Rule]", "\n", "\t", "\t\t\t\t", 
            RowBox[{"Append", "[", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
              "GradientButtonAppearance", "@@", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"Flatten", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"OptionValue", "[", "Appearance", "]"}], "}"}], ",",
                  " ", "1"}], "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ReleaseHold", "[", "dvar", "]"}], "===", "val"}], 
                 ",", "\"\<Pressed\>\"", ",", "Automatic"}], "]"}], "]"}]}], 
             "\n", "\t", "\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t\t\t", 
          "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}]}], "\n", 
   "\t", "]"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700512122944421*^9, 3.700512268237938*^9}, {
  3.7005123169032707`*^9, 3.700512619839299*^9}, {3.7005126929910917`*^9, 
  3.700512703447763*^9}, {3.700512769064736*^9, 3.7005127849212923`*^9}, {
  3.700512819103607*^9, 3.700512851170483*^9}, {3.700512937051017*^9, 
  3.700513022275592*^9}, {3.700526445351852*^9, 3.700526451671948*^9}, {
  3.70052656714023*^9, 3.700526571011269*^9}, {3.7281843429380627`*^9, 
  3.72818434615854*^9}},ExpressionUUID->"57432141-dbfd-4ae2-82ed-12d592cb3bda"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientSetterBar\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.700513034672687*^9, 3.7005130367996273`*^9}, 
   3.700513282788026*^9},ExpressionUUID->"09307709-30b9-4a5c-9f69-\
1091c7c25bd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientSetterBar", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "@", "SetterBar"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "GradientButton"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cont", "=", "$Context"}], "}"}], ",", "\n", 
    RowBox[{
     RowBox[{"GradientSetterBar", "[", 
      RowBox[{"v_", ",", "vals_", ",", 
       RowBox[{"ops", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{"dvar", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"v", ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
               RowBox[{"var_", ",", "___"}], "]"}], "\[RuleDelayed]", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"HoldPattern", "[", "var", "]"}]}], ",", "\n", 
             "\t\t\t\t", 
             RowBox[{"e_", ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"s", "=", 
                  RowBox[{"Unique", "@", 
                   RowBox[{"(", 
                    RowBox[{"cont", "<>", "\"\<$$setter\>\""}], ")"}]}]}], 
                 "}"}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"s", "=", "v"}], ";", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"HoldPattern", "[", "s", "]"}]}]}], "\n", 
               "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], 
        "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t", 
          RowBox[{"setFun", "=", "\n", "\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{"v", ",", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                 RowBox[{"_", ",", "f_"}], "]"}], "\[RuleDelayed]", "\n", 
                "\t", "\t\t\t\t\t", "f"}], ",", "\n", "\t", "\t\t\t\t", 
               RowBox[{"e_", ":>", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Set", "[", 
                   RowBox[{"dvar", ",", "#"}], "]"}], "&"}], ")"}]}]}], "\n", 
              "\t\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t\t\t", "}"}], ",", 
         "\n", "\t\t\t", 
         RowBox[{"Row", "@", "\n", "\t\t\t", 
          RowBox[{"MapIndexed", "[", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"k", "=", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                 RowBox[{"val", "=", 
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                 RowBox[{"ind", "=", 
                  RowBox[{"First", "@", "#2"}]}]}], "}"}], ",", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"Button", "[", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"k", "===", "None"}], ",", "val", ",", "k"}], 
                  "]"}], ",", "\n", "\t", "\t\t\t\t\t", 
                 RowBox[{"setFun", "[", "val", "]"}], ",", "\n", "\t", "\t", 
                 "\t", "\t\t\t", 
                 RowBox[{
                 "Appearance", "\[Rule]", "\n", "\t", "\t", "\t", "\t\t\t\t", 
                  
                  RowBox[{"Append", "[", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    "GradientButtonAppearance", "@@", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Flatten", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Switch", "[", 
                    RowBox[{
                    "ind", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", "1", 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Length", "@", "vals"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t", "_", ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "1"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ReleaseHold", "[", "dvar", "]"}], "===", "val"}],
                     ",", "\"\<Pressed\>\"", ",", "Automatic"}], "]"}], "]"}]}
                    ], "\n", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"ImageSize", "->", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{
                    RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                    RowBox[{
                    RowBox[{"Scaled", "[", "s_", "]"}], ",", "e___"}], "]"}], 
                    ":>", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l", "=", 
                    RowBox[{"Length", "@", "vals"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"Scaled", "[", 
                    RowBox[{"s", "/", "l"}], "]"}], ",", "e"}], "]"}]}], "\n",
                     "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                    RowBox[{"s_", ",", "e___"}], "]"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l", "=", 
                    RowBox[{"Length", "@", "vals"}]}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"s", "/", "l"}], ",", "e"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"i_", "?", "NumericQ"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"i", "/", 
                    RowBox[{"Length", "@", "vals"}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Scaled", "[", "s_", "]"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"s", "/", 
                    RowBox[{"Length", "@", "vals"}]}], "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"FilterRules", "[", 
                  RowBox[{
                   RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"Except", "[", "Appearance", "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
              "\n", "\t\t\t\t\t", "]"}], "&"}], ",", "\n", "\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{"vals", ",", 
              RowBox[{
               RowBox[{"lb", ":", 
                RowBox[{"Except", "[", "_Rule", "]"}]}], "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"None", "\[Rule]", "lb"}], ")"}]}], ",", "1"}], 
             "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], 
      "\n", "\t\t", "]"}]}]}], "\n", "\t", "]"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700512122944421*^9, 3.700512268237938*^9}, {
  3.7005123169032707`*^9, 3.700512619839299*^9}, {3.7005126929910917`*^9, 
  3.700512703447763*^9}, {3.700512769064736*^9, 3.7005127849212923`*^9}, {
  3.700512819103607*^9, 3.700512851170483*^9}, {3.700512937051017*^9, 
  3.700513045836028*^9}, {3.700513120990026*^9, 3.700513280853647*^9}, {
  3.700525820668559*^9, 3.7005259303830833`*^9}, {3.7005261110838547`*^9, 
  3.700526203011155*^9}, {3.700526282415947*^9, 3.7005263120224447`*^9}, {
  3.700526459353752*^9, 3.7005265103015957`*^9}, {3.7005267476954536`*^9, 
  3.70052679230914*^9}, {3.700780133203979*^9, 3.700780134754773*^9}, {
  3.700845939822226*^9, 3.7008459414362392`*^9}, {3.7204721203223257`*^9, 
  3.7204721253827667`*^9}, {3.728184349363059*^9, 
  3.728184356224491*^9}},ExpressionUUID->"c033ac4c-93e3-4b55-82ff-\
ff9c1fa34674"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientDock\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.702488352607175*^9, 
  3.702488369002225*^9}},ExpressionUUID->"30228896-288b-444d-b662-\
3bf804df46c3"],

Cell[BoxData[
 RowBox[{"GradientDockElement", "//", "ClearAll"}]], "CodeInput",
 CellChangeTimes->{{3.7092525485637617`*^9, 
  3.7092525497962418`*^9}},ExpressionUUID->"5d39948c-5cdf-4d93-a9a6-\
66380c5473a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab_", "\[RuleDelayed]", "cmd_"}], ")"}], "->", 
     RowBox[{"ops_", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientButton", "[", 
    RowBox[{"lab", ",", "cmd", ",", "ops"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{"lab_", "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{"cmd_", "->", 
       RowBox[{"ops_", "?", "OptionQ"}]}], ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab", "\[RuleDelayed]", "cmd"}], ")"}], "\[Rule]", "ops"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"actions", ":", 
      RowBox[{"{", "__RuleDelayed", "}"}]}], "->", 
     RowBox[{"ops_", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientButtonBar", "[", 
    RowBox[{"actions", ",", "ops"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{"lab_", "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{"cmd_", "->", 
       RowBox[{"ops_", "?", "OptionQ"}]}], ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab", "\[RuleDelayed]", "cmd"}], ")"}], "\[Rule]", "ops"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab_", "->", 
       RowBox[{"actions", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_RuleDelayed", "|", "Delimiter"}], ")"}], ".."}], 
         "}"}]}]}], ")"}], "->", 
     RowBox[{"ops_", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"lab", "===", "None"}], ",", "\n", "\t\t", 
     RowBox[{"GradientActionDropDown", "[", 
      RowBox[{"actions", ",", "ops"}], "]"}], ",", "\n", "\t\t", 
     RowBox[{"GradientActionMenu", "[", 
      RowBox[{"lab", ",", "actions", ",", "ops"}], "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{"lab_", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"actions", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_RuleDelayed", "|", "Delimiter"}], ")"}], ".."}], "}"}]}],
        "->", 
       RowBox[{"ops_", "?", "OptionQ"}]}], ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab", "\[Rule]", "actions"}], ")"}], "\[Rule]", "ops"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab_", "\[Rule]", "vals_List"}], ")"}], "->", 
     RowBox[{"ops_", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"lab", "===", "None"}], ",", "\n", "\t\t", 
     RowBox[{"GradientPopupDropDown", "[", 
      RowBox[{"vals", ",", "ops"}], "]"}], ",", "\n", "\t\t", 
     RowBox[{"GradientPopupMenu", "[", 
      RowBox[{"lab", ",", "vals", ",", "ops"}], "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{"lab_", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"vals_List", "->", 
       RowBox[{"ops_", "?", "OptionQ"}]}], ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab", "\[Rule]", "vals"}], ")"}], "\[Rule]", "ops"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab_", "->", 
       RowBox[{
        RowBox[{"actions", ":", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"_RuleDelayed", "|", "Delimiter"}], ")"}], ".."}], 
          "}"}]}], "\[Rule]", "f_"}]}], ")"}], "->", 
     RowBox[{"ops_", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   
   RowBox[{"GradientButtonActionMenu", "[", 
    RowBox[{"lab", ",", "actions", ",", "f", ",", "ops"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{"lab_", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"actions", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_RuleDelayed", "|", "Delimiter"}], ")"}], ".."}], "}"}]}],
        "\[Rule]", 
       RowBox[{"f_", "->", 
        RowBox[{"ops_", "?", "OptionQ"}]}]}], ")"}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab", "\[Rule]", 
       RowBox[{"actions", "\[Rule]", "f"}]}], ")"}], "\[Rule]", "ops"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab_", "\[Rule]", 
       RowBox[{"vals_List", "\[Rule]", "f_"}]}], ")"}], "->", 
     RowBox[{"ops_", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientButtonPopupMenu", "[", 
    RowBox[{"lab", ",", "vals", ",", "f", ",", "ops"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{"lab_", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"vals_List", "\[Rule]", 
       RowBox[{"f_", "->", 
        RowBox[{"ops_", "?", "OptionQ"}]}]}], ")"}]}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"GradientDockElement", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lab", "\[Rule]", 
       RowBox[{"vals", "\[Rule]", "f"}]}], ")"}], "\[Rule]", "ops"}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{"lab_String", "->", 
     RowBox[{"ops_", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientButton", "[", 
    RowBox[{"lab", ",", "Null", ",", "\n", "\t\t", 
     RowBox[{"Enabled", "\[Rule]", "False"}], ",", "\n", "\t\t", "ops"}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GradientDockElement", "[", 
    RowBox[{"e_", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"ops_", "?", "OptionQ"}], ")"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GradientButton", "[", 
    RowBox[{"e", ",", "Null", ",", "\n", "\t\t", 
     RowBox[{"Evaluate", "@", "\n", "\t\t\t", 
      RowBox[{"Flatten", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{"ops", ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Enabled", "\[Rule]", "False"}]}], "\n", "\t\t\t\t\t", 
         "}"}], ",", "\n", "\t\t\t\t", "1"}], "\n", "\t\t\t\t", "]"}]}]}], 
    "\n", "\t\t", "]"}]}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"\n", 
       RowBox[{
        RowBox[{"GradientDockElement", "[", 
         RowBox[{
          RowBox[{"(", "assoc_Association", ")"}], "->", 
          RowBox[{"ops_", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
        RowBox[{"With", "[", 
         RowBox[{"{", "\n", "\t\t", 
          RowBox[{
           RowBox[{"ctype", "=", 
            RowBox[{"Lookup", "[", 
             RowBox[{"assoc", ",", "ControlType", ",", "Automatic"}], "]"}]}],
            ",", "\n", "\t\t", 
           RowBox[{"label", "=", 
            RowBox[{"Lookup", "[", 
             RowBox[{"assoc", ",", "Label", ",", "None"}], "]"}]}], ",", "\n",
            "\t\t", 
           RowBox[{"args", "=", 
            RowBox[{"Lookup", "[", 
             RowBox[{"assoc", ",", "\n", "\t\t", 
              RowBox[{"f", "=", 
               RowBox[{"Lookup", "[", 
                RowBox[{"assoc", ",", "Function", ",", "None"}], "]"}]}]}], 
             "\n", "\t\t"}]}]}]}]}]}], "}"}], ","}], "\n", "\t\t", "]"}], 
    ";"}], "\n", "\t", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GradientDockElement", "[", 
     RowBox[{
      RowBox[{"spec", ":", 
       RowBox[{"_Rule", "|", "_RuleDelayed"}]}], ",", "ops__"}], "]"}], ":=", 
    "\n", "\t", 
    RowBox[{"If", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"spec", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", "\n", "\t\t\t\t", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], "|", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], "..."}], 
            "}"}]}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ",", 
      "\n", "\t\t", 
      RowBox[{"GradientDockElement", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"First", "[", "spec", "]"}], "\[Rule]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Last", "@", "spec"}], ",", "ops"}], "}"}], ",", " ", 
          "1"}], "]"}]}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
      RowBox[{"GradientDockElement", "[", 
       RowBox[{"spec", "\[Rule]", 
        RowBox[{"{", "ops", "}"}]}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}], 
  "\t"}], "\n", 
 RowBox[{
  RowBox[{"GradientDockElement", "[", 
   RowBox[{"e_", ",", "ops__"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"GradientDockElement", "[", 
   RowBox[{"e", "\[Rule]", 
    RowBox[{"{", "ops", "}"}]}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.702488927700675*^9, 3.702488956412553*^9}, {
   3.702489029410605*^9, 3.702489040783764*^9}, {3.70248911673237*^9, 
   3.7024892233979797`*^9}, {3.7024892549569607`*^9, 3.702489291363653*^9}, 
   3.702489337323654*^9, {3.702489429938246*^9, 3.70248960196362*^9}, {
   3.702489691018568*^9, 3.7024897513040257`*^9}, {3.702489798413905*^9, 
   3.70249003328802*^9}, {3.7024900897671223`*^9, 3.702490177746957*^9}, {
   3.702490228145171*^9, 3.702490233072929*^9}, {3.70249031166678*^9, 
   3.702490363458459*^9}, {3.702490450055291*^9, 3.702490608632854*^9}, 
   3.70249092128507*^9, {3.7025927962740602`*^9, 3.702592860335347*^9}, {
   3.7025952889062033`*^9, 3.7025953105370293`*^9}, {3.709242013316625*^9, 
   3.709242015681899*^9}, {3.7092421552737703`*^9, 3.709242163448576*^9}, {
   3.709242236896929*^9, 3.709242338775734*^9}, {3.7092469308580647`*^9, 
   3.7092470458303833`*^9}, {3.709248116360004*^9, 3.709248145659163*^9}, {
   3.709249230781623*^9, 3.709249272031502*^9}, {3.709250169653059*^9, 
   3.709250183872242*^9}, {3.709252493344558*^9, 3.709252535955099*^9}, {
   3.7281843599218493`*^9, 
   3.728184369638461*^9}},ExpressionUUID->"dfd78355-515d-4273-8d8a-\
2672465d4947"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientDock", "]"}], "=", "\n", "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
    RowBox[{"Join", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Options", "@", "GradientButton"}], ",", "\n", "\t\t\t", 
      RowBox[{"Options", "@", "GradientActionMenu"}], ",", "\n", "\t\t\t", 
      RowBox[{"Options", "@", "GradientButtonActionPopup"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"Options", "@", "GradientButtonBar"}], ",", "\n", "\t\t\t", 
      RowBox[{"Options", "@", "GradientSetter"}], ",", "\n", "\t\t\t", 
      RowBox[{"Options", "@", "GradientSetterBar"}]}], "\n", "\t\t\t", 
     "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"GradientDock", "[", 
   RowBox[{
    RowBox[{"dockThings", ":", 
     RowBox[{"{", "__", "}"}]}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Grid", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"List", "@", 
     RowBox[{"Flatten", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"GradientDockElement", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"First", "@", "dockThings"}], ",", "\n", "\t", "\t", 
           "\t\t\t", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Appearance", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"Flatten", "@", 
                RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Lookup", "[", 
                   RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "ops", "}"}]}], ",", "Appearance", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t", "\"\<Palette\>\"", ",", "\n", "\t", "\t", 
                  "\t", "\t\t\t\t\t", 
                  RowBox[{
                  "ImagePadding", "->", "\n", "\t", "\t", "\t", 
                   "\t\t\t\t\t\t", 
                   RowBox[{"Switch", "[", 
                    RowBox[{
                    RowBox[{"First", "@", "dockThings"}], ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"_", "[", 
                    RowBox[{"_", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_RuleDelayed", "|", "Delimiter"}], ")"}], 
                    "..."}], "}"}]}], "]"}], "|", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], "..."}]}], 
                    ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"Center", ",", "1", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t", "_", ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", 
                 "\t\t\t\t\t\t\t", "}"}]}]}], ",", "\n", "\t", "\t\t\t\t\t", 
              "ops", ",", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"ImageSize", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"Automatic", ",", "40"}], "}"}]}]}], "\n", "\t", 
             "\t\t\t\t\t", "}"}]}]}], "]"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"GradientDockElement", "[", 
            RowBox[{"#", ",", "\n", "\t", "\t", "\t\t\t", 
             RowBox[{"Flatten", "@", 
              RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Appearance", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "ops", "}"}]}], ",", "Appearance", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t", "\"\<Palette\>\"", ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t", 
                    RowBox[{
                    "ImagePadding", "->", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], "\n", "\t", 
                   "\t", "\t\t\t\t\t\t", "}"}]}]}], ",", "\n", "\t", 
                "\t\t\t\t\t", "ops", ",", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", "40"}], "}"}]}]}], "\n", "\t", 
               "\t\t\t\t\t", "}"}]}]}], "]"}], "&"}], "/@", 
          RowBox[{"Rest", "@", "dockThings"}]}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"GradientButton", "[", 
          RowBox[{
          "\"\<\>\"", ",", "\n", "\t", "\t\t\t\t", "Null", ",", "\n", "\t", 
           "\t\t\t\t", 
           RowBox[{"Evaluate", "@", "\n", "\t", "\t", "\t\t\t\t", 
            RowBox[{"Replace", "[", "\n", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Flatten", "@", 
               RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Enabled", "\[Rule]", "False"}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{
                 "Appearance", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "ops", "}"}]}], ",", "Appearance", ",", 
                    RowBox[{"{", "}"}]}], "]"}], ",", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", "\"\<Palette\>\"", ",", "\n", "\t", 
                    "\t", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t", "}"}]}]}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t\t", "ops", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"ImageSize", "\[Rule]", "40"}]}], "\n", "\t", 
                "\t\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ImageSize", "\[Rule]", "s_"}], ")"}], ":>", "\n", 
                "\t", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{"(", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                 "ImageSize", "->", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    "{", "\n", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_", ",", "i_"}], "}"}], ":>", "\n", "\t", "\t", 
                    "\t", "\t", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Scaled", "[", "1", "]"}], ",", "i"}], "}"}]}], 
                    ",", "\n", "\t", "\t", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{"i_", "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Scaled", "[", "1", "]"}], ",", "i"}], "}"}]}]}], 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", "}"}]}], 
                   "]"}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", ")"}]}], 
               "\n", "\t", "\t", "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t",
               "\t\t\t\t\t", "1"}], "\n", "\t", "\t\t\t\t\t\t", "]"}]}]}], 
          "\n", "\t", "\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "}"}], ",", "\n",
        "\t\t\t", "1"}], "\n", "\t\t\t", "]"}]}], ",", "\n", "\t\t", 
    RowBox[{"Spacings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}], ",", "\n", "\t\t", 
    RowBox[{"Alignment", "\[Rule]", "Bottom"}], ",", "\n", "\t\t", 
    RowBox[{"ItemSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], "\[Rule]", "Full"}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}]}]}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.702488537001568*^9, 3.702488584156267*^9}, {
   3.7024887210868387`*^9, 3.70248876242031*^9}, 3.702488907326241*^9, {
   3.702489449177719*^9, 3.7024894580556726`*^9}, {3.7024901923539124`*^9, 
   3.702490196708103*^9}, {3.702490380482329*^9, 3.7024904255195303`*^9}, {
   3.702490628098545*^9, 3.702490784693738*^9}, {3.702490830178705*^9, 
   3.702490857768118*^9}, {3.702592759592442*^9, 3.702592765025937*^9}, {
   3.702594706575264*^9, 3.702594747206366*^9}, {3.7025953405491962`*^9, 
   3.702595503525599*^9}, {3.702595591708091*^9, 3.7025956117933197`*^9}, {
   3.7092425857625504`*^9, 3.709242644895411*^9}, {3.7092446318563337`*^9, 
   3.709244642354124*^9}, {3.7092446948491087`*^9, 3.709244707483067*^9}, {
   3.709246507634062*^9, 3.70924657188101*^9}, {3.70924661520955*^9, 
   3.70924682132165*^9}, {3.7092478346859837`*^9, 3.7092479972347927`*^9}, {
   3.7092480333363857`*^9, 3.7092480898411503`*^9}, {3.709248179177505*^9, 
   3.7092482267941027`*^9}, {3.709248368749381*^9, 3.7092484247452602`*^9}, {
   3.709248461774315*^9, 3.709248500163536*^9}, {3.7092492819449167`*^9, 
   3.7092492873872423`*^9}, {3.709510364514988*^9, 3.709510490933173*^9}, {
   3.728184371946151*^9, 
   3.728184385934868*^9}},ExpressionUUID->"20aa803b-6895-469d-a520-\
17e894dddc66"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GradientDockedCell\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7092485587843*^9, 
  3.709248561262999*^9}},ExpressionUUID->"d9a8ee0b-07bd-4efe-9615-\
2a0255c63201"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GradientDockedCell", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "[", "GradientDock", "]"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "Cell", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"GradientDockedCell", "[", 
   RowBox[{
    RowBox[{"dockThings", ":", 
     RowBox[{"{", "__", "}"}]}], ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Cell", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"BoxData", "@", 
     RowBox[{"ToBoxes", "@", "\n", "\t\t\t", 
      RowBox[{"GradientDock", "[", 
       RowBox[{"dockThings", ",", "\n", "\t\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Options", "[", "GradientDock", "]"}]}], "\n", "\t\t\t\t\t",
          "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t", 
    RowBox[{"FilterRules", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"ops", ",", "\n", "\t\t\t", 
        RowBox[{"CellMargins", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ",", "\n", "\t\t\t", 
        RowBox[{"Background", "\[Rule]", 
         RowBox[{"GrayLevel", "[", ".95", "]"}]}], ",", "\n", "\t", "\t", 
        "\t", 
        RowBox[{"CellFrame", "\[Rule]", "None"}], ",", "\n", "\t", "\t", "\t", 
        RowBox[{"CellFrameMargins", "\[Rule]", "0"}]}], "\n", "\t\t\t", "}"}],
       ",", "\n", "\t\t\t", 
      RowBox[{"Options", "[", "Cell", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", 
   "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.709248564184966*^9, 
  3.709248660644685*^9}},ExpressionUUID->"6c74536b-f35c-4534-ab63-\
8aba4c2d8eb4"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Button stuff", "CodeSubsection",
 CellChangeTimes->{{3.6980189480433273`*^9, 
  3.698018949569618*^9}},ExpressionUUID->"ca8a8111-990c-4819-b91d-\
8adae7ae51b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"notRules", "=", "\n", "\t", 
   RowBox[{"Except", "[", 
    RowBox[{"_Rule", "|", "_RuleDelayed", "|", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}], "|", 
     "_FilterRules"}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.698018951195794*^9, 
  3.698018954731399*^9}},ExpressionUUID->"709e995d-f9fb-4e31-bb71-\
a7efedf63d75"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Framed*\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697549403446303*^9, 
  3.697549431380167*^9}},ExpressionUUID->"dec6f80d-6056-43e6-bab9-\
65a704f06975"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FramedButton\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6947319123202333`*^9, 3.694731914366878*^9}, 
   3.6973271845741177`*^9},ExpressionUUID->"e952076f-ae04-43ce-8766-\
4d9ddfeed70a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "FramedButton"}], "=", "\n", "\t", 
   RowBox[{"Normal", "@", 
    RowBox[{"Merge", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], ",", "\n", 
        "\t\t", 
        RowBox[{"Options", "@", "Button"}], ",", "\n", "\t\t", 
        RowBox[{"Options", "@", "Framed"}], ",", "\n", "\t\t", 
        RowBox[{"Options", "@", "Style"}], ",", "\n", "\t\t", 
        RowBox[{"\"\<HoverStyle\>\"", "\[Rule]", "None"}]}], "\n", "\t\t", 
       "}"}], ",", "\n", "\t\t", "First"}], "\n", "\t\t", "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FramedButton", "[", 
    RowBox[{"disp_", ",", 
     RowBox[{"expr_:", "Null"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"flops", "=", "\n", "\t\t\t", 
        RowBox[{"DeleteCases", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Normal", "@", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ops", ",", 
               RowBox[{"Options", "@", "FramedButton"}]}], "}"}], ",", 
             "First"}], "]"}]}], ",", "\n", "\t", "\t\t\t", 
          RowBox[{"Alternatives", "@@", "\n", "\t", "\t\t\t\t", 
           RowBox[{"Normal", "@", 
            RowBox[{"Merge", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Options", "@", "Button"}], ",", 
                RowBox[{"Options", "@", "Framed"}], ",", 
                RowBox[{"Options", "@", "Style"}]}], "}"}], ",", "First"}], 
             "]"}]}]}]}], "\n", "\t", "\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"slops", "=", "\n", "\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", 
          RowBox[{"Options", "@", "Style"}]}], "]"}]}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Button", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "\"\<HoverStyle\>\""}], ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"None", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"Framed", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"disp", ",", "slops"}], "]"}], ",", 
              RowBox[{"FilterRules", "[", 
               RowBox[{"flops", ",", 
                RowBox[{"Options", "@", "Framed"}]}], "]"}]}], "]"}]}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{"s_", ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"Mouseover", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Framed", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"disp", ",", "slops"}], "]"}], ",", 
                RowBox[{"FilterRules", "[", 
                 RowBox[{"flops", ",", 
                  RowBox[{"Options", "@", "Framed"}]}], "]"}]}], "]"}], ",", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{"Framed", "[", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{"disp", ",", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "slops"}], "}"}]}], ",", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}]}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Options", "@", "Style"}]}], "]"}]}], "]"}], ",", 
                "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "flops"}], "}"}]}], ",", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}]}], "]"}], ",", 
                  "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Options", "@", "Framed"}]}], "]"}]}], "]"}]}], 
             "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], 
        "]"}], ",", "\n", "\t\t\t", "expr", ",", "\n", "\t\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{"flops", ",", 
         RowBox[{"Options", "@", "Button"}]}], "]"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FramedButton", "~", "SetAttributes", "~", "HoldRest"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.694731958216695*^9, 3.694732194864362*^9}, {
  3.694732280452876*^9, 3.694732328574729*^9}, {3.694732425022591*^9, 
  3.694732482364388*^9}, {3.694732535387631*^9, 3.694732598314658*^9}, {
  3.694732675935351*^9, 3.694732699417753*^9}, {3.697328490952106*^9, 
  3.697328561098921*^9}, {3.697328615144487*^9, 3.697328636009903*^9}, {
  3.6973286762711477`*^9, 
  3.697328773672325*^9}},ExpressionUUID->"a6f52708-76f7-4107-8332-\
9d1382258800"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FramedPopupMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.689776378753916*^9, 3.689776412402548*^9}, {
  3.729096819681045*^9, 
  3.729096822657037*^9}},ExpressionUUID->"e0e53b60-5a2c-4933-95ae-\
cf3f7e2f02d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "FramedPopupMenu"}], "=", "\n", "\t", 
   RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Join", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"Alignment", "\[Rule]", "Right"}], "\n", "\t\t\t", "}"}], ",",
        "\n", "\t\t\t", 
       RowBox[{"Options", "@", "PopupMenu"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"Options", "@", "Framed"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "Style"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "Pane"}]}], "\n", "\t\t\t", "]"}], ",", "\n", 
     "\t\t", "First"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FramedPopupMenu", "[", "\n", "\t", 
    RowBox[{"var_", ",", "\n", "\t", "settings_List", ",", "\n", "\t", 
     RowBox[{"expr", ":", 
      RowBox[{"Except", "[", 
       RowBox[{"_Rule", "|", "_RuleDelayed"}], "]"}], ":", "Automatic"}], ",",
      "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Framed", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Pane", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"PopupMenu", "[", "\n", "\t\t\t\t", 
        RowBox[{
        "var", ",", "\n", "\t", "\t", "\t\t", "settings", ",", "\n", "\t", 
         "\t", "\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"var", ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
             RowBox[{"e_", ",", "___"}], "]"}], "\[RuleDelayed]", "e"}]}], 
          "\n", "\t", "\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"Style", "[", "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{"expr", ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"Automatic", ":>", "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"Row", "@", 
               RowBox[{"{", 
                RowBox[{"var", ",", 
                 RowBox[{"Spacer", "@", "10"}], ",", 
                 "\"\<\[DownPointer]\>\""}], "}"}]}]}]}], "\n", "\t", 
            "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"Except", "@", 
              RowBox[{"(", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"Alternatives", "@@", 
                RowBox[{"(", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"Join", "[", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Options", "@", "PopupMenu"}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Options", "@", "Framed"}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Options", "@", "Pane"}]}], "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", "]"}], ")"}]}], "\n", "\t", 
               "\t\t\t\t\t\t", ")"}]}]}], "]"}]}], "\n", "\t", "\t\t\t\t", 
          "]"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"Options", "@", "PopupMenu"}]}], "]"}]}], "\n", "\t\t\t\t",
         "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Options", "@", "Pane"}]}], "]"}]}], "\n", "\t\t\t", "]"}], 
     ",", "\n", "\t\t", 
     RowBox[{"FilterRules", "[", 
      RowBox[{
       RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "Framed"}]}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6897764178627157`*^9, 3.6897764387785873`*^9}, {
  3.689779107516883*^9, 3.6897791163314734`*^9}, {3.68977933837574*^9, 
  3.689779346169381*^9}, {3.689779451316125*^9, 
  3.689779591716793*^9}},ExpressionUUID->"2955b5ff-d84e-4a02-aab7-\
72dd3cb000b0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FramedActionMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.69686547877353*^9, 
  3.696865481763474*^9}},ExpressionUUID->"1c4ba6bd-3f6f-4f6e-a05a-\
71e500eaa232"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "@", "FramedActionMenu"}], "=", "\n", "\t", 
   RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Join", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Alignment", "\[Rule]", "Right"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"RoundingRadius", "\[Rule]", "5"}]}], "\n", "\t\t\t", "}"}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "ActionMenu"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "Framed"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "Style"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "Pane"}]}], "\n", "\t\t\t", "]"}], ",", "\n", 
     "\t\t", "First"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FramedActionMenu", "[", "\n", "\t", 
    RowBox[{"name_", ",", "\n", "\t", "settings_List", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Framed", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Pane", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"ActionMenu", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"name", ",", "\n", "\t\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "ops", "}"}], ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"Except", "@", 
              RowBox[{"(", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"Alternatives", "@@", 
                RowBox[{"(", "\n", "\t", "\t\t\t\t\t\t\t", 
                 RowBox[{"Join", "[", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Options", "@", "PopupMenu"}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Options", "@", "Framed"}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Options", "@", "Pane"}]}], "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", "]"}], ")"}]}], "\n", "\t\t\t\t\t\t\t", 
               ")"}]}]}], "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
         "\t\t\t\t", "settings", ",", "\n", "\t\t\t\t", 
         RowBox[{"Appearance", "\[Rule]", "None"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"Options", "@", "ActionMenu"}]}], "]"}]}], "\n", 
        "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Options", "@", "Pane"}]}], "]"}]}], "\n", "\t\t\t", "]"}], 
     ",", "\n", "\t\t", 
     RowBox[{"FilterRules", "[", 
      RowBox[{
       RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"Options", "@", "Framed"}]}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6897764178627157`*^9, 3.6897764387785873`*^9}, {
  3.689779107516883*^9, 3.6897791163314734`*^9}, {3.68977933837574*^9, 
  3.689779346169381*^9}, {3.689779451316125*^9, 3.689779591716793*^9}, {
  3.696865510470139*^9, 
  3.696865630690668*^9}},ExpressionUUID->"c457b91c-508c-4cc5-aaa6-\
068b114ed168"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Colored*\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697549426623213*^9, 
  3.69754942872541*^9}},ExpressionUUID->"884ead34-cc8a-42aa-9864-\
b127f3ad30f0"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ColoredButton\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697330725342162*^9, 3.6973307272766314`*^9}, {
  3.698018966586504*^9, 
  3.698018968728767*^9}},ExpressionUUID->"b573d9a7-6593-4d6e-9eb1-\
49bf009bdd08"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"ColoredButtonAppearances", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"a", ":", 
       RowBox[{"_String", "|", 
        RowBox[{"_", "?", "ImageQ"}], "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Default\>\"", "\[Rule]", "_"}], ",", 
          RowBox[{"\"\<Hover\>\"", "\[Rule]", "_"}], ",", 
          RowBox[{"\"\<Pressed\>\"", "\[Rule]", "_"}]}], "}"}]}]}], ",", "\n",
       "\t", 
      RowBox[{"color_", "?", "ColorQ"}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"ColorizationAdjust", "[", "\n", "\t\t", 
     RowBox[{"color", ",", "\n", "\t\t", 
      RowBox[{"ColorizedAppearances", "[", 
       RowBox[{"a", ",", "color"}], "]"}]}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredButtonAppearances", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"Optional", "[", 
       RowBox[{"Automatic", ",", "Automatic"}], "]"}], ",", "\n", "\t", 
      RowBox[{"color_", "?", "ColorQ"}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"ColorizationAdjust", "[", "\n", "\t\t", 
     RowBox[{"color", ",", "\n", "\t\t", 
      RowBox[{"ColorizedAppearances", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"FrontEndResource", "[", 
         RowBox[{
         "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", "\t", "\t\t\t", 
          "\"\<ButtonDefaultAppearance\>\""}], "]"}], ",", "\n", "\t\t\t", 
        "color"}], "]"}]}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredButtonAppearances", "[", "Automatic", "]"}], ":=", "\n", 
    "\t", 
    RowBox[{"FrontEndResource", "[", 
     RowBox[{
     "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", "\t\t", 
      "\"\<ButtonDefaultAppearance\>\""}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredButtonAppearances", "[", 
     RowBox[{"spec_", ",", 
      RowBox[{"i", ":", 
       RowBox[{"_Integer", "|", "_String"}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"ColorizedAppearances", "[", 
     RowBox[{"spec", ",", "i"}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredButtonAppearances", "[", "s_String", "]"}], ":=", "\n", 
    "\t", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"FEResourceFind", "[", "s", "]"}], ",", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "\[Rule]", "g_"}], ",", "___"}], "}"}], ":>", "\n", 
         "\t\t\t", "g"}], ",", "\n", "\t\t", 
        RowBox[{"_", ":>", "\n", "\t\t\t", 
         RowBox[{"ColoredButtonAppearances", "[", "Automatic", "]"}]}]}], 
       "\n", "\t\t", "}"}]}], "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.697333498647173*^9, 3.697333550733737*^9}, {
   3.697386397207013*^9, 3.6973863977650414`*^9}, {3.6973864295533743`*^9, 
   3.6973864636693077`*^9}, {3.697386554518765*^9, 3.697386721963154*^9}, {
   3.69738675564987*^9, 3.697386976487488*^9}, {3.697387233749072*^9, 
   3.697387276521343*^9}, {3.697387353592947*^9, 3.697387387120512*^9}, {
   3.697388248215178*^9, 3.697388259735046*^9}, 3.6974161600826797`*^9, {
   3.6974166631309423`*^9, 3.697416691418055*^9}, {3.6974170104524717`*^9, 
   3.697417025136498*^9}, {3.697417072170186*^9, 3.697417119816332*^9}, {
   3.6974178822039022`*^9, 3.6974178939059067`*^9}, {3.697418091394004*^9, 
   3.697418111655695*^9}, {3.697418645001189*^9, 3.6974186667371597`*^9}, {
   3.697418721698297*^9, 3.6974187600476437`*^9}, 3.697549648668716*^9, 
   3.697549719504321*^9, {3.697585458173554*^9, 3.69758587675021*^9}, {
   3.697585908262918*^9, 3.697586019470647*^9}, {3.6975860554035892`*^9, 
   3.697586066080257*^9}, {3.6975861177669067`*^9, 3.697586164762555*^9}, {
   3.697586198204906*^9, 3.697586203833707*^9}, {3.697586257984544*^9, 
   3.6975863710910387`*^9}, {3.697586525940895*^9, 3.697586540591154*^9}, 
   3.697586600393351*^9, {3.69758664022759*^9, 3.697586738949654*^9}, {
   3.6975869346716747`*^9, 3.69758698478938*^9}, {3.697587105839665*^9, 
   3.697587117774922*^9}, {3.6975871492939167`*^9, 3.697587271991077*^9}, {
   3.69758730362304*^9, 3.697587350582869*^9}, 3.697587386099328*^9, {
   3.697587544104773*^9, 3.697587553181397*^9}, {3.697587622523192*^9, 
   3.697587687198691*^9}, {3.697588449247196*^9, 3.6975884680374804`*^9}, 
   3.697588538530994*^9, 3.697588576930656*^9, 3.697679674639882*^9, {
   3.697679712132043*^9, 3.6976797132117043`*^9}, {3.697679912133377*^9, 
   3.69767991880653*^9}, {3.697679998066278*^9, 3.697680035944408*^9}, {
   3.697680085207896*^9, 3.697680219752018*^9}, {3.697680258753282*^9, 
   3.697680274414764*^9}, 3.697680388174659*^9, {3.697680445610919*^9, 
   3.69768048574067*^9}, {3.697680557792281*^9, 3.697680604967332*^9}, {
   3.697680691910516*^9, 3.697680750375547*^9}, {3.697680892001544*^9, 
   3.697680901159562*^9}, {3.697680955552361*^9, 3.697681002820657*^9}, {
   3.697681057065823*^9, 3.697681061490397*^9}, {3.6976811392477207`*^9, 
   3.6976811700932302`*^9}, {3.6976815730248003`*^9, 
   3.6976816315874968`*^9}, {3.697681800678076*^9, 3.6976818079086657`*^9}, {
   3.697681850948236*^9, 3.69768185197928*^9}, {3.697682045849709*^9, 
   3.697682051934862*^9}, {3.697682172666575*^9, 3.6976821780673532`*^9}, {
   3.698019496929749*^9, 3.698019538274078*^9}, {3.7002335210807123`*^9, 
   3.700233625418107*^9}, {3.700235371627941*^9, 
   3.7002353739091177`*^9}},ExpressionUUID->"9baf9376-843f-4303-9029-\
31ff92beb951"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ColoredButton", "]"}], "=", "\n", "\t", 
    RowBox[{"Options", "@", "Button"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredButton", "[", 
     RowBox[{"label_", ",", "\n", "\t", 
      RowBox[{"expr", ":", "notRules", ":", "Null"}], ",", "\n", "\t", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Button", "[", 
     RowBox[{"label", ",", "\n", "\t\t", "expr", ",", "\n", "\t\t", 
      RowBox[{"Appearance", "\[Rule]", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "@", "Appearance"}], ",", 
             RowBox[{"{", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"c", ":", 
                 RowBox[{
                  RowBox[{"_", "?", "ColorQ"}], "|", "_String", "|", 
                  "Automatic"}]}], ":>", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"ColoredButtonAppearances", "[", "c", "]"}]}], ",", 
               "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"s_String", ",", "c_"}], "}"}], ":>", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"ColoredButtonAppearances", "[", 
                 RowBox[{"s", ",", "c"}], "]"}]}], ",", "\n", "\t\t\t\t\t\t", 
               
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"l", ":", 
                   RowBox[{"_List", "|", 
                    RowBox[{"_", "?", "ImageQ"}]}]}], ",", "c_"}], "}"}], ":>",
                 "\n", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"ColorizedAppearances", "[", 
                 RowBox[{"l", ",", "c"}], "]"}]}]}], "\n", "\t\t\t\t\t\t", 
              "}"}]}], "]"}], "}"}]}], ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"a", ":", 
             RowBox[{"{", "__Rule", "}"}]}], ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"DeleteCases", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Thread", "[", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Default\>\"", ",", "\"\<Pressed\>\"", ",", 
                  "\"\<Hover\>\""}], "}"}], "->", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                  RowBox[{"Association", "@", "a"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Default\>\"", ",", "\"\<Pressed\>\"", ",", 
                    "\"\<Hover\>\""}], "}"}]}], "]"}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"_", "\[Rule]", "_Missing"}]}], "\n", "\t\t\t\t\t\t", 
             "]"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"b_", ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"Thread", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<Default\>\"", ",", "\"\<Hover\>\"", ",", 
                "\"\<Pressed\>\""}], "}"}], "->", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{"Flatten", "@", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"b", ",", "3"}], "]"}]}], ",", "3"}], "]"}]}], "\n",
              "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], 
      ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
      RowBox[{"Alignment", "->", "Top"}]}], "\n", "\t\t", "]"}]}], ";", "\n", 
   
   RowBox[{"ColoredButton", "~", "SetAttributes", "~", "HoldRest"}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.6973307289489822`*^9, 3.6973308873217793`*^9}, {
   3.697330968141232*^9, 3.697330971448717*^9}, {3.6973310267470703`*^9, 
   3.697331027761401*^9}, 3.697333153945766*^9, {3.697333270773303*^9, 
   3.697333283897229*^9}, {3.6973335074491243`*^9, 3.697333523949172*^9}, {
   3.6973336017832623`*^9, 3.697333603767478*^9}, {3.6973793229405813`*^9, 
   3.697379427905252*^9}, {3.697387307426141*^9, 3.697387322484276*^9}, {
   3.6973873986868553`*^9, 3.697387439858596*^9}, {3.697388279771306*^9, 
   3.6973883075364122`*^9}, {3.69738838476728*^9, 3.6973883933362503`*^9}, 
   3.6973888530480337`*^9, {3.6973889576268044`*^9, 3.6973890075760937`*^9}, {
   3.697389160830711*^9, 3.697389164582323*^9}, {3.697418769489781*^9, 
   3.697418773801291*^9}, {3.698018928781166*^9, 3.6980189348776083`*^9}, 
   3.6980189732526217`*^9, {3.6986124817733307`*^9, 3.6986124890715322`*^9}, {
   3.700233835742386*^9, 3.7002340008596277`*^9}, 3.7002340364048223`*^9, {
   3.7002341081043367`*^9, 3.7002341355651627`*^9}, {3.7002420472457237`*^9, 
   3.700242066290432*^9}, {3.7002421495121193`*^9, 
   3.7002421507980013`*^9}},ExpressionUUID->"9b8f3603-f5ef-4909-a283-\
d0917e731af9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ColoredPanel\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697386366485434*^9, 
  3.6973863683967524`*^9}},ExpressionUUID->"b921e97e-a1de-472b-9dba-\
9a44930671b4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"$baseColoredPanel", "=", "\n", "\t", 
    RowBox[{
     RowBox[{"FirstCase", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{"FrontEndResource", "[", 
        RowBox[{"\"\<FEExpressions\>\"", ",", "\"\<HelpViewerToolbar\>\""}], 
        "]"}], ",", "\n", "\t", "\t", "_Image", ",", "\n", "\t", "\t", "None",
        ",", "\n", "\t", "\t", "\[Infinity]"}], "\n", "\t", "\t", "]"}], "//",
      "\n", "\t", "\t", 
     RowBox[{
      RowBox[{"ImagePad", "[", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"ImagePad", "[", "\n", "\t", "\t", "\t\t", 
         RowBox[{
          RowBox[{"ImagePad", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
            RowBox[{"GrayLevel", "[", ".8", "]"}]}], "]"}], ",", "\n", "\t", 
          "\t", "\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"GrayLevel", "[", ".7", "]"}]}], "\n", "\t", "\t", "\t\t", 
         "]"}], ",", "\n", "\t", "\t", "\t", "1", ",", "\n", "\t", "\t", "\t", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "]"}]}], "\n", "\t\t\t",
        "]"}], "&"}]}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.700453668358734*^9, 
  3.700453681164997*^9}},ExpressionUUID->"5c4e252d-b4d8-4fc2-914e-\
2ab636063f24"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"$coloredPanelAppearance", "=", "\n", "\t", 
    RowBox[{"AppearanceReadyImage", "[", 
     RowBox[{"$baseColoredPanel", ",", "\n", "\t\t", 
      RowBox[{"BorderDimensions", "\[Rule]", "Automatic"}]}], "\n", "\t\t", 
     "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.697684707626298*^9, 3.697684723269261*^9}, {
  3.697684876809581*^9, 3.697684886018693*^9}, {3.7004536072683363`*^9, 
  3.7004536210375423`*^9}, {3.7004536662318287`*^9, 3.700453687414083*^9}, {
  3.7004537260478973`*^9, 3.700453796844544*^9}, {3.700453851578616*^9, 
  3.700453883193647*^9}, {3.700453931193269*^9, 3.70045393207236*^9}, {
  3.700453998549403*^9, 3.700454111976075*^9}, {3.70045427729456*^9, 
  3.700454280260995*^9}, {3.7004549528792353`*^9, 
  3.700454964067141*^9}},ExpressionUUID->"8e5931b2-40ec-44fd-a8cf-\
5b5e7a3fb915"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"ColoredPanelAppearances", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"a", ":", 
       RowBox[{"_String", "|", 
        RowBox[{"_", "?", "ImageQ"}], "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Default\>\"", "\[Rule]", "_"}], ",", 
          RowBox[{"\"\<Hover\>\"", "\[Rule]", "_"}], ",", 
          RowBox[{"\"\<Pressed\>\"", "\[Rule]", "_"}]}], "}"}]}]}], ",", "\n",
       "\t", 
      RowBox[{"color_", "?", "ColorQ"}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"ColorizedAppearances", "[", 
     RowBox[{"a", ",", "color"}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredPanelAppearances", "[", "\n", "\t", 
     RowBox[{
      RowBox[{"Optional", "[", 
       RowBox[{"Automatic", ",", "Automatic"}], "]"}], ",", "\n", "\t", 
      RowBox[{"color_", "?", "ColorQ"}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"\"\<Default\>\"", "->", 
     RowBox[{"ColorizedAppearances", "[", 
      RowBox[{"$coloredPanelAppearance", ",", "color"}], "]"}]}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredPanelAppearances", "[", "Automatic", "]"}], ":=", "\n", 
    "\t", 
    RowBox[{"\"\<Default\>\"", "->", "$coloredPanelAppearance"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredPanelAppearances", "[", 
     RowBox[{"spec_", ",", 
      RowBox[{"i", ":", 
       RowBox[{"_Integer", "|", "_String"}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"ColorizedAppearances", "[", 
     RowBox[{"spec", ",", "i"}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredButtonAppearances", "[", "s_String", "]"}], ":=", "\n", 
    "\t", 
    RowBox[{"Replace", "[", 
     RowBox[{
      RowBox[{"FEResourceFind", "[", "s", "]"}], ",", 
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "\[Rule]", "g_"}], ",", "___"}], "}"}], ":>", "\n", 
         "\t\t\t", "g"}], ",", "\n", "\t\t", 
        RowBox[{"_", ":>", "\n", "\t\t\t", 
         RowBox[{"ColoredButtonAppearances", "[", "Automatic", "]"}]}]}], 
       "\n", "\t\t", "}"}]}], "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.697333498647173*^9, 3.697333550733737*^9}, {
   3.697386397207013*^9, 3.6973863977650414`*^9}, {3.6973864295533743`*^9, 
   3.6973864636693077`*^9}, {3.697386554518765*^9, 3.697386721963154*^9}, {
   3.69738675564987*^9, 3.697386976487488*^9}, {3.697387233749072*^9, 
   3.697387276521343*^9}, {3.697387353592947*^9, 3.697387387120512*^9}, {
   3.697388248215178*^9, 3.697388259735046*^9}, 3.6974161600826797`*^9, {
   3.6974166631309423`*^9, 3.697416691418055*^9}, {3.6974170104524717`*^9, 
   3.697417025136498*^9}, {3.697417072170186*^9, 3.697417119816332*^9}, {
   3.6974178822039022`*^9, 3.6974178939059067`*^9}, {3.697418091394004*^9, 
   3.697418111655695*^9}, {3.697418645001189*^9, 3.6974186667371597`*^9}, {
   3.697418721698297*^9, 3.6974187600476437`*^9}, 3.697549648668716*^9, 
   3.697549719504321*^9, {3.697585458173554*^9, 3.69758587675021*^9}, {
   3.697585908262918*^9, 3.697586019470647*^9}, {3.6975860554035892`*^9, 
   3.697586066080257*^9}, {3.6975861177669067`*^9, 3.697586164762555*^9}, {
   3.697586198204906*^9, 3.697586203833707*^9}, {3.697586257984544*^9, 
   3.6975863710910387`*^9}, {3.697586525940895*^9, 3.697586540591154*^9}, 
   3.697586600393351*^9, {3.69758664022759*^9, 3.697586738949654*^9}, {
   3.6975869346716747`*^9, 3.69758698478938*^9}, {3.697587105839665*^9, 
   3.697587117774922*^9}, {3.6975871492939167`*^9, 3.697587271991077*^9}, {
   3.69758730362304*^9, 3.697587350582869*^9}, 3.697587386099328*^9, {
   3.697587544104773*^9, 3.697587553181397*^9}, {3.697587622523192*^9, 
   3.697587687198691*^9}, {3.697588449247196*^9, 3.6975884680374804`*^9}, 
   3.697588538530994*^9, 3.697588576930656*^9, 3.697679674639882*^9, {
   3.697679712132043*^9, 3.6976797132117043`*^9}, {3.697679912133377*^9, 
   3.69767991880653*^9}, {3.697679998066278*^9, 3.697680035944408*^9}, {
   3.697680085207896*^9, 3.697680219752018*^9}, {3.697680258753282*^9, 
   3.697680274414764*^9}, 3.697680388174659*^9, {3.697680445610919*^9, 
   3.69768048574067*^9}, {3.697680557792281*^9, 3.697680604967332*^9}, {
   3.697680691910516*^9, 3.697680750375547*^9}, {3.697680892001544*^9, 
   3.697680901159562*^9}, {3.697680955552361*^9, 3.697681002820657*^9}, {
   3.697681057065823*^9, 3.697681061490397*^9}, {3.6976811392477207`*^9, 
   3.6976811700932302`*^9}, {3.6976815730248003`*^9, 
   3.6976816315874968`*^9}, {3.697681800678076*^9, 3.6976818079086657`*^9}, {
   3.697681850948236*^9, 3.69768185197928*^9}, {3.697682045849709*^9, 
   3.697682051934862*^9}, {3.697682172666575*^9, 3.6976821780673532`*^9}, {
   3.697682514846984*^9, 3.697682609733417*^9}, {3.697682646564726*^9, 
   3.6976826518045073`*^9}, {3.697682716144554*^9, 3.697682720417335*^9}, {
   3.697682804821807*^9, 3.6976829289910307`*^9}, {3.697683104696949*^9, 
   3.6976831091316843`*^9}, {3.6976834366939383`*^9, 3.697683463042075*^9}, {
   3.697683644630575*^9, 3.69768367341928*^9}, {3.6976838006969633`*^9, 
   3.6976838110297832`*^9}, {3.697684605741333*^9, 3.6976846085869427`*^9}, {
   3.6976847264564734`*^9, 3.6976847272459927`*^9}, {3.700452989595152*^9, 
   3.700453016887445*^9}},ExpressionUUID->"731b83e7-eabf-463c-b9d3-\
36606aa19158"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ColoredPanel", "]"}], "=", "\n", "\t", 
    RowBox[{"Options", "[", "Panel", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredPanel", "[", 
     RowBox[{"label_", ",", "\n", "\t", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Panel", "[", 
     RowBox[{"label", ",", "\n", "\t\t", 
      RowBox[{"Appearance", "\[Rule]", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Flatten", "@", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{"Last", "/@", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Flatten", "@", 
             RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", 
               RowBox[{
                RowBox[{"OptionValue", "@", "Appearance"}], ",", 
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"c", ":", 
                    RowBox[{
                    RowBox[{"_", "?", "ColorQ"}], "|", "_String", "|", 
                    "Automatic"}]}], ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"ColoredPanelAppearances", "[", "c", "]"}]}], ",", 
                  "\n", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s_String", ",", "c_"}], "}"}], ":>", "\n", 
                   "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"ColoredPanelAppearances", "[", 
                    RowBox[{"s", ",", "c"}], "]"}]}], ",", "\n", "\t", "\t", 
                  "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"l", ":", 
                    RowBox[{"_List", "|", 
                    RowBox[{"_", "?", "ImageQ"}]}]}], ",", "c_"}], "}"}], ":>",
                    "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                   RowBox[{"ColorizedAppearances", "[", 
                    RowBox[{"l", ",", "c"}], "]"}]}]}], "\n", 
                 "\t\t\t\t\t\t\t\t", "}"}]}], "]"}], "}"}]}]}], "\n", 
           "\t\t\t\t\t\t", "}"}]}], ",", 
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\"\<Frameless\>\"", "\[Rule]", "i_"}], "}"}], ":>", 
            "\n", "\t\t\t\t\t\t", "i"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"a", ":", 
             RowBox[{"{", "__Rule", "}"}]}], ":>", "\n", "\t\t\t\t\t\t", 
            RowBox[{"DeleteCases", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Thread", "[", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Default\>\"", ",", "\"\<Pressed\>\"", ",", 
                  "\"\<Hover\>\""}], "}"}], "->", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"Lookup", "[", 
                 RowBox[{
                  RowBox[{"Association", "@", "a"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<Default\>\"", ",", "\"\<Pressed\>\"", ",", 
                    "\"\<Hover\>\""}], "}"}]}], "]"}]}], "\n", 
               "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"_", "\[Rule]", "_Missing"}]}], "\n", "\t\t\t\t\t\t\t", 
             "]"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"b_", ":>", "\n", "\t\t\t\t\t\t", 
            RowBox[{"Thread", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
               "\"\<Default\>\"", ",", "\"\<Hover\>\"", ",", 
                "\"\<Pressed\>\""}], "}"}], "->", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{"Flatten", "@", 
                 RowBox[{"ConstantArray", "[", 
                  RowBox[{"b", ",", "3"}], "]"}]}], ",", "3"}], "]"}]}], "\n",
              "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}],
       ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
      RowBox[{"Alignment", "->", "Top"}]}], "\n", "\t\t", "]"}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.697386507696542*^9, 3.6973865441533337`*^9}, {
   3.697386681653245*^9, 3.6973866850365887`*^9}, {3.697386992098881*^9, 
   3.697387053493174*^9}, 3.697387199769413*^9, {3.697387469126541*^9, 
   3.697387491891963*^9}, {3.697387543495163*^9, 3.697387685791851*^9}, {
   3.697387869108162*^9, 3.697387985464123*^9}, {3.697388045783783*^9, 
   3.697388052341193*^9}, {3.6973880869000273`*^9, 3.697388114767702*^9}, {
   3.697388342653109*^9, 3.697388372965934*^9}, 3.697388862239996*^9, {
   3.697388919638685*^9, 3.697388952256328*^9}, 3.697389015599677*^9, {
   3.69738912783267*^9, 3.697389153123657*^9}, {3.7002422054553003`*^9, 
   3.700242207052949*^9}, {3.700452750736541*^9, 
   3.7004528061396437`*^9}},ExpressionUUID->"b3836c6b-b53a-4ea9-a839-\
b05b840bae91"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ColoredPopupMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.696864526533663*^9, 3.6968645303170347`*^9}, 
   3.698018889440474*^9},ExpressionUUID->"c6810a69-5752-47d0-93d8-\
d9e187c06e4e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ColoredPopupMenu"}], "=", "\n", "\t", 
    RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Join", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Options", "@", "ColoredButton"}], ",", "\n", "\t\t\t", 
        RowBox[{"Options", "@", "PopupMenu"}]}], "\n", "\t\t\t", "]"}], ",", 
      "\n", "\t\t", "First"}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredPopupMenu", "[", "\n", "\t", 
     RowBox[{"var_", ",", "\n", "\t", "settings_List", ",", "\n", "\t", 
      RowBox[{"expr", ":", "notRules", ":", "Automatic"}], ",", "\n", "\t", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"PopupMenu", "[", "\n", "\t\t", 
     RowBox[{"var", ",", "\n", "\t\t", "settings", ",", "\n", "\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{"var", ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
          RowBox[{"e_", ",", "___"}], "]"}], "\[RuleDelayed]", "e"}]}], "\n", 
       "\t\t\t", "]"}], ",", "\n", "\t\t", 
      RowBox[{"ColoredButton", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
         RowBox[{"expr", ",", "\n", "\t\t\t\t", 
          RowBox[{"Automatic", ":>", "\n", "\t", "\t\t\t\t", 
           RowBox[{"Row", "@", 
            RowBox[{"{", 
             RowBox[{"var", ",", 
              RowBox[{"Spacer", "@", "10"}], ",", "\"\<\[DownPointer]\>\""}], 
             "}"}]}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        "Null", ",", "\n", "\t\t\t", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Options", "@", "ColoredButton"}]}], "]"}]}]}], "\n", 
       "\t\t\t", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"Options", "@", "PopupMenu"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"Except", "[", 
           RowBox[{"Alternatives", "@@", 
            RowBox[{"Map", "[", 
             RowBox[{"First", ",", 
              RowBox[{"Options", "@", "ColoredButton"}]}], "]"}]}], "]"}]}], 
         "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.6897764178627157`*^9, 3.6897764387785873`*^9}, {
   3.689779107516883*^9, 3.6897791163314734`*^9}, {3.68977933837574*^9, 
   3.689779346169381*^9}, {3.689779451316125*^9, 3.689779591716793*^9}, {
   3.696864568092041*^9, 3.696864571654057*^9}, {3.6968649870835*^9, 
   3.696865147452365*^9}, {3.696865244060108*^9, 3.696865271376233*^9}, {
   3.6968654058512897`*^9, 3.696865462298905*^9}, {3.6968658012930937`*^9, 
   3.696865822161642*^9}, {3.696865904803009*^9, 3.6968659152953367`*^9}, {
   3.696868748428608*^9, 3.696868753235112*^9}, {3.6980188937496223`*^9, 
   3.698018903051217*^9}, {3.698019001307206*^9, 3.698019021138371*^9}, 
   3.698022997853949*^9},ExpressionUUID->"0e3b62d1-cece-40bf-a966-\
dd8399650b09"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ColoredActionMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.696865199093544*^9, 3.6968652037015457`*^9}, 
   3.698018890697031*^9, {3.729096781179586*^9, 
   3.729096781736706*^9}},ExpressionUUID->"b9b98c7e-d2bb-4931-bd2d-\
87648ba8f376"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ColoredActionMenu"}], "=", "\n", "\t", 
    RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Join", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Options", "@", "ColoredButton"}], ",", "\n", "\t\t\t", 
        RowBox[{"Options", "@", "ActionMenu"}]}], "\n", "\t\t\t", "]"}], ",", 
      "\n", "\t\t", "First"}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ColoredActionMenu", "[", 
     RowBox[{"expr_", ",", "actions_List", ",", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"ActionMenu", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"ColoredButton", "[", 
       RowBox[{"expr", ",", "Null", ",", 
        RowBox[{"Evaluate", "@", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "ops", "}"}], ",", 
           RowBox[{"Options", "@", "ColoredButton"}]}], "]"}]}]}], "]"}], ",",
       "\n", "\t\t", "actions", ",", "\n", "\t\t", 
      RowBox[{"Appearance", "\[Rule]", "None"}], ",", "\n", "\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", 
        RowBox[{"Except", "[", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{"First", ",", 
            RowBox[{"Options", "@", "ColoredButton"}]}], "]"}]}], "]"}]}], 
       "]"}]}], "\n", "\t\t", "]"}]}]}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.696865192381896*^9, 3.696865238747184*^9}, {
  3.696865285153688*^9, 3.696865292721414*^9}, {3.696865332903081*^9, 
  3.69686534710107*^9}, {3.69686538782873*^9, 3.696865417478325*^9}, {
  3.696865705192381*^9, 3.6968657053971*^9}, {3.696866381315271*^9, 
  3.69686641218851*^9}, {3.6968664690484447`*^9, 3.69686648155205*^9}, {
  3.698019026736598*^9, 
  3.698019047217126*^9}},ExpressionUUID->"6cb74759-b8fe-4ed4-a49f-\
710af5da78a0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Combos\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697684968154038*^9, 
  3.697684971624517*^9}},ExpressionUUID->"057015e7-d913-4084-b4eb-\
28735b399977"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]coloredTriangleAppearance\[RightFloor]", \
"CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.7002385898802023`*^9},ExpressionUUID->"958f7b82-e753-4ba6-b0aa-\
5585d3665e43"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"coloredTriangleAppearance", "//", "Clear"}], "\n", 
     RowBox[{"coloredTriangleAppearance", "[", 
      RowBox[{"img_", ",", 
       RowBox[{"fill_", "?", "ColorQ"}]}], "]"}]}], ":=", "\n", "\t", 
    RowBox[{"ReplacePixelValue", "[", 
     RowBox[{"img", ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Join", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"10", ",", "14"}], "]"}], ",", "16"}], "}"}], "]"}], ",",
          "\n", "\t\t\t", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"11", ",", "13"}], "]"}], ",", "15"}], "}"}], "]"}], ",",
          "\n", "\t\t\t", 
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"11", ",", "13"}], "]"}], ",", "14"}], "}"}], "]"}], ",",
          "\n", "\t\t\t", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"12", ",", "13"}], "}"}], "}"}]}], "\n", "\t\t\t", "]"}], 
       "\[Rule]", "fill"}]}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"coloredTriangleAppearance", "[", 
     RowBox[{"img_", ",", 
      RowBox[{
       RowBox[{"Except", "[", 
        RowBox[{"_", "?", "ColorQ"}], "]"}], ".."}]}], "]"}], ":=", "\n", 
    "\t", "img"}], ";", "\n", 
   RowBox[{
    RowBox[{"coloredTriangleAppearance", "[", 
     RowBox[{"img_", ",", "fill_", ",", 
      RowBox[{"border", ":", 
       RowBox[{"Except", "[", 
        RowBox[{"_", "?", "ColorQ"}], "]"}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"coloredTriangleAppearance", "[", 
     RowBox[{"img", ",", "fill"}], "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"coloredTriangleAppearance", "[", 
     RowBox[{"img_", ",", "fill_", ",", 
      RowBox[{"border_", "?", "ColorQ"}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Fold", "[", 
     RowBox[{"ReplacePixelValue", ",", "\n", "\t\t", 
      RowBox[{"coloredTriangleAppearance", "[", 
       RowBox[{"img", ",", "fill"}], "]"}], ",", "\n", "\t\t", 
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"9", ",", "16"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"15", ",", "16"}], "}"}], ",", "\n", "\t\t\t\t", 
           RowBox[{"{", 
            RowBox[{"10", ",", "14"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"14", ",", "14"}], "}"}], ",", "\n", "\t", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"12", ",", "12"}], "}"}]}], "\n", "\t\t\t\t", "}"}], 
         "\[Rule]", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ColorQ", "@", "fill"}], ",", 
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"border", ",", "fill"}], "}"}], ",", ".3"}], "]"}], ",",
            "border"}], "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"10", ",", "15"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"14", ",", "15"}], "}"}]}], "}"}], "\[Rule]", "\n", 
         "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ColorQ", "@", "fill"}], ",", 
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"border", ",", "fill"}], "}"}], ",", ".4"}], "]"}], ",",
            "border"}], "]"}]}], ",", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"11", ",", "13"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"13", ",", "13"}], "}"}]}], "}"}], "->", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"ColorQ", "@", "fill"}], ",", 
           RowBox[{"Blend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"border", ",", "fill"}], "}"}], ",", ".2"}], "]"}], ",",
            "border"}], "]"}]}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", 
     "]"}]}]}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.7002391623727303`*^9, 3.700239168920309*^9}, {
   3.700239205233609*^9, 3.70023921952488*^9}, 3.7002392505111017`*^9, {
   3.700239384925857*^9, 3.7002394939207783`*^9}, {3.70023959091866*^9, 
   3.700239614124645*^9}, {3.700239690658729*^9, 3.700239743090311*^9}, {
   3.7002397793858356`*^9, 3.7002398394856167`*^9}, {3.700239898102572*^9, 
   3.700239913974246*^9}, {3.700239954069001*^9, 3.700240055897851*^9}, {
   3.700240214580812*^9, 3.700240258578903*^9}, {3.700240296816257*^9, 
   3.7002403268326817`*^9}},ExpressionUUID->"8baef04b-c32a-4af0-a0a9-\
dc9c1cf6c998"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PopupDropDown\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697685039221889*^9, 3.69768506376478*^9}, {
  3.729096768782435*^9, 
  3.729096770354282*^9}},ExpressionUUID->"bbc6538c-e7ca-4402-a60f-\
2fe128921643"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "PopupDropDown", "]"}], "=", "\n", "\t", 
    RowBox[{"Options", "[", "PopupMenu", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"PopupDropDown", "[", 
     RowBox[{"var_", ",", "settings_List", ",", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"dynamicVar", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"var", ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"Except", "[", 
              RowBox[{"_Dynamic", "|", "None"}], "]"}], ":>", "\n", 
             "\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"s", "=", 
                 RowBox[{"Unique", "@", "\"\<FE`popupVar$\>\""}]}], "}"}], 
               ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"s", "=", 
                 RowBox[{"Replace", "[", 
                  RowBox[{"settings", ",", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"k_", "\[Rule]", 
                    RowBox[{"v_", "\[RuleDelayed]", "v"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k_", "\[Rule]", "v_"}], ",", "___"}], "}"}], 
                    "\[RuleDelayed]", "v"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v_", ",", "___"}], "}"}], "\[RuleDelayed]", 
                    "v"}]}], "\n", "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ";", 
                "\n", "\t\t\t\t\t\t", 
                RowBox[{"Dynamic", "[", "s", "]"}]}]}], "\n", "\t\t\t\t\t", 
              "]"}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t", 
        
        RowBox[{"appearance", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"c_", "?", "ColorQ"}], "\[RuleDelayed]", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"ColorizationAdjust", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{"c", ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"ColorizedAppearances", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"FrontEndResource", "[", 
                   RowBox[{
                   "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t", 
                    "\"\<ButtonDropdownRightAppearance\>\""}], "]"}], ",", 
                  "\n", "\t\t\t\t\t\t\t", "c"}], "]"}]}], "\n", 
               "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c_", "?", "ColorQ"}], ",", "f_"}], "}"}], ":>", "\n",
               "\t\t\t\t\t", 
              RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "@", "#"}], "->", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"coloredTriangleAppearance", "[", 
                   RowBox[{
                    RowBox[{"Last", "@", "#"}], ",", "f", ",", "c"}], "]"}]}],
                  "&"}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"ColorizationAdjust", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"c", ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                  "ColorizedAppearances", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"FrontEndResource", "[", 
                    RowBox[{
                    "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t", 
                    "\"\<ButtonDropdownRightAppearance\>\""}], "]"}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t", "c"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
             ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c_", "?", "ColorQ"}], ",", "f_", ",", "b_"}], "}"}], 
              ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "@", "#"}], "->", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"coloredTriangleAppearance", "[", 
                   RowBox[{
                    RowBox[{"Last", "@", "#"}], ",", "f", ",", "b"}], "]"}]}],
                  "&"}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"ColorizationAdjust", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"c", ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                  "ColorizedAppearances", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"FrontEndResource", "[", 
                    RowBox[{
                    "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t", 
                    "\"\<ButtonDropdownRightAppearance\>\""}], "]"}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t", "c"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
             ",", "\n", "\t\t\t\t", 
             RowBox[{"s_String", ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"ColoredButtonAppearances", "[", "s", "]"}]}], ",", 
             "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"s_String", ",", "c_"}], "}"}], ":>", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"ColorizedAppearances", "[", 
               RowBox[{"s", ",", "c"}], "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"l", ":", 
                 RowBox[{"_List", "|", 
                  RowBox[{"_", "?", "ImageQ"}]}]}], ",", "c_"}], "}"}], ":>", 
              "\n", "\t\t\t\t\t", 
              RowBox[{"ColorizedAppearances", "[", 
               RowBox[{"l", ",", "c"}], "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"Except", "[", 
               RowBox[{"_List", "|", 
                RowBox[{"_", "?", "ImageQ"}]}], "]"}], "\[RuleDelayed]", "\n",
               "\t\t\t\t\t", 
              RowBox[{"FrontEndResource", "[", 
               RowBox[{
               "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", 
                "\t\t\t\t\t\t", "\"\<ButtonDropdownRightAppearance\>\""}], 
               "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
        "\t\t", 
        RowBox[{"imageSize", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"25", "\[Rule]", "\n", "\t\t\t\t\t", "Automatic"}], ",", 
             "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"s", ":", 
               RowBox[{"Except", "[", "_List", "]"}]}], "\[RuleDelayed]", 
              "\n", "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "s"}], "}"}]}], ",", "\n", 
             "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"_", ",", "25"}], "}"}], ":>", "\n", "\t\t\t\t\t", 
              "Automatic"}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"_", ",", "s_"}], "}"}], "\[RuleDelayed]", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "s"}], "}"}]}]}], "\n", "\t\t\t\t", 
            "}"}]}], "]"}]}], ",", "\n", "\t\t", 
        RowBox[{"frameMargins", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "FrameMargins", "]"}], ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"n_Integer", ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Floor", "[", 
                   RowBox[{"n", "/", "2"}], "]"}], ",", 
                  RowBox[{"Ceiling", "[", 
                   RowBox[{"n", "/", "2"}], "]"}]}], "}"}]}], "}"}]}], ",", 
             "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"l_", ",", "r_"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], ":>", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"b", ",", "t"}], "}"}]}], "}"}]}]}], "\n", 
            "\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", 
      "\t\t", 
      RowBox[{"PopupMenu", "[", "\n", "\t\t\t", 
       RowBox[{
       "dynamicVar", ",", "\n", "\t\t\t", "settings", ",", "\n", "\t\t\t", 
        "Null", ",", "\n", "\t\t\t", 
        RowBox[{"Button", "[", 
         RowBox[{"Null", ",", "\n", "\t\t\t\t", 
          RowBox[{"Appearance", "\[Rule]", "appearance"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"FrameMargins", "\[Rule]", "frameMargins"}]}], "\n", 
         "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
        RowBox[{"Appearance", "\[Rule]", "None"}], ",", "\n", "\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Except", "[", 
           RowBox[{"ImageSize", "|", "Appearance", "|", "FrameMargins"}], 
           "]"}]}], "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
   ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.698019101009663*^9, 3.698019204304154*^9}, {
   3.698019585691595*^9, 3.698019620384761*^9}, {3.698019669848768*^9, 
   3.6980197723162403`*^9}, {3.6980202144859943`*^9, 3.69802028614872*^9}, {
   3.698020356324895*^9, 3.698020428793354*^9}, {3.698020529282628*^9, 
   3.698020572496023*^9}, {3.698020781209373*^9, 3.698020786935586*^9}, 
   3.698021176815276*^9, {3.698021283969679*^9, 3.698021286715914*^9}, {
   3.69802180619558*^9, 3.698021961592965*^9}, {3.698022377609832*^9, 
   3.69802243358331*^9}, {3.698022574529904*^9, 3.6980226269220877`*^9}, {
   3.698022716214786*^9, 3.6980227454288607`*^9}, {3.698024740788632*^9, 
   3.698024749361577*^9}, {3.7002337455939093`*^9, 3.700233793631371*^9}, {
   3.700237356486534*^9, 3.700237375858047*^9}, {3.700237441908639*^9, 
   3.700237477208529*^9}, {3.70023774838052*^9, 3.700237759890686*^9}, {
   3.70023781632171*^9, 3.7002378173128233`*^9}, {3.700239187647539*^9, 
   3.700239197958127*^9}, {3.700241611553706*^9, 3.700241657875139*^9}, {
   3.700241738630928*^9, 3.700241741261881*^9}, {3.7002429316226683`*^9, 
   3.700242939475401*^9}},ExpressionUUID->"9cfcfa97-457b-42cf-8b7d-\
982352684065"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ActionDropDown\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697685055638465*^9, 
  3.697685058293215*^9}},ExpressionUUID->"c5723278-db14-4db7-bfe9-\
9d3663d49355"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ActionDropDown", "]"}], "=", "\n", "\t", 
    RowBox[{"Options", "[", "ActionMenu", "]"}]}], ";", "\n", 
   RowBox[{
    RowBox[{"ActionDropDown", "[", 
     RowBox[{"settings_List", ",", 
      RowBox[{"ops", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t", 
       RowBox[{
        RowBox[{"appearance", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"c_", "?", "ColorQ"}], "\[RuleDelayed]", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"ColorizationAdjust", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{"c", ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"ColorizedAppearances", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"FrontEndResource", "[", 
                   RowBox[{
                   "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t", 
                    "\"\<ButtonDropdownRightAppearance\>\""}], "]"}], ",", 
                  "\n", "\t\t\t\t\t\t\t", "c"}], "]"}]}], "\n", 
               "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c_", "?", "ColorQ"}], ",", 
                RowBox[{"f_", "?", "ColorQ"}]}], "}"}], ":>", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "@", "#"}], "->", 
                  RowBox[{"coloredTriangleAppearance", "[", 
                   RowBox[{
                    RowBox[{"Last", "@", "#"}], ",", "f", ",", "f"}], "]"}]}],
                  "&"}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"ColorizationAdjust", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"c", ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                  "ColorizedAppearances", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"FrontEndResource", "[", 
                    RowBox[{
                    "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t", 
                    "\"\<ButtonDropdownRightAppearance\>\""}], "]"}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t", "c"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
             ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c_", "?", "ColorQ"}], ",", 
                RowBox[{"f_", "?", "ColorQ"}], ",", 
                RowBox[{"b_", "?", "ColorQ"}]}], "}"}], ":>", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"Map", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "@", "#"}], "->", 
                  RowBox[{"coloredTriangleAppearance", "[", 
                   RowBox[{
                    RowBox[{"Last", "@", "#"}], ",", "f", ",", "b"}], "]"}]}],
                  "&"}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"ColorizationAdjust", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"c", ",", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                  "ColorizedAppearances", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"FrontEndResource", "[", 
                    RowBox[{
                    "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t", 
                    "\"\<ButtonDropdownRightAppearance\>\""}], "]"}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t", "c"}], "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
             ",", "\n", "\t\t\t\t", 
             RowBox[{"s_String", ":>", "\n", "\t\t\t\t\t", 
              RowBox[{"ColoredButtonAppearances", "[", "s", "]"}]}], ",", 
             "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"s_String", ",", "c_"}], "}"}], ":>", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"ColorizedAppearances", "[", 
               RowBox[{"s", ",", "c"}], "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"l", ":", 
                 RowBox[{"_List", "|", 
                  RowBox[{"_", "?", "ImageQ"}]}]}], ",", "c_"}], "}"}], ":>", 
              "\n", "\t\t\t\t\t", 
              RowBox[{"ColorizedAppearances", "[", 
               RowBox[{"l", ",", "c"}], "]"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"Except", "[", 
               RowBox[{"_List", "|", 
                RowBox[{"_", "?", "ImageQ"}]}], "]"}], "\[RuleDelayed]", "\n",
               "\t\t\t\t\t", 
              RowBox[{"FrontEndResource", "[", 
               RowBox[{
               "\"\<NotebookTemplatingExpressions\>\"", ",", "\n", 
                "\t\t\t\t\t\t", "\"\<ButtonDropdownRightAppearance\>\""}], 
               "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
        "\t\t", 
        RowBox[{"imageSize", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"25", "\[Rule]", "\n", "\t\t\t\t\t", "Automatic"}], ",", 
             "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"s", ":", 
               RowBox[{"Except", "[", "_List", "]"}]}], "\[RuleDelayed]", 
              "\n", "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "s"}], "}"}]}], ",", "\n", 
             "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"_", ",", "25"}], "}"}], ":>", "\n", "\t\t\t\t\t", 
              "Automatic"}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"_", ",", "s_"}], "}"}], "\[RuleDelayed]", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "s"}], "}"}]}]}], "\n", "\t\t\t\t", 
            "}"}]}], "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
      RowBox[{"ActionMenu", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Button", "[", 
         RowBox[{"\"\<\>\"", ",", "\n", "\t\t\t\t", 
          RowBox[{"Appearance", "\[Rule]", "appearance"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", 
            RowBox[{"Options", "@", "Button"}]}], "]"}]}], "\n", "\t\t\t\t", 
         "]"}], ",", "\n", "\t\t\t", "settings", ",", "\n", "\t\t\t", 
        RowBox[{"Appearance", "\[Rule]", "None"}], ",", "\n", "\t\t\t", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "ops", "}"}], ",", 
          RowBox[{"Except", "[", 
           RowBox[{"ImageSize", "|", "Appearance"}], "]"}]}], "]"}]}], "\n", 
       "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.698019101009663*^9, 3.698019204304154*^9}, {
   3.698019585691595*^9, 3.698019620384761*^9}, {3.698019669848768*^9, 
   3.6980197723162403`*^9}, {3.6980202144859943`*^9, 3.69802028614872*^9}, {
   3.698020356324895*^9, 3.698020428793354*^9}, {3.698020529282628*^9, 
   3.698020572496023*^9}, {3.698020781209373*^9, 3.698020786935586*^9}, {
   3.698021176815276*^9, 3.698021249656732*^9}, {3.700233810988681*^9, 
   3.70023381499515*^9}, 3.7002376877902937`*^9, 3.7002377758188553`*^9, 
   3.7002378283301*^9},ExpressionUUID->"b7e3047f-7e8d-441c-931d-7072122489b7"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ButtonPopupMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6973821473648357`*^9, 3.697382154739017*^9}, {
  3.697382355085081*^9, 3.697382366689087*^9}, {3.697383192626006*^9, 
  3.697383203118471*^9}},ExpressionUUID->"9afca4aa-bca0-4d2f-978e-\
240b6fa07840"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ButtonPopupMenu"}], "=", "\n", "\t", 
    RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Join", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Options", "@", "Button"}], ",", "\n", "\t\t\t", 
        RowBox[{"Options", "@", "PopupMenu"}]}], "\n", "\t\t\t", "]"}], ",", 
      "\n", "\t\t", "First"}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"notRules", "=", "notRules"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"ButtonPopupMenu", "[", "\n", "\t", 
        RowBox[{"label_", ",", "\n", "\t", 
         RowBox[{"varList", ":", 
          RowBox[{"_List", "|", 
           RowBox[{"(", 
            RowBox[{"_List", "\[Rule]", "_"}], ")"}]}]}], ",", "\n", "\t", 
         RowBox[{"buttonCall", ":", "notRules", ":", "None"}], ",", "\n", 
         "\t", 
         RowBox[{"ops", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
       "\n", "\t", 
       RowBox[{"ButtonPopupMenu", "[", 
        RowBox[{
        "Automatic", ",", "label", ",", "varList", ",", "buttonCall", ",", 
         "ops"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"ButtonPopupMenu", "[", "\n", "\t", 
        RowBox[{
         RowBox[{"varList", ":", 
          RowBox[{"_List", "|", 
           RowBox[{"(", 
            RowBox[{"_List", "\[Rule]", "_"}], ")"}]}]}], ",", "\n", "\t", 
         RowBox[{"buttonCall", ":", "notRules", ":", "None"}], ",", "\n", 
         "\t", 
         RowBox[{"ops", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
       "\n", "\t", 
       RowBox[{"ButtonPopupMenu", "[", 
        RowBox[{
        "Automatic", ",", "Automatic", ",", "varList", ",", "buttonCall", ",",
          "ops"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"ButtonPopupMenu", "[", "\n", "\t", 
        RowBox[{"buttonLabel_", ",", "\n", "\t", "label_", ",", "\n", "\t", 
         RowBox[{"varList", ":", 
          RowBox[{"_List", "|", 
           RowBox[{"(", 
            RowBox[{"_List", "\[Rule]", "_"}], ")"}]}]}], ",", "\n", "\t", 
         RowBox[{"buttonCall", ":", "notRules", ":", "None"}], ",", "\n", 
         "\t", 
         RowBox[{"ops", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
       "\n", "\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t", 
          RowBox[{
           RowBox[{"popVar", "=", "\n", "\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{"label", ",", 
              RowBox[{"{", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"s", "=", 
                    RowBox[{"Unique", "@", "\"\<FE`popupVar$\>\""}]}], "}"}], 
                   ",", "\n", "\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"s", "=", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"varList", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"k_", "\[Rule]", 
                    RowBox[{"v_", "\[RuleDelayed]", "v"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"k_", "\[Rule]", "v_"}], ",", "___"}], "}"}], 
                    "\[RuleDelayed]", "v"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"v_", ",", "___"}], "}"}], "\[RuleDelayed]", 
                    "v"}]}], "\n", "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ";", 
                    "\n", "\t\t\t\t\t\t", 
                    RowBox[{"Dynamic", "[", "s", "]"}]}]}], "\n", 
                  "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                  RowBox[{
                   RowBox[{"h_", "[", 
                    RowBox[{"s_Symbol", ",", "___"}], "]"}], ",", "e___"}], 
                  "]"}], ":>", "\n", "\t\t\t\t\t", 
                 RowBox[{"Dynamic", "[", "s", "]"}]}]}], "\n", "\t\t\t\t", 
               "}"}]}], "]"}]}], ",", "\n", "\t\t", 
           RowBox[{"defaultElement", "=", "\n", "\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{"varList", ",", 
              RowBox[{"{", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"_List", "\[Rule]", "d_"}], ")"}], "\[RuleDelayed]",
                  "\n", "\t\t\t\t\t", "d"}], ",", "\n", "\t\t\t\t", 
                RowBox[{"_", "\[Rule]", "\"\<\>\""}]}], "\n", "\t\t\t\t", 
               "}"}]}], "]"}]}], ",", "\n", "\t\t", 
           RowBox[{"appearanceAssoc", "=", "\n", "\t\t\t", 
            RowBox[{"Association", "@", "\n", "\t\t\t\t", 
             RowBox[{"Replace", "[", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{"varList", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"l_List", "\[Rule]", "_"}], ")"}], 
                  "\[RuleDelayed]", "l"}]}], "]"}], ",", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"RuleDelayed", "[", 
                   RowBox[{"a_", ",", "b_"}], "]"}], ":>", "\n", "\t", "\t", 
                  "\t\t\t\t\t", 
                  RowBox[{"(", 
                   RowBox[{"a", "\[Rule]", "b"}], ")"}]}], ",", "\n", "\t", 
                 "\t", "\t\t\t\t", 
                 RowBox[{
                  RowBox[{"a", ":", 
                   RowBox[{"Except", "[", "_Rule", "]"}]}], ":>", "\n", "\t", 
                  "\t", "\t\t\t\t\t", 
                  RowBox[{"(", 
                   RowBox[{"a", "\[Rule]", "a"}], ")"}]}]}], "\n", "\t", 
                "\t\t\t\t", "}"}], ",", "1"}], "]"}]}]}], ",", "\n", "\t\t", 
           RowBox[{"imgSize", "=", "\n", "\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
              RowBox[{"{", "\n", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i_", "?", "NumericQ"}], ",", "h_"}], "}"}], ",", 
                   "_"}], "}"}], ":>", "\n", "\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"i", "-", "25"}], ",", "h"}], "}"}]}], ",", "\n", 
                "\t\t\t\t", 
                RowBox[{
                 RowBox[{"i_", "?", "NumericQ"}], ":>", "\n", "\t\t\t\t\t", 
                 RowBox[{"i", "-", "25"}]}], ",", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"i_", "?", "NumericQ"}], ",", "h_"}], "}"}], ":>", 
                 "\n", "\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"i", "-", "25"}], ",", "h"}], "}"}]}], ",", "\n", 
                "\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"b_List", ",", "_"}], "}"}], ":>", "\n", 
                 "\t\t\t\t\t", "b"}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], 
           ",", "\n", "\t\t", 
           RowBox[{"useApp", "=", "\n", "\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
              RowBox[{"{", "\n", "\t\t\t\t", 
               RowBox[{"PopupMenu", "\[Rule]", 
                RowBox[{"{", "\n", "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"\"\<ButtonDefaultAppearance\>\"", ",", 
                    RowBox[{"GrayLevel", "[", ".98", "]"}]}], "}"}], ",", 
                  "\n", "\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{
                    {GrayLevel[0], RectangleBox[{0, 0}]}, 
                    {GrayLevel[0], RectangleBox[{1, -1}]}, 
                    {Hue[
                    0.5847145488029466, 0.7269076305220883, 
                    0.9764705882352941], RectangleBox[{0, -1}, {2, 1}]}},
                    AspectRatio->1,
                    Frame->True,
                    
                    FrameStyle->Hue[
                    0.5847145488029466, 0.7269076305220883, 
                    0.6509803921568628],
                    FrameTicks->None,
                    
                    ImageSize->
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                    PlotRangePadding->None],
                    
                    "Hue[0.5847145488029466, 0.7269076305220883, \
0.9764705882352941]"],
                    Appearance->None,
                    BaseStyle->{},
                    BaselinePosition->Baseline,
                    ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    Hue[0.5847145488029466, 0.7269076305220883, 
                    0.9764705882352941]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["HueColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
                    DefaultBaseStyle->{},
                    Evaluator->Automatic,
                    Method->"Preemptive"],
                    Hue[
                    0.5847145488029466, 0.7269076305220883, 
                    0.9764705882352941],
                    Editable->False,
                    Selectable->False], ",", "White", ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{
                    {GrayLevel[0], RectangleBox[{0, 0}]}, 
                    {GrayLevel[0], RectangleBox[{1, -1}]}, 
                    {Hue[0.65, 0.3, 1], RectangleBox[{0, -1}, {2, 1}]}},
                    AspectRatio->1,
                    Frame->True,
                    
                    FrameStyle->Hue[
                    0.65, 0.30000000000000004`, 0.6666666666666667],
                    FrameTicks->None,
                    
                    ImageSize->
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                    PlotRangePadding->None],
                    "Hue[0.65, 0.3, 1]"],
                    Appearance->None,
                    BaseStyle->{},
                    BaselinePosition->Baseline,
                    ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    Hue[0.65, 0.3, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["HueColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
                    DefaultBaseStyle->{},
                    Evaluator->Automatic,
                    Method->"Preemptive"],
                    Hue[0.65, 0.3, 1],
                    Editable->False,
                    Selectable->False]}], "}"}]}], "\n", "\t\t\t\t\t", 
                 "}"}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t\t", 
          "}"}], ",", "\n", "\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"call", "=", "\n", "\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"Unevaluated", "[", "buttonCall", "]"}], ",", 
               RowBox[{"{", "\n", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"f_Function", ":>", "\n", "\t\t\t\t\t", 
                  RowBox[{"Hold", "@", 
                   RowBox[{"f", "[", 
                    RowBox[{"First", "@", "popVar"}], "]"}]}]}], ",", "\n", 
                 "\t\t\t\t", 
                 RowBox[{"e_", ":>", "\n", "\t\t\t\t\t", 
                  RowBox[{"Hold", "[", "e", "]"}]}]}], "\n", "\t\t\t\t", 
                "}"}]}], "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
           RowBox[{"Row", "[", "\n", "\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"Button", "[", "\n", "\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Replace", "[", 
                 RowBox[{"buttonLabel", ",", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{"label", ",", 
                    RowBox[{
                    RowBox[{"Except", "[", "_Dynamic", "]"}], ":>", 
                    "popVar"}]}], "]"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                    RowBox[{"v_Symbol", ",", "f___"}], "]"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Dynamic", "[", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"appearanceAssoc", ",", 
                    RowBox[{"Key", "@", "v"}], ",", "defaultElement"}], "]"}],
                     ",", "f"}], "]"}]}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                    RowBox[{
                    RowBox[{"h_", "[", 
                    RowBox[{"v_Symbol", ",", "s___"}], "]"}], ",", "f___"}], 
                    "]"}], ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Dynamic", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"h", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"appearanceAssoc", ",", 
                    RowBox[{"Key", "@", "v"}], ",", "defaultElement"}], "]"}],
                     ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", "s"}], "]"}], ",", 
                    "f"}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", "}"}]}], 
                    "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                "\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ReleaseHold", "[", "call", "]"}], "===", "None"}],
                   ",", "Null"}], "]"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"Appearance", "->", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"With", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"realApp", "=", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{"useApp", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a_", ",", "___"}], "}"}], "\[RuleDelayed]", 
                    "a"}], "\n", "\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s_String", ",", "c_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColoredButtonAppearances", "[", 
                    RowBox[{"s", ",", "c"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l_List", ",", "c_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColoredButtonAppearances", "[", 
                    RowBox[{"l", ",", "c"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"c_", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColoredButtonAppearances", "[", "c", "]"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Unevaluated", "[", "buttonCall", "]"}], "===", 
                    "None"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Lookup", "[", 
                    RowBox[{"realApp", ",", "\"\<Default\>\""}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t", "realApp"}], "\n", 
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                  "]"}]}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"ImageSize", "\[Rule]", "imgSize"}], ",", "\n", 
                "\t\t\t\t\t", 
                RowBox[{"FrameMargins", "->", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"OptionValue", "@", "FrameMargins"}], ",", "\n", 
                   "\t", "\t\t\t\t\t\t", 
                   RowBox[{
                   "i_Integer", "\[RuleDelayed]", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "\n", "\t", 
                  "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"FilterRules", "[", 
                 RowBox[{
                  RowBox[{"{", "ops", "}"}], ",", 
                  RowBox[{"Options", "@", "Button"}]}], "]"}]}], "\n", 
               "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
              RowBox[{"PopupDropDown", "[", 
               RowBox[{"popVar", ",", "\n", "\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{"varList", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"l_", "\[Rule]", "_"}], ")"}], "\[RuleDelayed]", 
                   "l"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"Appearance", "->", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Replace", "[", 
                    RowBox[{"useApp", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"___", ",", "a_"}], "}"}], "\[RuleDelayed]", 
                    "a"}], "\n", "\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"s_String", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColoredButtonAppearances", "[", "s", "]"}]}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s_String", ",", "c_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColorizedAppearances", "[", 
                    RowBox[{"s", ",", "c"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l_List", ",", "c_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColorizedAppearances", "[", 
                    RowBox[{"l", ",", "c"}], "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
                "\t\t\t\t\t", 
                RowBox[{"FrameMargins", "->", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"OptionValue", "@", "FrameMargins"}], ",", "\n", 
                   "\t", "\t\t\t\t\t\t", 
                   RowBox[{
                   "i_Integer", "\[RuleDelayed]", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "\n", 
                  "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
                RowBox[{"ImageSize", "->", "\n", "\t\t\t\t\t\t", 
                 RowBox[{"Replace", "[", 
                  RowBox[{
                   RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "i_Integer", ":>", "\n", "\t\t\t\t\t\t\t\t", 
                    "Automatic"}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_List", ",", "s_"}], "}"}], "\[RuleDelayed]", 
                    "s"}]}], "\n", "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", 
                "\n", "\t\t\t\t\t", "ops"}], "\n", "\t\t\t\t\t", "]"}]}], 
             "\n", "\t\t\t\t", "}"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t\t",
           "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
   RowBox[{"ButtonPopupMenu", "~", "SetAttributes", "~", "HoldRest"}]}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->{{3.700240620543836*^9, 3.700240636115891*^9}, {
   3.700240929628191*^9, 3.7002409556170473`*^9}, 3.70024101055221*^9, {
   3.700241136919565*^9, 3.700241142462316*^9}, {3.7002413978260307`*^9, 
   3.70024140216656*^9}, {3.7002414408576603`*^9, 3.700241474790752*^9}, {
   3.700241517606447*^9, 3.700241533852529*^9}, {3.700242351194996*^9, 
   3.700242362565137*^9}, {3.700242825944888*^9, 3.700242866047015*^9}, {
   3.7002430561568537`*^9, 3.700243243132367*^9}, {3.700243967587541*^9, 
   3.700243999874667*^9}, {3.7002440397203913`*^9, 3.700244054143649*^9}, {
   3.700244583829852*^9, 3.7002446112831497`*^9}, {3.700244659668789*^9, 
   3.70024466359721*^9}, {3.7002448510321836`*^9, 3.700244891716278*^9}, {
   3.720472132514984*^9, 
   3.720472140809471*^9}},ExpressionUUID->"dafc8599-66ab-4b7d-bc86-\
05e0347828f6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ButtonActionMenu\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6973903759331903`*^9, 
  3.697390380451558*^9}},ExpressionUUID->"b921ff41-d89d-4665-ad86-\
1b6d68c8a0fd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "@", "ButtonActionMenu"}], "=", "\n", "\t", 
    RowBox[{"DeleteDuplicatesBy", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Join", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Options", "@", "Button"}], ",", "\n", "\t\t\t", 
        RowBox[{"Options", "@", "ActionMenu"}]}], "\n", "\t\t\t", "]"}], ",", 
      "\n", "\t\t", "First"}], "\n", "\t\t", "]"}]}], ";", "\n", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"notRule", "=", "notRules"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"ButtonActionMenu", "[", "\n", "\t", 
        RowBox[{"label_", ",", "\n", "\t", "actions_List", ",", "\n", "\t", 
         RowBox[{"buttonCall", ":", 
          RowBox[{"_", "?", 
           RowBox[{"(", 
            RowBox[{"Not", "@*", "OptionQ"}], ")"}]}], ":", "None"}], ",", 
         "\n", "\t", 
         RowBox[{"ops", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
       "\n", "\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t", 
          RowBox[{"useApp", "=", "\n", "\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
             RowBox[{"{", "\n", "\t\t\t\t", 
              RowBox[{"PopupMenu", "\[Rule]", 
               RowBox[{"{", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"\"\<ButtonDefaultAppearance\>\"", ",", 
                   RowBox[{"GrayLevel", "[", ".98", "]"}]}], "}"}], ",", "\n",
                  "\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{
                    {GrayLevel[0], RectangleBox[{0, 0}]}, 
                    {GrayLevel[0], RectangleBox[{1, -1}]}, 
                    {Hue[
                    0.5847145488029466, 0.7269076305220883, 
                    0.9764705882352941], RectangleBox[{0, -1}, {2, 1}]}},
                    AspectRatio->1,
                    Frame->True,
                    
                    FrameStyle->Hue[
                    0.5847145488029466, 0.7269076305220883, 
                    0.6509803921568628],
                    FrameTicks->None,
                    
                    ImageSize->
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                    PlotRangePadding->None],
                    
                    "Hue[0.5847145488029466, 0.7269076305220883, \
0.9764705882352941]"],
                    Appearance->None,
                    BaseStyle->{},
                    BaselinePosition->Baseline,
                    ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    Hue[0.5847145488029466, 0.7269076305220883, 
                    0.9764705882352941]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["HueColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
                    DefaultBaseStyle->{},
                    Evaluator->Automatic,
                    Method->"Preemptive"],
                    Hue[
                    0.5847145488029466, 0.7269076305220883, 
                    0.9764705882352941],
                    Editable->False,
                    Selectable->False], ",", "White", ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{
                    {GrayLevel[0], RectangleBox[{0, 0}]}, 
                    {GrayLevel[0], RectangleBox[{1, -1}]}, 
                    {Hue[0.65, 0.3, 1], RectangleBox[{0, -1}, {2, 1}]}},
                    AspectRatio->1,
                    Frame->True,
                    
                    FrameStyle->Hue[
                    0.65, 0.30000000000000004`, 0.6666666666666667],
                    FrameTicks->None,
                    
                    ImageSize->
                    Dynamic[{
                    Automatic, 
                    1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                    Magnification])}],
                    PlotRangePadding->None],
                    "Hue[0.65, 0.3, 1]"],
                    Appearance->None,
                    BaseStyle->{},
                    BaselinePosition->Baseline,
                    ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    Hue[0.65, 0.3, 1]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["HueColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]],
                    DefaultBaseStyle->{},
                    Evaluator->Automatic,
                    Method->"Preemptive"],
                    Hue[0.65, 0.3, 1],
                    Editable->False,
                    Selectable->False]}], "}"}]}], "\n", "\t\t\t\t\t", 
                "}"}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t", 
          "}"}], ",", "\n", "\t", 
         RowBox[{"Row", "[", "\n", "\t\t", 
          RowBox[{"{", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Button", "[", 
             RowBox[{"label", ",", "\n", "\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"buttonCall", "===", "None"}], ",", "Null"}], "]"}], 
              ",", "\n", "\t\t\t\t", 
              RowBox[{"Appearance", "->", "\n", "\t\t\t\t\t", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"realApp", "=", "\n", "\t\t\t\t\t\t", 
                   RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{"useApp", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"a_", ",", "___"}], "}"}], "\[RuleDelayed]", 
                    "a"}], "\n", "\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s_String", ",", "c_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColoredButtonAppearances", "[", 
                    RowBox[{"s", ",", "c"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l_List", ",", "c_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColoredButtonAppearances", "[", 
                    RowBox[{"l", ",", "c"}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"c_", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColoredButtonAppearances", "[", "c", "]"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t", "}"}]}], "\n", "\t\t\t\t\t\t\t",
                     "]"}]}], "\n", "\t\t\t\t\t\t", "}"}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Unevaluated", "[", "buttonCall", "]"}], "===", 
                    "None"}], ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{"Lookup", "[", 
                    RowBox[{"realApp", ",", "\"\<Default\>\""}], "]"}], ",", 
                   "\n", "\t\t\t\t\t\t\t", "realApp"}], "\n", 
                  "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], 
              ",", "\n", "\t\t\t\t", 
              RowBox[{"FilterRules", "[", 
               RowBox[{
                RowBox[{"{", "ops", "}"}], ",", 
                RowBox[{"Options", "@", "Button"}]}], "]"}]}], "\n", 
             "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
            RowBox[{"ActionDropDown", "[", "\n", "\t\t\t\t", 
             RowBox[{"actions", ",", "\n", "\t\t\t\t", 
              RowBox[{"Appearance", "->", "\n", "\t\t\t\t\t", 
               RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Replace", "[", 
                  RowBox[{"useApp", ",", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"___", ",", "a_"}], "}"}], "\[RuleDelayed]", 
                    "a"}], "\n", "\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"s_String", ":>", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColoredButtonAppearances", "[", "s", "]"}]}], 
                   ",", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"s_String", ",", "c_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColorizedAppearances", "[", 
                    RowBox[{"s", ",", "c"}], "]"}]}], ",", "\n", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"l_List", ",", "c_"}], "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ColorizedAppearances", "[", 
                    RowBox[{"l", ",", "c"}], "]"}]}]}], "\n", 
                  "\t\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t", 
              RowBox[{"ImageSize", "->", "\n", "\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                   "i_Integer", ":>", "\n", "\t\t\t\t\t\t\t", "Automatic"}], 
                   ",", "\n", "\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_List", ",", "s_"}], "}"}], "\[RuleDelayed]", 
                    "s"}]}], "\n", "\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", 
              "\n", "\t\t\t\t", 
              RowBox[{"FrameMargins", "->", "\n", "\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"OptionValue", "@", "FrameMargins"}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{
                 "i_Integer", "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "i"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "\n", 
                "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", "ops"}], "\n",
              "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "}"}], "\n", "\t\t", 
          "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
   RowBox[{"ButtonActionMenu", "~", "SetAttributes", "~", "HoldRest"}]}], 
  "*)"}]], "CodeInput",
 CellChangeTimes->CompressedData["
1:eJwlz1soQwEcBvBZtA2FDmsXHEpqjIdN8iA1ltGWFjUPlHXMJedhhbXlklpq
rKlJ7ktyGfbgshZ5kFAexBt7kUSIbTUkaeVyvuPh69dX//r35VLm+jYuh8PJ
ZgJ/8nYphSus8t5FTNDNK+iGjTbxDJxTyj1QclTrg/eFWX72rikhCLMskWtY
Iz54gH7CGoYtAfIdCm9qYnA0SctVMi6WGXjQF/+WChd0FyTM3C5WwGgKv4Lt
fFstlBiPjfCX+KRgXXDFDHW3Z6zZX5M2SKXtO6DskHbDohEna3WDZxJqJwJe
9q/9exNeJp9sQUGVtr2UUSSVdcFj2t3P9tDAIJweinPBncT5ebhB971UMlb1
ToVgneBNMYz9in/Xua399FhYpT99HofBR/scJBcdq1CTU673jodVHZ49Vqcl
SqwxqpejGfC1OSaFS1QZCU12E7HOqNP402EJzyOCV7xZCew8N+RAoZVi5Tzl
y+CHukcO/wBSu+jb
  "],ExpressionUUID->"a5218698-73d6-4013-8b3d-44cd5a32f346"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ButtonActionPopup\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697390861157723*^9, 3.697390866797325*^9}, 
   3.697391029786083*^9},ExpressionUUID->"9312e168-44fc-48a3-ac8e-\
13360d662919"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ButtonActionPopup", "]"}], "=", "\n", "\t", 
    RowBox[{"Options", "[", "ButtonPopupMenu", "]"}]}], ";", "\n", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"notRules", "=", "notRules"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"ButtonActionPopup", "[", "\n", "\t", 
       RowBox[{
        RowBox[{"label_:", "Automatic"}], ",", "\n", "\t", 
        RowBox[{"setList", ":", 
         RowBox[{"_List", "|", 
          RowBox[{"(", 
           RowBox[{"_List", "\[Rule]", "_"}], ")"}]}]}], ",", "\n", "\t", 
        RowBox[{"function", ":", "notRules"}], ",", "\n", "\t", 
        RowBox[{"setfunction", ":", "notRules", ":", "Set"}], ",", "\n", "\t", 
        RowBox[{"ops", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
      "\n", "\t", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t", 
         RowBox[{"dynamicVar", "=", "\n", "\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{"label", ",", 
            RowBox[{"{", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                RowBox[{"v_Symbol", ",", "___"}], "]"}], ":>", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"Hold", "[", "v", "]"}]}], ",", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                RowBox[{
                 RowBox[{"_", "[", 
                  RowBox[{"v_Symbol", ",", "___"}], "]"}], ",", "___"}], 
                "]"}], ":>", "\n", "\t\t\t\t\t", 
               RowBox[{"Hold", "[", "v", "]"}]}], ",", "\n", "\t\t\t\t", 
              RowBox[{"_", ":>", "\n", "\t\t\t\t\t", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"s", "=", 
                   RowBox[{"Unique", "@", "\"\<FE`popupVar$\>\""}]}], "}"}], 
                 ",", "\n", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"s", "=", "\"\<\>\""}], ";", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Hold", "[", "s", "]"}]}]}], "\n", "\t\t\t\t\t\t", 
                "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t", 
         "}"}], ",", "\n", "\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"dynamicVar", ",", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Hold", "[", "dv_", "]"}], ":>", "\n", "\t\t\t", 
           RowBox[{"ButtonPopupMenu", "[", "\n", "\t\t\t\t", 
            RowBox[{"Automatic", ",", "\n", "\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{"label", ",", 
               RowBox[{"{", "\n", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                   RowBox[{"v_", ",", 
                    RowBox[{"dops", ":", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], 
                    "..."}]}]}], "]"}], ":>", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"v", ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}], ",", "\n", 
                    "\t\t\t\t\t\t\t", "dops"}], "]"}]}], ",", "\n", 
                 "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                   RowBox[{"v_", ",", 
                    RowBox[{"f", ":", 
                    RowBox[{"Except", "[", 
                    RowBox[{"_Rule", "|", "_RuleDelayed"}], "]"}]}], ",", 
                    "___"}], "]"}], ":>", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"v", ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"f", "[", "#", "]"}], ";"}], "&"}]}], "]"}]}], 
                 ",", "\n", "\t", "\t\t\t\t", 
                 RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"dv", ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}]}], "]"}]}], 
                 ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"f_Function", ":>", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Dynamic", "[", 
                   RowBox[{
                    RowBox[{"f", "[", "dv", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}]}], "]"}]}], 
                 ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"None", ":>", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"\"\<\>\"", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}]}], "]"}]}], 
                 ",", "\n", "\t\t\t\t\t", 
                 RowBox[{"_", ":>", "\n", "\t\t\t\t\t\t", 
                  RowBox[{"Dynamic", "[", 
                   RowBox[{"label", ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"function", "[", "#", "]"}], ";", 
                    RowBox[{"setfunction", "[", 
                    RowBox[{"dv", ",", "#"}], "]"}], ";"}], "&"}]}], 
                   "]"}]}]}], "\n", "\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", 
             "\t\t\t\t", "setList", ",", "\n", "\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{"label", ",", 
               RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Verbatim", "[", "Dynamic", "]"}], "[", 
                   RowBox[{"v_", ",", "___"}], "]"}], ":>", "\n", "\t", "\t", 
                  "\t\t\t\t", 
                  RowBox[{"function", "[", "v", "]"}]}], ",", "\n", "\t", 
                 "\t", "\t\t\t", 
                 RowBox[{"_", ":>", "\n", "\t", "\t\t\t\t\t", 
                  RowBox[{"function", "[", "dv", "]"}]}]}], "\n", "\t", 
                "\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t", "\t\t\t", 
             "ops"}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}]}], 
       "\n", "\t\t", "]"}]}]}], "\n", "]"}], ";"}], "*)"}]], "CodeInput",
 CellChangeTimes->{{3.6973908696001577`*^9, 3.6973908832291307`*^9}, {
   3.697390922653412*^9, 3.697390988408297*^9}, {3.697391026230762*^9, 
   3.697391764777125*^9}, {3.697391880513711*^9, 3.69739188867336*^9}, {
   3.6973919202721767`*^9, 3.69739219323368*^9}, {3.697392263139155*^9, 
   3.697392315390504*^9}, {3.697392693001898*^9, 3.697392795446224*^9}, {
   3.69739283564532*^9, 3.697392843420106*^9}, {3.697392897324534*^9, 
   3.697392925930339*^9}, 3.697392971658926*^9, {3.697393137441835*^9, 
   3.6973931560312777`*^9}, {3.697419475499773*^9, 3.697419478670046*^9}, {
   3.697419988855276*^9, 3.697419991415325*^9}, {3.69802375882127*^9, 
   3.698023802669241*^9}, {3.6980243745851297`*^9, 3.6980243856324873`*^9}, {
   3.6980244336289263`*^9, 3.698024436242886*^9}, 3.698024539369495*^9, {
   3.698024630561202*^9, 3.698024633727955*^9}, {3.698024669232151*^9, 
   3.698024670621889*^9}},ExpressionUUID->"83fb9464-3467-4f56-a9f6-\
0c3223627424"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Misc Interface Elements\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697684992192348*^9, 
  3.697684997695435*^9}},ExpressionUUID->"df31bab7-5cc8-4180-b14e-\
65723dbede36"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PaneColumn\[RightFloor]", "CodeSubsubsection",
 ShowGroupOpener->True,
 Evaluatable->True,
 CellChangeTimes->{{3.684255090752561*^9, 3.6842550936328*^9}, {
  3.684688602767008*^9, 
  3.684688605149412*^9}},ExpressionUUID->"57afb3f3-3e7f-4b34-a6b4-\
c08fab624a5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PaneColumn", "]"}], "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Dividers", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ItemSize", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Automatic", ",", 
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "250"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Scrollbars", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"False", ",", "Automatic"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AppearanceElements", "\[Rule]", "None"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Framed", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameMargins", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSizeAction", "\[Rule]", "\"\<Scrollable\>\""}]}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"FilterRules", "[", 
      RowBox[{
       RowBox[{"Options", "[", "Column", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Except", "[", 
        RowBox[{"Dividers", "|", "ItemSize"}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FilterRules", "[", 
      RowBox[{
       RowBox[{"Options", "[", "Pane", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Except", "@", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Options", "[", "Column", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
             "ImageMargins", ",", "ImageSize", ",", "Scrollbars", ",", 
              "AppearanceElements"}], "}"}]}], "\[IndentingNewLine]", "]"}]}],
          ")"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FilterRules", "[", 
      RowBox[{
       RowBox[{"Options", "[", "Framed", "]"}], ",", 
       RowBox[{"Except", "@", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{"Alternatives", "@@", 
          RowBox[{"Join", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Options", "[", "Column", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Options", "[", "Pane", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"FrameMargins", ",", "FrameStyle"}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PaneColumn", "[", 
   RowBox[{"things_", ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Pane", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Column", "[", 
      RowBox[{"things", ",", "\[IndentingNewLine]", 
       RowBox[{"Dividers", "\[Rule]", 
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"style", "=", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "@", "FrameStyle"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"l_List", "\[RuleDelayed]", 
               RowBox[{"Last", "@", 
                RowBox[{"Cases", "[", 
                 RowBox[{"l", ",", 
                  RowBox[{"Except", "[", "_List", "]"}], ",", "\[Infinity]"}],
                  "]"}]}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Switch", "[", 
           RowBox[{
            RowBox[{"OptionValue", "@", "Dividers"}], ",", 
            "\[IndentingNewLine]", "True", ",", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"Range", "[", 
                 RowBox[{"2", ",", 
                  RowBox[{"Length", "@", "things"}]}], "]"}], "\[Rule]", 
                "style"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
            "False", ",", 
            RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", "_", ",", 
            "style"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"FilterRules", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ItemSize", "\[Rule]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"OptionValue", "@", "ItemSize"}], "===", 
                 "Automatic"}], ",", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
                  RowBox[{"{", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"_Integer", "|", "_Scaled", "|", "Full", "|", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"_Integer", "|", "_Scaled", "|", "Full"}], ",", 
                    "_"}], "}"}]}], "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"1000", ",", "Automatic"}], "}"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"_", "\[RuleDelayed]", "Automatic"}]}], 
                   "\[IndentingNewLine]", "}"}]}], "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], ",", "ops"}], "}"}], ",", 
           RowBox[{"Options", "@", "PaneColumn"}]}], "]"}], ",", 
         RowBox[{"Options", "@", "Column"}]}], "]"}]}], "\[IndentingNewLine]",
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FilterRules", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FrameMargins", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ",", "ops"}], "}"}],
          ",", 
         RowBox[{"Options", "@", "PaneColumn"}]}], "]"}], ",", 
       RowBox[{"Options", "@", "Pane"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}], "//", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"TrueQ", "@", 
      RowBox[{"OptionValue", "@", "Framed"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Framed", "[", 
       RowBox[{"#", ",", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", 
            RowBox[{"Options", "@", "PaneColumn"}]}], "]"}], ",", 
          RowBox[{"Options", "@", "Framed"}]}], "]"}]}], "]"}], "&"}], ",", 
     "\[IndentingNewLine]", "Identity"}], "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.684683500818699*^9, 3.684683542576415*^9}, {
   3.684683585895857*^9, 3.684683993942412*^9}, {3.6846840663092403`*^9, 
   3.6846840926108427`*^9}, {3.6846841227467422`*^9, 3.684684376931972*^9}, {
   3.684684501096614*^9, 3.6846845046566267`*^9}, {3.684693742356222*^9, 
   3.684693912064123*^9}, {3.6846942776753798`*^9, 3.684694288778612*^9}, {
   3.684695115249465*^9, 3.684695148396284*^9}, {3.684695220141912*^9, 
   3.684695263354117*^9}, {3.684695333601694*^9, 3.6846953727101803`*^9}, {
   3.684695450094714*^9, 3.684695452197709*^9}, {3.6846959678539743`*^9, 
   3.684695968076064*^9}, {3.684698648808936*^9, 3.6846986629996223`*^9}, {
   3.684698732278368*^9, 3.684698733460915*^9}, {3.684698779805456*^9, 
   3.68469886666776*^9}, {3.684698991363681*^9, 3.684699080408811*^9}, 
   3.68469912109564*^9, {3.6846991903291492`*^9, 3.6846991912967787`*^9}, {
   3.6846992934672194`*^9, 3.684699335640585*^9}, {3.684701462951981*^9, 
   3.684701470517096*^9}, {3.68470531646006*^9, 3.684705317727756*^9}, {
   3.685452605405848*^9, 
   3.6854526062444277`*^9}},ExpressionUUID->"15629354-0451-49c1-a644-\
2dcbbe9066fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]HyperlinkBrowse\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.6882326394103003`*^9, 
  3.6882326426826277`*^9}},ExpressionUUID->"523cb75e-ae0f-4e5a-a47e-\
f2ad5079cce5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "HyperlinkBrowse", "]"}], "=", 
   RowBox[{"Join", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Function", "\[Rule]", "None"}], ",", "\n", "\t\t", 
       RowBox[{"Format", "\[Rule]", "Automatic"}]}], "\n", "\t\t", "}"}], ",",
      "\n", "\t", 
     RowBox[{"Options", "@", "PaneColumn"}]}], "\n", "\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"HyperlinkBrowse", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"links", ":", 
     RowBox[{"{", "__", "}"}]}], ",", "\n", "\t", 
    RowBox[{"buttonFunction", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_Rule", "|", "_RuleDelayed"}], "]"}], ":", "None"}], ",", "\n",
     "\t", 
    RowBox[{"formatFunction", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_Rule", "|", "_RuleDelayed"}], "]"}], ":", "Automatic"}], ",", 
    "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"format", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"formatFunction", ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "@", "Format"}], ",", "\n", 
            "\t\t\t\t\t\t\t", 
            RowBox[{"Automatic", "\[RuleDelayed]", 
             RowBox[{"Replace", "[", 
              RowBox[{"{", 
               RowBox[{"s_String", "\[RuleDelayed]", 
                RowBox[{"FileNameTake", "@", "s"}]}], "}"}], "]"}]}]}], "\n", 
           "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"function", "=", "\n", "\t\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{"buttonFunction", ",", "\n", "\t\t\t\t\t", 
         RowBox[{"Automatic", "\[RuleDelayed]", 
          RowBox[{"OptionValue", "@", "Function"}]}]}], "\n", "\t\t\t\t\t", 
        "]"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
    RowBox[{"PaneColumn", "[", "\n", "\t\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"f", "=", 
            RowBox[{"format", "@", "#"}]}], "}"}], ",", "\n", "\t", "\t", 
          "\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"buttonFunction", "=!=", "None"}], ",", "\n", "\t", "\t", 
            "\t\t\t\t", 
            RowBox[{"StatusArea", "[", "\n", "\t", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Button", "[", "\n", "\t", "\t", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                "Mouseover", "[", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Style", "[", 
                   RowBox[{"f", ",", "\"\<Hyperlink\>\""}], "]"}], ",", "\n", 
                  "\t", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                  RowBox[{"Style", "[", 
                   RowBox[{"f", ",", "\"\<HyperlinkActive\>\""}], "]"}]}], 
                 "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", "]"}], ",", "\n", 
                "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"buttonFunction", "@", "#"}], ",", "\n", "\t", "\t", 
                "\t\t\t\t\t", 
                RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], ",", 
                "\n", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"BaseStyle", "\[Rule]", 
                 RowBox[{"{", "\"\<Hyperlink\>\"", "}"}]}]}], "\n", "\t", 
               "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t\t\t\t\t",
               "#"}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"StatusArea", "[", 
             RowBox[{
              RowBox[{"Hyperlink", "[", 
               RowBox[{"f", ",", "#"}], "]"}], ",", "#"}], "]"}]}], "\t\t", 
           "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], "&"}], "/@",
        "links"}], ",", "\n", "\t\t\t\t", 
      RowBox[{"FilterRules", "[", 
       RowBox[{
        RowBox[{"{", "ops", "}"}], ",", "\n", "\t\t\t\t\t", 
        RowBox[{"Options", "@", "PaneColumn"}]}], "\n", "\t\t\t\t\t", "]"}]}],
      "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.688232647173566*^9, 3.688232784938571*^9}, {
  3.688232943246324*^9, 3.6882329485549*^9}, {3.6882330102917337`*^9, 
  3.6882330904087954`*^9}, {3.688233532104306*^9, 3.688233604268808*^9}, {
  3.688233695707765*^9, 3.68823383004762*^9}, {3.688233869745428*^9, 
  3.6882339354610033`*^9}, {3.688234042650868*^9, 3.6882342464290323`*^9}, {
  3.688234303317045*^9, 3.688234303811612*^9}, {3.68823441278662*^9, 
  3.688234422799986*^9}, {3.703740896219563*^9, 
  3.703740913051627*^9}},ExpressionUUID->"9ef2b0b2-9a67-4df2-b8c0-\
086f29d238cc"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]CellOpenerView\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.688232629762381*^9, 3.6882326319226637`*^9}, {
  3.729096683303854*^9, 
  3.7290966841351643`*^9}},ExpressionUUID->"31c99183-9e84-4265-934e-\
94e4507d706c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CellOpenerView", "]"}], "=", 
   RowBox[{"Append", "[", 
    RowBox[{
     RowBox[{"Options", "@", "Column"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CellOpenerView", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"head_", ",", "dropDown__"}], "}"}], ",", 
     RowBox[{"open", ":", 
      RowBox[{"True", "|", "False"}], ":", "False"}], ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"stuff", "=", 
       RowBox[{"Max", "@", 
        RowBox[{"(", 
         RowBox[{"First", "/@", 
          RowBox[{"ImageDimensions", "/@", 
           RowBox[{"(", 
            RowBox[{"Pane", "/@", 
             RowBox[{"Thread", "[", 
              RowBox[{"HoldForm", "[", 
               RowBox[{"{", "dropDown", "}"}], "]"}], "]"}]}], ")"}]}]}], 
         ")"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"T", "=", 
          RowBox[{"Column", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"head", ",", "dropDown"}], "}"}], ",", 
            RowBox[{"Dividers", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", "\[Rule]", "Gray"}], "}"}]}], "}"}]}], ",", 
            "ops"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"F", "=", 
          RowBox[{"Column", "[", 
           RowBox[{
            RowBox[{"{", "head", "}"}], ",", 
            RowBox[{"Dividers", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"2", "\[Rule]", "Gray"}], "}"}]}], "}"}]}], ",", 
            "ops"}], "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Toggler", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"open", "//", "TrueQ"}], ",", "T", ",", "F"}], "]"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"T", ",", "F"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CellOpenerView", "~", "SetAttributes", "~", "HoldFirst"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.686679002533031*^9, 
  3.686679014574539*^9}},ExpressionUUID->"e50f6c9d-d473-4714-bfe5-\
900a171af43d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FileBrowser\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.689208199927268*^9, 3.689208204013829*^9}, {
  3.729096678439349*^9, 
  3.7290966821752157`*^9}},ExpressionUUID->"de84e694-d118-4048-bd73-\
1c1a1ec36473"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "@", "FileBrowser"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FileBrowser", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "@", "Pane"}], ",", "\n", "\t", "\t", 
     RowBox[{"Options", "@", "Framed"}], ",", "\n", "\t", "\t", 
     RowBox[{"{", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{"\"\<MaxLength\>\"", "\[Rule]", "20"}], ",", "\n", "\t", 
       "\t\t", 
       RowBox[{"\"\<FrameWidth\>\"", "\[Rule]", "Automatic"}], ",", "\n", 
       "\t", "\t\t", 
       RowBox[{"\"\<BarSize\>\"", "\[Rule]", "150"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"Function", "\[Rule]", "SystemOpen"}], ",", "\n", "\t\t\t", 
       RowBox[{"DeleteFile", "\[Rule]", "Automatic"}], ",", "\n", "\t\t\t", 
       RowBox[{"DeleteCases", "->", "\"\<.*\>\""}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<TopBar\>\"", "\[Rule]", "True"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<SideBar\>\"", "\[Rule]", "True"}], ",", "\n", "\t\t\t", 
       RowBox[{"Sort", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"Function", "[", "\n", "\t\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"StringStartsQ", "[", 
            RowBox[{
             RowBox[{"FileBaseName", "@", "#"}], ",", "\"\<_\>\""}], "]"}], 
           ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringStartsQ", "[", 
              RowBox[{
               RowBox[{"FileBaseName", "@", "#2"}], ",", "\"\<_\>\""}], "]"}],
              ",", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{"Switch", "[", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Order", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"StringLength", "[", 
                   RowBox[{"FileBaseName", "@", "#"}], "]"}], "-", "\n", "\t",
                   "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"StringTrim", "[", 
                   RowBox[{
                    RowBox[{"FileBaseName", "@", "#"}], ",", 
                    RowBox[{"StartOfString", "~~", 
                    RowBox[{"\"\<_\>\"", ".."}]}]}], "]"}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"StringLength", "[", 
                   RowBox[{"FileBaseName", "@", "#2"}], "]"}], "-", "\n", 
                  "\t", "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"StringTrim", "[", 
                   RowBox[{
                    RowBox[{"FileBaseName", "@", "#2"}], ",", 
                    RowBox[{"StartOfString", "~~", 
                    RowBox[{"\"\<_\>\"", ".."}]}]}], "]"}]}]}], "\n", 
                "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"-", "1"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", "True", 
               ",", "\n", "\t\t\t\t\t\t\t\t", "0", ",", "\n", 
               "\t\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Order", "[", 
                 RowBox[{"#", ",", "#2"}], "]"}], ">", 
                RowBox[{"-", "1"}]}], ",", "\n", "\t\t\t\t\t\t\t\t", "1", ",",
                "\n", "\t\t\t\t\t\t\t\t\t", "False"}], "\n", 
              "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
             "True"}], "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", 
           "\t\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"StringStartsQ", "[", 
              RowBox[{
               RowBox[{"FileBaseName", "@", "#2"}], ",", "\"\<_\>\""}], "]"}],
              ",", "\n", "\t\t\t\t\t\t\t", "False", ",", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Order", "[", 
               RowBox[{"#", ",", "#2"}], "]"}], ">", 
              RowBox[{"-", "1"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", 
          "\t\t\t\t\t\t", "]"}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"Show", "\[Rule]", "All"}]}], "\n", "\t\t\t", "}"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FileBrowser", "[", "\n", "\t", 
   RowBox[{"directory_", ",", "\n", "\t", 
    RowBox[{"defaultDirectories", ":", 
     RowBox[{
      RowBox[{"{", "__String", "}"}], "|", "Automatic"}], ":", "Automatic"}], 
    ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"browserMaxFileNameLength", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "\"\<MaxLength\>\""}], ",", "\n", "\t", 
         "\t\t\t", 
         RowBox[{
          RowBox[{"Except", "@", "_Integer"}], "\[Rule]", "20"}]}], "\n", 
        "\t", "\t\t\t", "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"browserBasePaneNumber", "=", 
       RowBox[{"OptionValue", "@", "Show"}]}], ",", "\n", "\t\t", 
      "browserPaneNumber", ",", "\n", "\t\t", 
      RowBox[{"browserActiveDirectory", "=", 
       RowBox[{"ExpandFileName", "@", "directory"}]}], ",", "\n", "\t\t", 
      RowBox[{"browserActiveFile", "=", 
       RowBox[{"{", "\"\<\>\"", "}"}]}], ",", "\n", "\t\t", 
      RowBox[{"browserActiveClicks", "=", "1"}], ",", "\n", "\t\t", 
      RowBox[{"browserDirectoryFrameWidth", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "\"\<FrameWidth\>\""}], ",", 
         RowBox[{
          RowBox[{"Except", "[", "_Integer", "]"}], "\[Rule]", "250"}]}], 
        "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"browserSideBarWidth", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "\"\<BarSize\>\""}], ",", 
         RowBox[{
          RowBox[{"Except", "[", "_Integer", "]"}], "\[Rule]", "150"}]}], 
        "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"browserDeleteFilesPattern", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "DeleteCases"}], ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{"s_String", "\[RuleDelayed]", 
           RowBox[{"{", "s", "}"}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], ",",
       "\n", "\t\t", 
      RowBox[{"browserFileSortFunction", "=", 
       RowBox[{"OptionValue", "[", "Sort", "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"browserFileFilterPattern", "=", "\"\<\>\""}], ",", "\n", 
      "\t\t", 
      RowBox[{"browserOnClickFunction", "=", 
       RowBox[{"OptionValue", "@", "Function"}]}], ",", "\n", "\t\t", 
      RowBox[{"browserTopBarAppearance", "=", 
       GraphicsBox[
        TagBox[RasterBox[CompressedData["
1:eJyF1LtqwzAYhmHTdihk6Z4pd9G1Y1eXXEBMXNPFBbsQcim+NB/w+YBtfMD2
/kfLN4QSPsEjkHgnIelg/OrfT5qmua9q0k+XD8c5Xb/e1OJouz+WbZ4/7T/T
Mp1341lt7pWd8qLdDXngbvi+LwzaIAiEQRuGoTBooygSBm0cx8KgTZJEGJxV
mqYUzjDLMgptnucU2qIoKLRlWVJoq6qi0NZ1TaFtmoZC27YthbbrOgpt3/cU
2mEYKLTjOFJop2mi8PbmeRYG93dZFmHQrusqDNpt24RB63meMOS/+ff/3AC3
g29l
          "], {{0, 27}, {11, 0}}, {0, 255},
          ColorFunction->RGBColor],
         BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
         Selectable->False],
        DefaultBaseStyle->"ImageGraphics",
        ImageSizeRaw->{11, 27},
        PlotRange->{{0, 11}, {0, 27}}]}], ",", "\n", "\t\t", 
      RowBox[{"browserSideBarAppearance", "=", 
       GraphicsBox[
        TagBox[RasterBox[CompressedData["
1:eJyF1Llqw0AUheHBSeEiRWp3eYu0LtPa+AFsopg0MsiBkEfRo2lB+4IktCCp
vxlCMEeNz8A3MMM/3XBfTpfdx0opdV3rbXf83lrW8Wf/rA8H8/p5No33N/PL
OBvW6+lBX260J+1RLZbcsViO4whj2/btneu6wmDveZ4w2Pu+Lwz2QRAIg30Y
hsJAL1EUUf/9nziOKeyTJKGwT9OUwj7LMgr7PM8p7IuioLAvy5LCvqoqCvu6
rinsm6ahsG/blsK+6zoKetX3vTD4n4dhEAb7cRyFwX6aJmGwn+dZGOzJrFrM
rF8mjJc9
          "], {{0, 26}, {12, 0}}, {0, 255},
          ColorFunction->RGBColor],
         BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
         Selectable->False],
        DefaultBaseStyle->"ImageGraphics",
        ImageSizeRaw->{12, 26},
        PlotRange->{{0, 12}, {0, 26}}]}], ",", "\n", "\t\t", 
      RowBox[{"browserDelFile", "=", "\n", "\t\t\t", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "DeleteFile"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t", 
          RowBox[{"Switch", "[", 
           RowBox[{
           "$OperatingSystem", ",", "\n", "\t\t\t\t\t\t", "\"\<MacOSX\>\"", 
            ",", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"trashBase", "=", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"ExpandFileName", "@", 
                  RowBox[{"FileNameJoin", "@", 
                   RowBox[{"{", 
                    RowBox[{"\"\<~\>\"", ",", "\"\<.Trash\>\"", ",", 
                    RowBox[{"FileNameTake", "@", "#"}]}], "}"}]}]}]}], "\n", 
                "\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"copy", "=", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"FileExistsQ", "@", "trashBase"}], ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"DirectoryName", "@", "trashBase"}], ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"FileBaseName", "@", "trashBase"}], "<>", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"DateString", "[", "\"\<ISODateTime\>\"", "]"}], 
                    "<>", "\"\<.\>\"", "<>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FileExtension", "@", "trashBase"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "trashBase"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"DirectoryQ", "@", "#"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"CopyDirectory", "[", 
                    RowBox[{"#", ",", "copy"}], "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"FileExistsQ", "@", "copy"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"DeleteDirectory", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"DeleteContents", "\[Rule]", "True"}]}], "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"CopyFile", "[", 
                    RowBox[{"#", ",", "copy"}], "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"FileExistsQ", "@", "copy"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"DeleteFile", "@", "#"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                   "\t\t\t\t\t\t\t\t\t\t", "]"}], ";"}]}], "\n", 
                "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
              "]"}], "&"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], "\n", 
        "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"browserWidthHeight", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"OptionValue", "@", "ImageSize"}], ",", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"w_", ",", "h_"}], "}"}], "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"w", ",", "h"}], "}"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"Automatic", "->", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "500"}], "}"}], ",", "250"}], 
             "}"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"w_", "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{"w", ",", "250"}], "}"}]}]}], "\n", "\t\t\t\t", "}"}]}], 
        "\n", "\t\t\t", "]"}]}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"browserPaneNumber", "=", "browserBasePaneNumber"}], ";", "\n", 
     "\t", "\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"topBar", "=", "\n", "\t\t\t\t\t", 
          RowBox[{"Panel", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Framed", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Pane", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Grid", "@", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"Framed", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "InputField", "[", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"browserFileFilterPattern", ",", 
                    RowBox[{
                    RowBox[{
                    "(", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "===", "\"\<\>\""}], ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "browserPaneNumber", "=", "browserBasePaneNumber"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"browserPaneNumber", "=", "1"}]}], "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"browserFileFilterPattern", "=", "#"}], ";"}], 
                    ")"}], "&"}]}], "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", "String", ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FieldHint", "\[Rule]", "\"\<Filter by...\>\""}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Min", "@", 
                    RowBox[{"{", 
                    RowBox[{"100", ",", "browserDirectoryFrameWidth"}], 
                    "}"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "250"}], "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "Automatic"}], "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "}"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t", "]"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"RoundingRadius", "\[Rule]", "5"}], ",", "\n", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"FrameStyle", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", ".8", "]"}]}], ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"GrayLevel", "[", ".98", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "\n", 
                   "\t\t\t\t\t\t\t\t\t\t", "}"}], "\n", "\t\t\t\t\t\t\t\t\t", 
                  "}"}]}], ",", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"Alignment", "\[Rule]", "Right"}], ",", "\n", "\t", 
                "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"ImageSize", "\[Rule]", 
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Min", "@", 
                    RowBox[{"{", 
                    RowBox[{"250", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "browserDirectoryFrameWidth", "+", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "browserSideBarWidth"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "250"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "Automatic"}], 
                  "}"}]}]}], "\n", "\t", "\t", "\t", "\t\t\t\t\t", "]"}], ",",
               "\n", "\t", "\t\t\t\t\t\t", 
              RowBox[{"FrameMargins", "\[Rule]", "5"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"RoundingRadius", "\[Rule]", "5"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"FrameStyle", "\[Rule]", 
               RowBox[{"Lighter", "[", 
                RowBox[{"Gray", ",", " ", "0.5"}], "]"}]}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"Background", "\[Rule]", 
               RowBox[{"GrayLevel", "[", ".875", "]"}]}]}], "\n", 
             "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"Alignment", "\[Rule]", "Right"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
            "Appearance", "\[Rule]", "\n", "\t\t\t\t\t\t", 
             "browserTopBarAppearance"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"FrameMargins", "\[Rule]", "\n", "\t\t\t\t\t\t", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"(", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"First", "@", "browserWidthHeight"}], ",", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"Except", "[", 
                   RowBox[{"_", "?", "NumericQ"}], "]"}], ":>", "\n", 
                  "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{"browserPaneNumber", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Except", "@", "_Integer"}], "->", "2"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "n_", "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "FileNameDepth", "@", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "browserActiveDirectory"}], "-", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "1"}], "}"}]}], "+", "1"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "2"}], "}"}]}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], "*", 
                    "browserDirectoryFrameWidth"}], ")"}]}]}], "\n", 
                "\t\t\t\t\t\t\t", "]"}], "+", "browserSideBarWidth"}], "\n", 
              "\t\t\t\t\t\t", ")"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"sideBar", "=", "\n", "\t\t\t\t\t", 
          RowBox[{"Panel", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Deploy", "@", 
             RowBox[{"Column", "[", 
              RowBox[{"Table", "[", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"d", "=", "d"}], "}"}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t", 
                  RowBox[{"EventHandler", "[", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Framed", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Pane", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"FileBaseName", "@", "d"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "Full"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FrameStyle", "\[Rule]", "None"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Background", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Dynamic", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"browserActiveDirectory", "===", "d"}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"GrayLevel", "[", ".8", "]"}], ",", "None"}], 
                    "]"}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<MouseClicked\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"browserActiveDirectory", "=", "d"}], ";", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"browserActiveFile", "=", 
                    RowBox[{"{", "\"\<\>\"", "}"}]}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", ")"}]}]}], "\n", "\t", 
                   "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t\t\t", 
                 "]"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"{", 
                 RowBox[{"d", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                   "defaultDirectories", ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"Automatic", "\[RuleDelayed]", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "$HomeDirectory", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    "$UserDocumentsDirectory", ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "$UserBaseDirectory"}], "}"}]}]}], 
                   "\n", "\t", "\t\t\t\t\t\t\t\t", "]"}]}], "}"}]}], "]"}], 
              "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"FrameMargins", "\[Rule]", "None"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Appearance", "\[Rule]", "browserSideBarAppearance"}], 
            ",", "\n", "\t\t\t\t\t", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"browserSideBarWidth", ",", 
               RowBox[{"Last", "@", "browserWidthHeight"}]}], "}"}]}], ",", 
            "\n", "\t\t\t\t\t", 
            RowBox[{"BaseStyle", "\[Rule]", "\"\<Text\>\""}]}], "\n", 
           "\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"panes", "=", "\n", "\t\t\t\t\t", 
          RowBox[{"Dynamic", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{
            "browserActiveDirectory", ";", "\n", "\t\t\t\t\t\t", 
             "browserActiveFile", ";", "\n", "\t\t\t\t\t\t", 
             "browserPaneNumber", ";", "\n", "\t\t\t\t\t\t", 
             RowBox[{"Pane", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"Grid", "[", 
                 RowBox[{
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Table", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"d", "=", 
                    RowBox[{"FileNameTake", "[", 
                    RowBox[{"browserActiveDirectory", ",", "i"}], "]"}]}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "filterPattern", "=", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"browserFileFilterPattern", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"_String", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], 
                    ")"}]}], "\[RuleDelayed]", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{
                    "___", "~~", "browserFileFilterPattern", "~~", "___"}], 
                    ")"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Except", "[", "_StringExpression", "]"}], 
                    "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"browserDeleteFilesPattern", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", "l__", "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Except", "@", 
                    RowBox[{"Alternatives", "[", "l", "]"}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "s_", ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Except", "[", "s", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}]}], 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ListPicker", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Dynamic", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    "browserActiveFile", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "f_", "}"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Table", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "FileNameJoin", "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Take", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"FileNameSplit", "[", "f", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "n"}], "]"}]}], ",",
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"FileNameDepth", "@", "f"}]}], "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Function", "[", 
                    RowBox[{"browserActiveFile", "=", "#"}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Replace", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    "#", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringLength", "@", 
                    RowBox[{"FileNameTake", "@", "#"}]}], ">", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "browserMaxFileNameLength"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"FileNameTake", "@", "#"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Floor", "[", 
                    RowBox[{"browserMaxFileNameLength", "/", "2"}], "]"}], 
                    "-", "2"}]}], "]"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "<>", "\"\<...\>\"", "<>",
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{
                    RowBox[{"FileNameTake", "@", "#"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Floor", "[", 
                    RowBox[{"browserMaxFileNameLength", "/", "2"}], "]"}]}], 
                    "-", "1"}]}], "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FileNameTake", "@", "#"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ")"}], "&"}], "/@",
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Sort", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"filterPattern", ",", "_Except"}], "]"}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"fp", "=", 
                    RowBox[{"First", "@", "filterPattern"}]}], "}"}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"DeleteCases", "[", 
                    RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"FileNames", "[", 
                    RowBox[{"\"\<*\>\"", ",", "d"}], "]"}]}], ",", "\n", "\t",
                     "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"FileNameTake", "@", "#"}], ",", "fp"}], "]"}], 
                    "&"}], ")"}]}]}], "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"FileNames", "[", 
                    RowBox[{"\"\<*\>\"", ",", "d"}], "]"}]}], ",", "\n", "\t",
                     "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"StringMatchQ", "[", 
                    RowBox[{
                    RowBox[{"FileNameTake", "@", "#"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "filterPattern"}], "]"}], "&"}], ")"}]}]}], "]"}]}], "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "browserFileSortFunction"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", "}"}], "\[RuleDelayed]", 
                    RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"browserFileFilterPattern", "===", "\"\<\>\""}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"browserActiveDirectory", "=", 
                    RowBox[{"DirectoryName", "@", "d"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\"\<No files\>\"", "}"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Multiselection", "\[Rule]", "False"}], ",", "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "browserDirectoryFrameWidth", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Last", "@", "browserWidthHeight"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"-", "20"}], "*)"}], "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Scrollbars", "\[Rule]", "False"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FrameMargins", "\[Rule]", "None"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Background", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"None", ",", 
                    RowBox[{"GrayLevel", "@", ".95"}]}], "}"}], "}"}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"browserPaneNumber", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Except", "@", "_Integer"}], "->", "2"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "n_", "\[RuleDelayed]", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "FileNameDepth", "@", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "browserActiveDirectory"}], "-", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "1"}], "}"}]}], "+", "1"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "2"}], "}"}]}]}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "FileNameDepth", "@", "browserActiveDirectory"}]}], 
                    "}"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "}"}], 
                  ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                  "Dividers", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Array", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", "\[Rule]", "Gray"}], "&"}], ",", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{"browserPaneNumber", ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Except", "[", 
                    RowBox[{"_Integer", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", ">", "1"}], "&"}], ")"}]}], "]"}], 
                    "\[RuleDelayed]", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FileNameDepth", "@", "browserActiveDirectory"}], 
                    "-", "2"}], ")"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "0"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", "\[Rule]", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"browserPaneNumber", "-", "2"}], ",", "2"}], 
                    "}"}]}]}]}], "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", "2"}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "\n", 
                "\t\t\t\t\t\t\t\t\t\t\t\t", "~", "EventHandler", "~", "\n", 
                "\t\t\t\t\t\t\t\t\t\t\t\t", 
                RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                   "\"\<MouseClicked\>\"", "\[RuleDelayed]", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"CurrentValue", "@", "\"\<MouseClickCount\>\""}], 
                    ">", "1"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "browserActiveFile"}], ">", "0"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "@", "browserActiveFile"}], "=!=", 
                    "\"\<\>\""}], "&&", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FileExistsQ", "@", 
                    RowBox[{"First", "@", "browserActiveFile"}]}]}], ",", 
                    "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{"browserOnClickFunction", "@", 
                    RowBox[{"First", "@", "browserActiveFile"}]}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n",
                     "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"AllTrue", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<OptionKey\>\"", ",", "\"\<ShiftKey\>\""}], 
                    "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "CurrentValue"}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "browserActiveFile"}], ">", "0"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "@", "browserActiveFile"}], "=!=", 
                    "\"\<\>\""}], "&&", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FileExistsQ", "@", 
                    RowBox[{"First", "@", "browserActiveFile"}]}]}], ",", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"browserDelFile", "@", 
                    RowBox[{"First", "@", "browserActiveFile"}]}], ";", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"FileExistsQ", "@", 
                    RowBox[{"First", "@", "browserActiveFile"}]}]}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"browserActiveFile", "=", 
                    RowBox[{"Rest", "@", "browserActiveFile"}]}], ";"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], 
                    ";"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "browserActiveFile"}], ">", "0"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "@", "browserActiveFile"}], "=!=", 
                    "\"\<\>\""}], "&&", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FileExistsQ", "@", 
                    RowBox[{"First", "@", "browserActiveFile"}]}]}], ",", 
                    "\n", "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"DirectoryQ", "@", 
                    RowBox[{"First", "@", "browserActiveFile"}]}], ",", 
                    RowBox[{
                    "(*", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Pause", "[", ".1", "]"}], ";"}], "*)"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "browserActiveDirectory", "=", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"First", "@", "browserActiveFile"}]}], ",", "\n", 
                    "\t", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"DirectoryName", "@", 
                    RowBox[{
                    "First", "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "browserActiveFile"}]}], "=!=", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "browserActiveDirectory"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "browserActiveDirectory", "=", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"DirectoryName", "@", 
                    RowBox[{
                    "First", "@", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "browserActiveFile"}]}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}],
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], 
                   ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                   "\"\<ReturnKeyDown\>\"", "\[RuleDelayed]", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"First", "@", "browserActiveFile"}], "=!=", 
                    "\"\<\>\""}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "&&", 
                    RowBox[{"FileExistsQ", "@", 
                    RowBox[{"First", "@", "browserActiveFile"}]}]}], ",", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"browserOnClickFunction", "@", 
                    RowBox[{"First", "@", "browserActiveFile"}]}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", 
                   "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"\"\<BackspaceKeyDown\>\"", "\[RuleDelayed]", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "browserActiveDirectory", "=", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ParentDirectory", "@", "browserActiveDirectory"}]}], ";",
                     "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"browserActiveFile", "=", 
                    RowBox[{"{", "\"\<\>\"", "}"}]}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", ")"}]}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"PassEventsDown", "\[Rule]", "True"}]}], "\n", 
                  "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], "\n", "\t", 
                 "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t", 
               "\t\t\t\t\t\t\t\t\t\t\t", 
               RowBox[{
               "FilterRules", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"FilterRules", "[", 
                  RowBox[{
                   RowBox[{"{", "ops", "}"}], ",", 
                   RowBox[{"Except", "@", "ImageSize"}]}], "]"}], ",", "\n", 
                 "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"Options", "@", "Pane"}]}], "\n", "\t", 
                "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
               "\t\t\t\t\t\t\t\t\t\t\t", 
               RowBox[{"ImageSize", "\[Rule]", "browserWidthHeight"}], ",", 
               "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
               RowBox[{"AppearanceElements", "\[Rule]", "None"}], ",", "\n", 
               "\t\t\t\t\t\t\t\t\t\t\t\t", 
               RowBox[{
               "ScrollPosition", "\[Rule]", "\n", 
                "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                RowBox[{"With", "[", 
                 RowBox[{
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                   "testPoint", "=", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Replace", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"First", "@", "browserWidthHeight"}], ",", 
                    RowBox[{
                    "{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Except", "@", "_Integer"}], "\[Rule]", "0"}], 
                    ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"w_", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"w", "/", "browserDirectoryFrameWidth"}], 
                    ")"}]}]}], "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", 
                   "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n",
                   "\t", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                  "If", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{"browserPaneNumber", ",", 
                    RowBox[{"Except", "@", "_Integer"}]}], "]"}], "||", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"browserPaneNumber", ">", "testPoint"}]}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", ")"}], "&&", 
                    RowBox[{
                    RowBox[{"(", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"FileNameDepth", "@", "browserActiveDirectory"}], 
                    "-", "1"}], "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    ")"}], ">", "testPoint"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Pause", "[", ".1", "]"}], ";", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"FileNameDepth", "@", "browserActiveDirectory"}], 
                    "*", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "browserDirectoryFrameWidth"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "0"}], "}"}]}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"testPoint", "*", "browserDirectoryFrameWidth"}], 
                    ",", "0"}], "}"}]}], "]"}]}], "\n", "\t", "\t", 
                 "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", 
              "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
            "\t\t\t\t\t\t\t\t\t\t", 
            RowBox[{"TrackedSymbols", "\[RuleDelayed]", 
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
              RowBox[{
              "browserActiveDirectory", ",", "\n", "\t", 
               "\t\t\t\t\t\t\t\t\t\t\t", "browserActiveFile", ",", "\n", 
               "\t\t\t\t\t\t\t\t\t\t\t\t", "browserPaneNumber"}], "}"}]}]}], 
           "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
        "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", "\n", 
       "\t\t\t\t\t\t\t\t\t", 
       RowBox[{
        RowBox[{"Grid", "[", 
         RowBox[{
          RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"OptionValue", "@", "\"\<TopBar\>\""}], "//", 
               "TrueQ"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Item", "[", 
                 RowBox[{"topBar", ",", 
                  RowBox[{"ItemSize", "\[Rule]", "Full"}]}], "]"}], ",", 
                "SpanFromLeft"}], "}"}], ",", "\n", 
              "\t\t\t\t\t\t\t\t\t\t\t\t\t", "Nothing"}], "]"}], ",", "\n", 
            "\t\t\t\t\t\t\t\t\t\t\t", 
            RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"OptionValue", "@", "\"\<SideBar\>\""}], "//", 
                 "TrueQ"}], ",", "sideBar", ",", "Nothing"}], "]"}], ",", 
              "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "panes"}], "\n", 
             "\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
           "\t\t\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
          RowBox[{"Alignment", "\[Rule]", "Right"}], ",", "\n", "\t", 
          "\t\t\t\t\t\t\t\t\t", 
          RowBox[{"Spacings", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", ".025"}], "}"}]}]}], "\n", 
         "\t\t\t\t\t\t\t\t\t\t", "]"}], "//", "\n", "\t\t\t\t\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"Framed", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
            "#", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", "\"\<Text\>\""}], 
            "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
           "\t\t\t\t\t\t\t\t\t\t\t", 
           RowBox[{"FrameStyle", "\[Rule]", "Gray"}], ",", "\n", 
           "\t\t\t\t\t\t\t\t\t\t\t", 
           RowBox[{"FrameMargins", "\[Rule]", "None"}], ",", "\n", 
           "\t\t\t\t\t\t\t\t\t\t\t", 
           RowBox[{"Background", "\[Rule]", "White"}], ",", "\n", 
           "\t\t\t\t\t\t\t\t\t\t\t", 
           RowBox[{
           "RoundingRadius", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TrueQ", "@", 
                RowBox[{"OptionValue", "@", "\"\<TopBar\>\""}]}], "||", "\n", 
               "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
               RowBox[{"TrueQ", "@", 
                RowBox[{"OptionValue", "@", "\"\<SideBar\>\""}]}]}], ",", 
              "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "0", ",", "\t", "\n", 
              "\t\t\t\t\t\t\t\t\t\t\t\t\t", "5"}], "\n", 
             "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
           "\t\t\t\t\t\t\t\t\t\t\t", 
           RowBox[{"FilterRules", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"FilterRules", "[", 
              RowBox[{
               RowBox[{"{", "ops", "}"}], ",", 
               RowBox[{"Except", "@", "ImageSize"}]}], "]"}], ",", "\n", "\t",
              "\t", "\t\t\t\t\t\t\t\t\t\t", 
             RowBox[{"Options", "@", "Framed"}]}], "]"}]}], "\n", 
          "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}]}]}], "\n", 
      "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.689180198915223*^9, 3.689180531282382*^9}, {
   3.689180579822036*^9, 3.6891806121149683`*^9}, {3.689180665618874*^9, 
   3.68918073425251*^9}, {3.689180807158854*^9, 3.6891813424435253`*^9}, {
   3.6891813934888153`*^9, 3.689181394361367*^9}, {3.689182046733089*^9, 
   3.689182200501403*^9}, {3.689182235491591*^9, 3.689182240834812*^9}, {
   3.689182293120028*^9, 3.689182379528235*^9}, {3.6891824148034286`*^9, 
   3.689182453328507*^9}, {3.689182484631888*^9, 3.689182519302619*^9}, {
   3.689182551046768*^9, 3.689182553084248*^9}, {3.6891825837093487`*^9, 
   3.689182597936986*^9}, {3.689182634127994*^9, 3.689182697221919*^9}, {
   3.6891827778335943`*^9, 3.689182806758851*^9}, {3.689183376827849*^9, 
   3.689183445136001*^9}, {3.689183571781457*^9, 3.68918364372058*^9}, {
   3.689183682307214*^9, 3.6891836824597473`*^9}, {3.6891837158560667`*^9, 
   3.689183914742278*^9}, {3.689183974821447*^9, 3.689184126450697*^9}, {
   3.689184173749898*^9, 3.6891846969055233`*^9}, {3.689184747585224*^9, 
   3.689184794092567*^9}, {3.6891849647906303`*^9, 3.689184965046979*^9}, {
   3.68918509675453*^9, 3.689185122089634*^9}, {3.689185192228923*^9, 
   3.6891853051684303`*^9}, {3.689185339471532*^9, 3.689185404093093*^9}, {
   3.689185482230976*^9, 3.6891854826436*^9}, {3.689185512794074*^9, 
   3.689185527076839*^9}, {3.68918556514655*^9, 3.6891856753452997`*^9}, {
   3.689185712457323*^9, 3.689185785662705*^9}, {3.689185882197998*^9, 
   3.689186078022956*^9}, {3.689186111822494*^9, 3.689186160772541*^9}, {
   3.6891862371935253`*^9, 3.689186305825304*^9}, {3.689186340687118*^9, 
   3.689186383692646*^9}, {3.6891864186661367`*^9, 3.689186458011631*^9}, {
   3.689186495702138*^9, 3.689186532251288*^9}, {3.689186568543825*^9, 
   3.689186573872016*^9}, {3.689186669123773*^9, 3.6891866947624493`*^9}, {
   3.6891869011761847`*^9, 3.689186924004816*^9}, {3.6891869676389523`*^9, 
   3.689187011534253*^9}, {3.6891870738667507`*^9, 3.689187102642555*^9}, {
   3.689187160148274*^9, 3.689187166826539*^9}, {3.689187446391831*^9, 
   3.689187650434725*^9}, {3.6891877308118763`*^9, 3.689187764378237*^9}, {
   3.689187832389039*^9, 3.6891879303134413`*^9}, {3.6891879882529583`*^9, 
   3.689188060929859*^9}, {3.6891881711335993`*^9, 3.6891882427725487`*^9}, {
   3.689188282864559*^9, 3.689188477435478*^9}, {3.689188516341673*^9, 
   3.689188552636713*^9}, {3.689188635283236*^9, 3.6891887714123898`*^9}, {
   3.689188809627533*^9, 3.689188815659206*^9}, {3.689188904055376*^9, 
   3.6891889296063013`*^9}, {3.689188967805592*^9, 3.689189009939992*^9}, {
   3.6891890841030416`*^9, 3.68918914707272*^9}, {3.689189178549584*^9, 
   3.689189206196349*^9}, {3.689189249662339*^9, 3.689189291667843*^9}, {
   3.689189322419335*^9, 3.6891893232250223`*^9}, {3.689189356314126*^9, 
   3.689189383977442*^9}, {3.6891895383664837`*^9, 3.689189617801972*^9}, {
   3.689189749147195*^9, 3.689189796443618*^9}, {3.689189860885621*^9, 
   3.689189925759552*^9}, {3.689189961422111*^9, 3.6891899906368*^9}, {
   3.689190030332365*^9, 3.689190106309317*^9}, {3.689190654829784*^9, 
   3.689190666340576*^9}, {3.6891909422828293`*^9, 3.689190953963501*^9}, {
   3.689190994456449*^9, 3.689190998119231*^9}, {3.689191422005912*^9, 
   3.689191482512533*^9}, {3.6891915233295517`*^9, 3.689191624782227*^9}, {
   3.6891917046984158`*^9, 3.68919172503274*^9}, {3.6891917742731133`*^9, 
   3.68919179190866*^9}, {3.689191847112125*^9, 3.689191974194344*^9}, {
   3.6891920470232277`*^9, 3.689192064520563*^9}, {3.689192143998816*^9, 
   3.68919219400766*^9}, {3.6891922952319307`*^9, 3.6891923297014933`*^9}, 
   3.689192376100016*^9, {3.6891924268518267`*^9, 3.689192454578207*^9}, {
   3.689192487616282*^9, 3.68919254788947*^9}, {3.6891926270305862`*^9, 
   3.689192632076933*^9}, {3.689192737428113*^9, 3.689192824183859*^9}, {
   3.689192872096368*^9, 3.689192877862329*^9}, {3.689192919975731*^9, 
   3.68919292246419*^9}, {3.689193295794875*^9, 3.689193345803101*^9}, {
   3.689193376128153*^9, 3.6891933777124357`*^9}, {3.6891934364529457`*^9, 
   3.6891934383480864`*^9}, {3.689193470979019*^9, 3.6891934796980257`*^9}, {
   3.6891935695602016`*^9, 3.689193574464074*^9}, {3.689194141851869*^9, 
   3.68919414265909*^9}, {3.689194219103075*^9, 3.689194325920108*^9}, {
   3.689194397252829*^9, 3.689194498687174*^9}, {3.689198567975893*^9, 
   3.6891985816225367`*^9}, {3.6891986173270693`*^9, 3.689198626501443*^9}, {
   3.689199392748752*^9, 3.689199407210949*^9}, {3.689199490373887*^9, 
   3.689199507830666*^9}, {3.689199541045136*^9, 3.689199567292948*^9}, {
   3.68919959894619*^9, 3.6891996460257187`*^9}, {3.689199980790037*^9, 
   3.689200117529203*^9}, {3.689200175836321*^9, 3.689200181210107*^9}, {
   3.689200218764583*^9, 3.689200255786789*^9}, {3.689200318739005*^9, 
   3.689200402321578*^9}, {3.689200448131118*^9, 3.689200551904711*^9}, 
   3.689200600376792*^9, 3.689200810139517*^9, {3.6892008797784843`*^9, 
   3.68920088700219*^9}, 3.689201582588237*^9, {3.6892016367201967`*^9, 
   3.68920169720138*^9}, {3.689201727757284*^9, 3.6892017287401752`*^9}, {
   3.6892021887802353`*^9, 3.6892021948050213`*^9}, {3.689202584671158*^9, 
   3.68920260695636*^9}, {3.689202711643861*^9, 3.689202717722954*^9}, {
   3.689202755362351*^9, 3.689202787775137*^9}, {3.689202827585917*^9, 
   3.689202846025282*^9}, {3.689202894148868*^9, 3.689202904971747*^9}, {
   3.6892050898592377`*^9, 3.6892051024166737`*^9}, {3.689205162533751*^9, 
   3.6892052249883432`*^9}, {3.689205358351247*^9, 3.689205405758664*^9}, {
   3.689205518165989*^9, 3.689205522222547*^9}, {3.6892055939891148`*^9, 
   3.6892056598888073`*^9}, {3.689205815474456*^9, 3.689205850736258*^9}, {
   3.6892060053317337`*^9, 3.689206079739024*^9}, {3.689206631803113*^9, 
   3.689206653737021*^9}, {3.68920671735629*^9, 3.689206718187731*^9}, {
   3.6892068488625717`*^9, 3.6892068504795837`*^9}, 3.689206898945993*^9, {
   3.6892069894182034`*^9, 3.68920698964904*^9}, {3.689207135087947*^9, 
   3.689207160850308*^9}, {3.68920730601742*^9, 3.689207334642153*^9}, {
   3.689207407400704*^9, 3.689207464225498*^9}, {3.689207498288806*^9, 
   3.6892075318546467`*^9}, {3.689207582141481*^9, 3.689207602868125*^9}, {
   3.6892077169886208`*^9, 3.689207719259041*^9}, {3.700230823562372*^9, 
   3.700231027090274*^9}, {3.700231066653391*^9, 3.70023106993744*^9}, {
   3.7002313235460577`*^9, 3.7002313256393213`*^9}, 3.700941064322886*^9, {
   3.700941106999845*^9, 3.700941789799382*^9}, {3.700941956484943*^9, 
   3.700941959888535*^9}, {3.700941993245164*^9, 3.700942068466206*^9}, {
   3.7009422813825617`*^9, 3.700942294948868*^9}, {3.700942346269854*^9, 
   3.700942372249681*^9}, {3.700942502342465*^9, 3.7009425134653387`*^9}, {
   3.700942553351465*^9, 3.700942624801805*^9}, {3.700942698652438*^9, 
   3.7009427575110273`*^9}, {3.700943039697566*^9, 3.7009430977353077`*^9}, {
   3.700943159876874*^9, 3.700943161226346*^9}, {3.700943211655477*^9, 
   3.7009432255660954`*^9}, {3.700943902672821*^9, 3.700943919568297*^9}, {
   3.700943982290299*^9, 3.7009439851520844`*^9}, {3.700944046987896*^9, 
   3.700944083553985*^9}, 3.700944133105291*^9, {3.700944166814331*^9, 
   3.700944186006816*^9}, {3.700944226693738*^9, 3.700944232254869*^9}, {
   3.700944288621114*^9, 3.700944336633284*^9}, {3.70094437619363*^9, 
   3.700944652633443*^9}, {3.7009446869659243`*^9, 3.7009448373142138`*^9}, {
   3.700944895474503*^9, 3.7009449164586363`*^9}, {3.70094495203841*^9, 
   3.700945003612564*^9}, {3.7009450435013237`*^9, 3.700945109015851*^9}, {
   3.7009451937721033`*^9, 3.700945206050488*^9}, {3.7009453268992453`*^9, 
   3.700945331721574*^9}, {3.7016510629571238`*^9, 3.701651111824913*^9}, {
   3.7016511706011057`*^9, 3.70165119250261*^9}, {3.701651316022976*^9, 
   3.701651318948926*^9}, {3.7016513819975433`*^9, 3.7016513950309763`*^9}, 
   3.7016515201242647`*^9, {3.701651710997167*^9, 3.701651749408268*^9}, {
   3.701651813709687*^9, 3.7016518327079477`*^9}, 3.70165188270079*^9, {
   3.701651951477743*^9, 3.701651961672916*^9}, {3.701652008842548*^9, 
   3.7016520162068653`*^9}, {3.701652080220643*^9, 3.7016521421520767`*^9}, {
   3.701652298840867*^9, 3.70165231185431*^9}, {3.7016524376848593`*^9, 
   3.701652459405547*^9}, {3.701652497059268*^9, 3.701652512453388*^9}, {
   3.701652566678895*^9, 3.701652595316761*^9}, {3.701652694686849*^9, 
   3.701652724137808*^9}, {3.701652808944831*^9, 3.701652817785421*^9}, {
   3.701652864661927*^9, 3.701652896625396*^9}, {3.7016529903486643`*^9, 
   3.7016530136406193`*^9}, {3.701653052703699*^9, 3.701653067891769*^9}, {
   3.701653195868202*^9, 3.701653196194374*^9}, 3.701653237636034*^9, {
   3.70165333291822*^9, 3.701653365354611*^9}, {3.7016535156312523`*^9, 
   3.701653731804874*^9}, {3.7016538576399517`*^9, 3.7016538693276377`*^9}, {
   3.701654048990611*^9, 3.70165405137951*^9}, {3.7016540930566683`*^9, 
   3.7016541035567207`*^9}, {3.701654196885941*^9, 3.701654366125443*^9}, 
   3.701654568565501*^9, {3.701654607374432*^9, 3.701654621094789*^9}, {
   3.701654658634243*^9, 3.7016546900645733`*^9}, {3.7016548406911993`*^9, 
   3.701654916936952*^9}, {3.704047029382593*^9, 3.704047253247715*^9}, {
   3.704047289750943*^9, 3.7040473057758093`*^9}, 3.704047458019087*^9, {
   3.704047490775547*^9, 3.704047654989645*^9}, {3.704047715248282*^9, 
   3.704047732588965*^9}, {3.7040477801135607`*^9, 3.704047816038041*^9}, {
   3.70404792666928*^9, 3.704047965878215*^9}, {3.7040480516143723`*^9, 
   3.704048274790943*^9}, {3.7040483126856737`*^9, 3.704048322173242*^9}, {
   3.704048483297357*^9, 3.704048489949572*^9}, {3.704048529175763*^9, 
   3.704048550956128*^9}, {3.704048619284387*^9, 3.704048666869149*^9}, {
   3.704048750312634*^9, 3.704048773868325*^9}, {3.70404880689536*^9, 
   3.7040488609707537`*^9}},ExpressionUUID->"af942bdf-2435-4ee6-8042-\
8cbb2e47653c"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ComboButton\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.697326938023119*^9, 3.697326945189247*^9}, {
  3.697326989027685*^9, 
  3.697326990115676*^9}},ExpressionUUID->"c64f2010-d507-423e-910f-\
5485eaf03fc2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ComboButton", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Options", "[", "FramedButton", "]"}], ",", "\n", "\t\t", 
     RowBox[{"Options", "[", "RoundedButton", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ComboButton", "[", 
    RowBox[{"label_", ",", "\n", "\t", 
     RowBox[{"expr", ":", 
      RowBox[{"Except", "[", 
       RowBox[{"_Rule", "|", "_RuleDelayed", "|", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}]}], 
       "]"}], ":", "Null"}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Default", "\[RuleDelayed]", "\n", "\t\t\t", 
        RowBox[{"Button", "[", 
         RowBox[{"label", ",", "expr", ",", "\n", "\t\t\t\t", 
          RowBox[{"Appearance", "\[Rule]", "\n", "\t\t\t\t\t", 
           RowBox[{"FrontEndResource", "[", 
            RowBox[{
            "\"\<MUnitExpressions\>\"", ",", "\"\<ButtonAppearances\>\""}], 
            "]"}]}], ",", "\n", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", 
            RowBox[{"Options", "@", "Button"}]}], "]"}]}], "\n", "\t\t\t\t", 
         "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"\"\<Toolbar\>\"", ":>", "\n", "\t\t\t", 
        RowBox[{"Button", "[", 
         RowBox[{"label", ",", "expr", ",", "\n", "\t\t\t\t", 
          RowBox[{"Appearance", "\[Rule]", 
           RowBox[{"{", "\n", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{
             "\"\<Default\>\"", "\[Rule]", "\n", "\t", "\t", "\t", "\t\t\t", 
              RowBox[{"FrontEnd`FileName", "[", 
               RowBox[{
                RowBox[{"{", "\"\<Toolbars\>\"", "}"}], ",", 
                "\"\<Button.9.png\>\""}], "]"}]}], ",", "\n", "\t", "\t", 
             "\t", "\t\t", 
             RowBox[{"\"\<Hover\>\"", "->", 
              RowBox[{"FrontEnd`FileName", "[", 
               RowBox[{
                RowBox[{"{", "\"\<Toolbars\>\"", "}"}], ",", 
                "\"\<Button-Hover.9.png\>\""}], "]"}]}], ",", "\n", "\t", 
             "\t", "\t", "\t\t", 
             RowBox[{
             "\"\<Pressed\>\"", "->", "\n", "\t", "\t", "\t", "\t\t\t", 
              RowBox[{"FrontEnd`FileName", "[", 
               RowBox[{
                RowBox[{"{", "\"\<Toolbars\>\"", "}"}], ",", 
                "\"\<DefaultButton.9.png\>\""}], "]"}]}]}], "\n", 
            "\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t\t", 
          RowBox[{"FilterRules", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", 
            RowBox[{"Options", "@", "Button"}]}], "]"}]}], "\n", "\t\t\t\t", 
         "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"Framed", ":>", "\n", "\t\t\t", 
        RowBox[{"FramedButton", "[", 
         RowBox[{"label", ",", "expr", ",", 
          RowBox[{"Appearance", "\[Rule]", "None"}], ",", "ops"}], "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"c", ":", 
         RowBox[{"_Integer", "|", 
          RowBox[{"_", "?", "ColorQ"}]}]}], ":>", "\n", "\t\t\t", 
        RowBox[{"ColoredButton", "[", 
         RowBox[{"label", ",", "expr", ",", "\n", "\t\t\t\t", 
          RowBox[{"Appearance", "\[Rule]", "c"}], ",", "\n", "\t\t\t\t", 
          "ops"}], "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"a", ":", "\n", "\t\t\t", 
         RowBox[{"_List", "|", "_Function", "|", "\n", "\t\t\t", 
          RowBox[{"_Association", "?", 
           RowBox[{"(", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"KeyMemberQ", "[", 
               RowBox[{"#", ",", "Background"}], "]"}], "||", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"KeyMemberQ", "[", 
               RowBox[{"#", ",", "FrameStyle"}], "]"}]}], "&"}], ")"}]}]}]}], 
        ":>", "\n", "\t\t\t\t", 
        RowBox[{"RoundedButton", "[", 
         RowBox[{"label", ",", "expr", ",", "ops"}], "]"}]}], ",", "\n", 
       "\t\t", 
       RowBox[{"s_String", ":>", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"FEResourceFind", "[", "s", "]"}], ",", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"_", "\[Rule]", "e_"}], ",", "___"}], "}"}], 
             "\[RuleDelayed]", "e"}]}], "\n", "\t\t\t\t\t", "]"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"l", ":", 
              RowBox[{"{", "__Rule", "}"}]}], ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"Button", "[", 
              RowBox[{"label", ",", "expr", ",", 
               RowBox[{"Appearance", "\[Rule]", "l"}], ",", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "ops", "}"}], ",", 
                 RowBox[{"Options", "@", "Button"}]}], "]"}]}], "]"}]}], ",", 
            "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"i_", "?", "ImageQ"}], ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"Button", "[", 
              RowBox[{"label", ",", "expr", ",", 
               RowBox[{"Appearance", "\[Rule]", "i"}], ",", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "ops", "}"}], ",", 
                 RowBox[{"Options", "@", "Button"}]}], "]"}]}], "]"}]}], ",", 
            "\n", "\t\t\t\t", 
            RowBox[{"_", ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"Button", "[", 
              RowBox[{"label", ",", "expr", ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "ops", "}"}], ",", 
                 RowBox[{"Options", "@", "Button"}]}], "]"}]}], "]"}]}]}], 
           "\n", "\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"e_List", ":>", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"FrontEndResource", "@@", "e"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"l", ":", 
              RowBox[{"{", "__Rule", "}"}]}], ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"Button", "[", 
              RowBox[{"label", ",", "expr", ",", 
               RowBox[{"Appearance", "\[Rule]", "l"}], ",", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "ops", "}"}], ",", 
                 RowBox[{"Options", "@", "Button"}]}], "]"}]}], "]"}]}], ",", 
            "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"i_", "?", "ImageQ"}], ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"Button", "[", 
              RowBox[{"label", ",", "expr", ",", 
               RowBox[{"Appearance", "\[Rule]", "i"}], ",", "\n", 
               "\t\t\t\t\t\t", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "ops", "}"}], ",", 
                 RowBox[{"Options", "@", "Button"}]}], "]"}]}], "]"}]}], ",", 
            "\n", "\t\t\t\t", 
            RowBox[{"_", ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Except", "[", 
                   RowBox[{"Automatic", "|", "None"}], "]"}], ":>", "\n", 
                  "\t", "\t", "\t", "\t", "\t\t\t", 
                  RowBox[{"FramedButton", "[", 
                   RowBox[{"label", ",", "expr", ",", "ops"}], "]"}]}], ",", 
                 "\n", "\t\t\t\t\t\t", 
                 RowBox[{"_", ":>", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"Button", "[", 
                   RowBox[{"label", ",", "expr", ",", 
                    RowBox[{"FilterRules", "[", 
                    RowBox[{
                    RowBox[{"{", "ops", "}"}], ",", 
                    RowBox[{"Options", "@", "Button"}]}], "]"}]}], "]"}]}]}], 
                "\n", "\t\t\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t", 
           "}"}]}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"_", ":>", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Except", "[", 
              RowBox[{"Automatic", "|", "None"}], "]"}], ":>", "\n", "\t", 
             "\t", "\t\t\t", 
             RowBox[{"FramedButton", "[", 
              RowBox[{"label", ",", "expr", ",", 
               RowBox[{"Appearance", "\[Rule]", "None"}], ",", "ops"}], 
              "]"}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{"_", ":>", "\n", "\t\t\t\t\t", 
             RowBox[{"Button", "[", 
              RowBox[{"label", ",", "expr", ",", 
               RowBox[{"FilterRules", "[", 
                RowBox[{
                 RowBox[{"{", "ops", "}"}], ",", 
                 RowBox[{"Options", "@", "Button"}]}], "]"}]}], "]"}]}]}], 
           "\n", "\t\t\t\t", "}"}]}], "]"}]}]}], "\n", "\t\t", "}"}]}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{"ComboButton", "~", "SetAttributes", "~", "HoldRest"}]}], "CodeInput",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQfeTujBzxnteOn/Je14LonpfC7SD6kXbANBCtX6k6
C0RP/sC4B0R39CQ9A9Gtv3Rfg+grChbvQfS7n3c+guhj6wp/gujMUOF/IHr+
pP9MEiD1flpsIFr431wBEH3I7pgYiN60zlkWRL/yX6cMot98PRwCov2fmyaD
6H1T7y8H0Yef6K0C0aaHF24A0QE3jDaC6F+H3S+AaF1xhSsgOiYi4aYBkM7t
n3kXRM+4deQniHbmb/0FoiXEv/AaAmmbPRP5QDR/8IbbIHqK30Uw/eGXr60R
kM743WgHoltsP3k4A+nZ81w9QXSAmE88iL4S1pIIogGnnaGP
  
  "],ExpressionUUID->"b9dda9ef-9661-43a3-a500-25dc2f98b69b"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]HoverAppearButton\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.69751033675609*^9},ExpressionUUID->"d3c64dd4-9148-4c2e-b735-e36f440b677e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "HoverAppearButton", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "@", "Button"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HoverAppearButton", "[", 
    RowBox[{"l_", ",", "e_", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Button", "[", 
    RowBox[{"l", ",", "\n", "\t", "\t", "e", ",", "\n", "\t", "\t", 
     RowBox[{"Appearance", "\[Rule]", 
      RowBox[{"{", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"\"\<Default\>\"", "\[Rule]", "\n", "\t", "\t\t", 
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"img", "=", "\n", "\t", "\t\t\t\t", 
             RowBox[{"Lookup", "[", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"FrontEndResource", "[", 
                RowBox[{
                "\"\<WAExpressions\>\"", ",", 
                 "\"\<ControlEqualAppearance\>\""}], "]"}], ",", "\n", "\t", 
               "\t\t\t\t\t", "\"\<Default\>\""}], "]"}]}], "\n", "\t", 
            "\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t", 
           RowBox[{"Image", "[", "\n", "\t", "\t\t\t\t", 
            RowBox[{
             RowBox[{"SetAlphaChannel", "[", 
              RowBox[{"img", ",", 
               RowBox[{"Blend", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ColorNegate", "@", "img"}], ",", "Black"}], "}"}],
                  ",", "1"}], "]"}]}], "]"}], ",", "\n", "\t", "\t\t\t\t", 
             "\"\<Byte\>\"", ",", "\n", "\t", "\t\t\t\t", 
             RowBox[{"Interleaving", "\[Rule]", "True"}]}], "\n", "\t", 
            "\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t", "]"}]}], ",", "\n", 
        "\t", "\t\t", 
        RowBox[{"\"\<Hover\>\"", "\[Rule]", "\n", "\t", "\t\t", 
         RowBox[{"Lookup", "[", "\n", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"FrontEndResource", "[", 
            RowBox[{
            "\"\<WAExpressions\>\"", ",", "\"\<ControlEqualAppearance\>\""}], 
            "]"}], ",", "\n", "\t", "\t\t\t", "\"\<Default\>\""}], "]"}]}], 
        ",", "\n", "\t", "\t\t", 
        RowBox[{"\"\<Pressed\>\"", "\[Rule]", "\n", "\t", "\t\t", 
         RowBox[{"Lookup", "[", 
          RowBox[{
           RowBox[{"FrontEndResource", "[", 
            RowBox[{
            "\"\<WAExpressions\>\"", ",", 
             "\"\<ControlEqualGrayAppearance\>\""}], "]"}], ",", "\n", "\t", 
           "\t\t\t", "\"\<Default\>\""}], "]"}]}]}], "\n", "\t", "\t\t", 
       "}"}]}], ",", "\n", "\t", "\t", 
     RowBox[{"FrameMargins", "\[Rule]", "\n", "\t", "\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"6", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "}"}]}], ",", "\n", "\t", "\t", 
     "ops"}], "\n", "\t", "\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"HoverAppearButton", "~", "SetAttributes", "~", "HoldAll"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6975078827642193`*^9, 3.697508033968045*^9}, {
  3.6975080957850323`*^9, 3.697508443344697*^9}, {3.6975084963157883`*^9, 
  3.6975086300529613`*^9}, {3.697508779609889*^9, 3.697508826710256*^9}, {
  3.6975088653788233`*^9, 3.6975088666881237`*^9}, {3.6975089327442417`*^9, 
  3.697509022712274*^9}, {3.697509155892194*^9, 3.697509157355319*^9}, {
  3.697509215044129*^9, 3.697509215974422*^9}, {3.697509539763609*^9, 
  3.697509836429351*^9}, {3.6975098809474154`*^9, 3.697509883467224*^9}, {
  3.6975100080244226`*^9, 3.6975100253432503`*^9}, {3.697510058047593*^9, 
  3.697510084134617*^9}, {3.6975101162998943`*^9, 3.697510137326747*^9}, {
  3.697510332302724*^9, 
  3.697510343107215*^9}},ExpressionUUID->"09fe6cff-5828-4ce4-b338-\
4befda6cd087"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]SearchField\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.697510348537263*^9},ExpressionUUID->"dcc65933-880e-419f-b3d3-\
0e17c088991c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SearchField", "[", 
   RowBox[{"search_:", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NotebookFind", "[", 
       RowBox[{
        RowBox[{"InputNotebook", "[", "]"}], ",", "#", ",", "Next", ",", 
        RowBox[{"WrapAround", "\[Rule]", "True"}]}], "]"}], "&"}], ")"}]}], 
   "]"}], ":=", "\n", "\t", 
  RowBox[{"DynamicModule", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{"field", ",", "count"}], "\n", "\t", "\t\t", "}"}], ",", "\n", 
    "\t", "\t", 
    RowBox[{"Panel", "[", "\n", "\t", "\t\t", 
     RowBox[{
      RowBox[{"Row", "@", 
       RowBox[{"{", "\n", "\t", "\t\t\t", 
        RowBox[{
         RowBox[{"HoverAppearButton", "[", "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{"RawBoxes", "@", 
            RowBox[{"FrontEndResource", "[", 
             RowBox[{"\"\<FEBitmaps\>\"", ",", "\"\<SearchIcon\>\""}], 
             "]"}]}], ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "@", "field"}], ">", "0"}], ",", 
             RowBox[{"search", "@", "field"}]}], "]"}]}], "\n", "\t", 
          "\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"Spacer", "[", "5", "]"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Style", "[", "\n", "\t", "\t\t\t\t", 
           RowBox[{
            RowBox[{"InputField", "[", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Dynamic", "@", "field"}], ",", "String", ",", "\n", 
              "\t", "\t\t\t\t\t", 
              RowBox[{"FieldHint", "\[Rule]", "\"\<Search...\>\""}], ",", 
              "\n", "\t", "\t\t\t\t\t", 
              RowBox[{"Appearance", "\[Rule]", "\"\<Frameless\>\""}]}], "\n", 
             "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t\t", 
            RowBox[{"GrayLevel", "[", ".4", "]"}]}], "\n", "\t", "\t\t\t\t", 
           "]"}], "~", "EventHandler", "~", 
          RowBox[{"{", "\n", "\t", "\t\t\t\t", 
           RowBox[{
           "\"\<ReturnKeyDown\>\"", "\[RuleDelayed]", "\n", "\t", "\t\t\t\t", 
            
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"StringLength", "@", "field"}], ">", "0"}], ",", 
              RowBox[{"search", "@", "field"}]}], "]"}]}], "\n", "\t", 
           "\t\t\t\t", "}"}]}]}], "\n", "\t", "\t\t\t", "}"}]}], ",", "\n", 
      "\t", "\t\t", 
      RowBox[{"Alignment", "\[Rule]", "Center"}], ",", "\n", "\t\t\t", 
      RowBox[{"Appearance", "\[Rule]", "\n", "\t\t\t\t", 
       RowBox[{"FrontEndResource", "[", 
        RowBox[{
        "\"\<WAExpressions\>\"", ",", "\"\<ControlEqualAppearance\>\""}], 
        "]"}]}], ",", "\n", "\t", "\t\t", 
      RowBox[{"FrameMargins", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", 
           RowBox[{"-", "2"}]}], "}"}]}], "}"}]}]}], "\n", "\t", "\t\t", 
     "]"}], ",", "\n", "\t", "\t", 
    RowBox[{"Initialization", "\[RuleDelayed]", "\n", "\t", "\t", 
     RowBox[{"CompoundExpression", "[", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{"field", "=", "\"\<\>\""}], ";", "\n", "\t", "\t\t", 
       RowBox[{"count", "=", "1"}]}], "\n", "\t", "\t\t", "]"}]}]}], "\n", 
   "\t", "\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.6975078827642193`*^9, 3.697508033968045*^9}, {
  3.6975080957850323`*^9, 3.697508443344697*^9}, {3.6975084963157883`*^9, 
  3.6975086300529613`*^9}, {3.697508779609889*^9, 3.697508826710256*^9}, {
  3.6975088653788233`*^9, 3.6975088666881237`*^9}, {3.6975089327442417`*^9, 
  3.697509022712274*^9}, {3.697509155892194*^9, 3.697509157355319*^9}, {
  3.697509215044129*^9, 3.697509215974422*^9}, {3.697509539763609*^9, 
  3.697509836429351*^9}, {3.6975098809474154`*^9, 3.697509883467224*^9}, {
  3.6975100080244226`*^9, 3.6975100253432503`*^9}, {3.697510058047593*^9, 
  3.697510084134617*^9}, {3.6975101162998943`*^9, 3.697510137326747*^9}, {
  3.697510332302724*^9, 3.697510356559925*^9}, {3.697510437147088*^9, 
  3.697510440245988*^9}},ExpressionUUID->"1a5c164a-ccaa-495d-b98c-\
ec87b51816e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]File Chooser\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7002379999261827`*^9, 
  3.700238018047162*^9}},ExpressionUUID->"0c37ccc7-beb9-4328-aaa6-\
7395d3f1241f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FileChooser", "]"}], "=", "\n", "\t", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"ButtonFunction", "->", "SystemOpen"}], ",", "\n", "\t", "\t", 
       
       RowBox[{"Select", "->", "FileExistsQ"}], ",", "\n", "\t\t", 
       RowBox[{"LabelingFunction", "\[Rule]", "None"}], ",", "\n", "\t\t", 
       RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "\n", "\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "GradientButtonPopupMenu"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FileChooser", "[", 
    RowBox[{
     RowBox[{"lbl", ":", 
      RowBox[{"_Dynamic", "|", "Automatic"}], ":", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"fileListing", ":", 
      RowBox[{"_List", "|", 
       RowBox[{"_String", "?", "DirectoryQ"}]}]}], ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n",
    "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fils", "=", "\n", "\t\t", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "LabelingFunction", "]"}], "===", 
            "None"}], ",", "\n", "\t\t\t", "Identity", ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"Replace", "[", 
             RowBox[{"#", ",", "\n", "\t\t\t\t", 
              RowBox[{
               RowBox[{"v", ":", 
                RowBox[{"Except", "[", 
                 RowBox[{"_Rule", "|", "_RuleDelayed"}], "]"}]}], ":>", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"v", "->", 
                RowBox[{
                 RowBox[{"OptionValue", "[", "LabelingFunction", "]"}], "[", 
                 "v", "]"}]}]}], ",", "\n", "\t\t\t\t", "1"}], "]"}], "&"}]}],
           "\n", "\t\t\t", "]"}], "@", "\n", "\t\t", 
         RowBox[{"Select", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"fileListing", ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"_String", "?", "DirectoryQ"}], "\[RuleDelayed]", 
              RowBox[{"FileNames", "[", 
               RowBox[{"\"\<*\>\"", ",", "fileListing"}], "]"}]}]}], "]"}], 
           ",", "\n", "\t\t\t", 
           RowBox[{
            RowBox[{"OptionValue", "[", "Select", "]"}], "@*", "\n", 
            "\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"r", ":", 
                  RowBox[{"Rule", "|", "RuleDelayed"}]}], ")"}], "[", 
                RowBox[{"k_", ",", "v_"}], "]"}], "\[RuleDelayed]", "k"}], 
              "}"}], "]"}]}]}], "\n", "\t\t\t", "]"}]}]}], ",", "\n", "\t\t", 
       
       RowBox[{"openFunc", "=", 
        RowBox[{"OptionValue", "@", "ButtonFunction"}]}]}], "\n", "\t\t", 
      "}"}], ",", "\n", "\t\t", 
     RowBox[{"GradientButtonPopupMenu", "[", "\n", "\t\t\t", 
      RowBox[{"lbl", ",", "\n", "\t\t\t", "fils", ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"openFunc", "@", "#"}], "&"}], ",", "\n", "\t\t\t", 
       RowBox[{"Evaluate", "@", 
        RowBox[{"FilterRules", "[", 
         RowBox[{
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"ImageSize", "\[Rule]", "\n", "\t\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", 
               RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Automatic", "->", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"100", ",", "1000"}], "}"}], ",", "Automatic"}], 
                    "}"}], ",", "Automatic"}], "}"}]}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"i_Integer", ":>", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "Automatic"}], "}"}], ",", 
                    "Automatic"}], "}"}]}]}], "\n", "\t\t\t\t\t\t", "}"}]}], 
              "]"}]}], ",", "\n", "\t\t\t\t", 
            RowBox[{"Appearance", "->", "\n", "\t\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t", 
                RowBox[{
                "Automatic", "->", "\n", "\t\t\t\t\t\t\t", "PopupMenu"}], 
                "\n", "\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t",
             "ops", ",", "\n", "\t\t\t\t", 
            RowBox[{"FrameMargins", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"5", ",", "5"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "\n", "\t\t\t\t",
            "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"Options", "@", "GradientButtonPopupMenu"}]}], "]"}]}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.700238021573885*^9, 3.700238201070282*^9}, {
   3.70023823759653*^9, 3.70023827546697*^9}, {3.700238347201309*^9, 
   3.7002385041803102`*^9}, 3.700240437392228*^9, {3.7002419256331472`*^9, 
   3.700241955991707*^9}, {3.700242396421668*^9, 3.700242483939363*^9}, 
   3.700242520910873*^9, {3.700242557668387*^9, 3.700242581865641*^9}, {
   3.700242700899591*^9, 3.700242786065084*^9}, 3.70024297938579*^9, {
   3.70024344215937*^9, 3.700243568695609*^9}, {3.70024361549708*^9, 
   3.700243617513752*^9}, {3.700243715139762*^9, 3.7002437973204927`*^9}, {
   3.700243849917667*^9, 3.7002438507484703`*^9}, {3.700244112547329*^9, 
   3.700244203559482*^9}, {3.700244239235524*^9, 3.700244284951844*^9}, {
   3.700244515799293*^9, 3.700244526868167*^9}, {3.700507535066928*^9, 
   3.700507558096799*^9}, {3.7005076241714497`*^9, 3.700507624868325*^9}, 
   3.70050766694633*^9, {3.7005077926332827`*^9, 3.70050781106677*^9}, {
   3.700507967285335*^9, 3.700507971741798*^9}, {3.700508422187385*^9, 
   3.700508438386527*^9}},ExpressionUUID->"48c4036d-2775-41d2-af5f-\
9b70519e0986"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Directory Chooser\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.70023821099608*^9, 
  3.7002382136823683`*^9}},ExpressionUUID->"b335c43f-9a4f-4d27-ace7-\
46e932547b6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DirectoryChooser", "[", 
   RowBox[{
    RowBox[{"lbl", ":", 
     RowBox[{"_Dynamic", "|", "Automatic"}], ":", "Automatic"}], ",", "\n", 
    "\t", 
    RowBox[{"dirs", ":", 
     RowBox[{"_List", "|", 
      RowBox[{"_String", "?", "DirectoryQ"}]}]}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"FileChooser", "[", 
   RowBox[{"lbl", ",", "dirs", ",", "\n", "\t\t", "ops", ",", "\n", "\t\t", 
    RowBox[{"Select", "->", "DirectoryQ"}]}], "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.700238205343602*^9, 3.700238224590131*^9}, {
  3.700238524655591*^9, 3.700238539895734*^9}, {3.700241950917162*^9, 
  3.700241953526237*^9}, {3.700242387134778*^9, 3.700242393591424*^9}, {
  3.700242493982703*^9, 
  3.700242509212275*^9}},ExpressionUUID->"de8c29a5-6193-4698-8e3a-\
bf7f1fc9ef0d"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PaneWindow\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.701362701961269*^9, 3.701362712849308*^9}, {
  3.701364047428193*^9, 
  3.701364047936844*^9}},ExpressionUUID->"2e2e1531-ca50-47cb-9f62-\
f6158dde898b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "PaneWindow", "]"}], "=", "\n", "\t", 
   RowBox[{
    RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", "\n", "\t\t", 
    RowBox[{"Join", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Appearance", "\[Rule]", "\"\<Palette\>\""}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"WindowTitle", "\[Rule]", "\"\<\>\""}], ",", "\n", "\t\t\t\t", 
        RowBox[{"CloseButton", "\[Rule]", "Automatic"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"ButtonBar", "\[Rule]", 
         RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t\t", 
        RowBox[{"Background", "\[Rule]", "White"}], ",", "\n", "\t\t\t\t", 
        RowBox[{"FrameStyle", "->", 
         RowBox[{"GrayLevel", "[", ".7", "]"}]}]}], "\n", "\t\t\t\t", "}"}], 
      ",", "\n", "\t\t\t", 
      RowBox[{"Options", "@", "Pane"}]}], "\n", "\t", "\t\t", "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PaneWindow", "[", 
    RowBox[{"content_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"topSizeSym", "=", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "ImageSize", "]"}], "===", "Dynamic"}],
           ",", "\n", "\t\t\t\t", 
          RowBox[{"Unique", "@", "paneWindowTitleBarSize"}]}], "\n", 
         "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"paneSizeSym", "=", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "ImageSize", "]"}], "===", "Dynamic"}],
           ",", "\n", "\t\t\t\t", 
          RowBox[{"Unique", "@", "paneWindowSize"}]}], "\n", "\t\t\t\t", 
         "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"t", "=", 
          RowBox[{"OptionValue", "[", "WindowTitle", "]"}]}], ",", "\n", "\t",
          "\t\t", 
         RowBox[{"timgSize", "=", "\n", "\t", "\t\t\t", 
          RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t", 
           RowBox[{
            RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", 
            RowBox[{"{", "\n", "\t", "\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a_", ",", "_"}], "}"}], ":>", "\n", "\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MatchQ", "[", 
                  RowBox[{"a", ",", "_Dynamic"}], "]"}], ",", "\n", 
                 "\t\t\t\t\t\t\t", "a", ",", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "Automatic"}], "}"}]}], "\n", 
                "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{"Automatic", "->", "\n", "\t\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"400", ",", "Automatic"}], "}"}]}], ",", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"Dynamic", ":>", "\n", "\t\t\t\t\t\t", 
               RowBox[{"(", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"topSizeSym", "=", 
                  RowBox[{"{", 
                   RowBox[{"400", ",", "Automatic"}], "}"}]}], ";", "\n", 
                 "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Dynamic", "[", "topSizeSym", "]"}]}], "\n", "\t", 
                "\t\t\t\t\t\t", ")"}]}]}], "\n", "\t", "\t\t\t\t", "}"}]}], 
           "]"}]}], ",", "\n", "\t", "\t\t", 
         RowBox[{"imgSize", "=", "\n", "\t", "\t\t\t", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", 
            RowBox[{"{", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"_", ",", "b_Dynamic"}], "}"}], ":>", "\n", 
               "\t\t\t\t\t\t", "b"}], ",", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"a_", "?", "NumericQ"}], ",", "b_"}], "}"}], ":>", 
               "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"a", "-", "5"}], ",", "b"}], "}"}]}], ",", "\n", 
              "\t", "\t\t\t\t", 
              RowBox[{"Automatic", "->", "\n", "\t", "\t\t\t\t\t", 
               RowBox[{"{", 
                RowBox[{"400", ",", 
                 RowBox[{"400", "/", "GoldenRatio"}]}], "}"}]}], ",", "\n", 
              "\t\t\t\t\t", 
              RowBox[{"Dynamic", ":>", "\n", "\t\t\t\t\t\t", 
               RowBox[{"(", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"paneSizeSym", "=", 
                  RowBox[{"{", 
                   RowBox[{"400", ",", 
                    RowBox[{"400", "/", "GoldenRatio"}]}], "}"}]}], ";", "\n",
                  "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Dynamic", "[", 
                  RowBox[{"paneSizeSym", ",", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"topSizeSym", ",", "paneSizeSym"}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "Automatic"}], "}"}],
                     ",", "#"}], "}"}]}], ";"}], "&"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                ")"}]}]}], "\n", "\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", 
         "\t", "\t\t", 
         RowBox[{"closeButton", "=", "\n", "\t", "\t\t\t", 
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "CloseButton", "]"}], ",", 
             RowBox[{"False", "|", "None"}]}], "]"}]}]}]}], "\n", "\t", 
        "\t\t", "}"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"GradientPanel", "[", "\n", "\t", "\t\t\t", 
        RowBox[{
         RowBox[{"Pane", "[", "\n", "\t", "\t", "\t\t\t", 
          RowBox[{
           RowBox[{"Column", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"GradientPanel", "[", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{"closeButton", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"Grid", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Spacer", "[", "5", "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "CloseButton", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "CloseButton", "]"}], ",", 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "Automatic", "\[Rule]", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"PanelBox", ",", "2"}], "}"}]}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "t", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "ButtonBar"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", ":", 
                    RowBox[{"{", "__RuleDelayed", "}"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "@", "r"}], ">", "1"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "GradientButtonBar", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"r", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"OptionValue", "@", "Appearance"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FrameMargins", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"5", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"GradientButton", "[", 
                    RowBox[{
                    RowBox[{"First", "@", 
                    RowBox[{"First", "@", "r"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Last", "@", 
                    RowBox[{"Last", "@", "r"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Appearance", "\[Rule]", 
                    RowBox[{"Flatten", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"OptionValue", "@", "Appearance"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FrameMargins", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"5", ",", "5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", "\[Rule]", "\"\<\>\""}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ItemSize", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Scaled", "[", ".3", "]"}], ",", 
                    RowBox[{"Scaled", "[", ".4", "]"}], ",", 
                    RowBox[{"Scaled", "[", ".3", "]"}]}], "}"}], "}"}]}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Alignment", "\[Rule]", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"Left", ",", "Center", ",", "Right"}], "}"}], ",",
                     "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "Center", "}"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t\t", "t"}], "\n", "\t", "\t\t\t\t\t\t\t", 
                  "]"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Alignment", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                   "closeButton", ",", "\n", "\t", "\t\t\t\t\t\t\t\t", "Left",
                     ",", "\n", "\t", "\t\t\t\t\t\t\t\t", "Center"}], "\n", 
                   "\t", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"ImageSize", "\[Rule]", "timgSize"}], ",", "\n", 
                 "\t\t\t\t\t\t\t", 
                 RowBox[{"Appearance", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"OptionValue", "[", "Appearance", "]"}], ",", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImagePadding", "\[Rule]", "0"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", "}"}]}]}], ",", "\n", "\t", "\t", 
                 "\t\t\t\t\t", 
                 RowBox[{"ImageMargins", "\[Rule]", "None"}]}], "\n", "\t", 
                "\t", "\t\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t\t\t\t", 
               
               RowBox[{"Framed", "[", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Pane", "[", 
                  RowBox[{"content", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"FilterRules", "[", 
                    RowBox[{
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ImageSize", "\[Rule]", "imgSize"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t", "ops"}], "}"}], ",", "\n", "\t",
                     "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Options", "@", "Pane"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t\t\t",
                   "]"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                 "Background", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{"OptionValue", "[", "Background", "]"}]}], ",", 
                 "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{
                 "FrameStyle", "\[Rule]", "\n", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{"OptionValue", "[", "FrameStyle", "]"}]}], ",", 
                 "\n", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"FrameMargins", "\[Rule]", "None"}]}], "\n", "\t", 
                "\t", "\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t\t\t", "}"}], 
             ",", "\n", "\t", "\t\t\t\t\t", 
             RowBox[{"Alignment", "\[Rule]", "Center"}], ",", "\n", "\t", 
             "\t\t\t\t\t", 
             RowBox[{"ItemSize", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"All", ",", "Automatic"}], "}"}]}], ",", "\n", "\t", 
             "\t", "\t\t\t\t", 
             RowBox[{"Spacings", "\[Rule]", "0"}]}], "\n", "\t", "\t", 
            "\t\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t\t\t", "All"}], "\n",
           "\t", "\t", "\t\t\t", "]"}], ",", "\n", "\t", "\t", "\t\t", 
         RowBox[{"Appearance", "\[Rule]", 
          RowBox[{"{", "\n", "\t\t\t\t\t", 
           RowBox[{"ImageAdjust", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", ".05"}], ",", 
              RowBox[{"-", ".01"}]}], "}"}]}], "\n", "\t", "\t", "\t\t\t", 
           "}"}]}], ",", "\n", "\t", "\t", "\t\t", 
         RowBox[{"FrameMargins", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", 
              RowBox[{"-", "2"}]}], "}"}]}], "}"}]}]}], "\n", "\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.701362732387103*^9, 3.70136281492756*^9}, {
   3.701363012061655*^9, 3.70136301962675*^9}, {3.701363901505155*^9, 
   3.701364051720441*^9}, {3.701364082495968*^9, 3.701364228637684*^9}, 
   3.7013647355262527`*^9, {3.701364912860909*^9, 3.701365328404332*^9}, {
   3.701365677309346*^9, 3.701365718477211*^9}, {3.701365784277864*^9, 
   3.701365930629825*^9}, {3.7013661798268337`*^9, 3.701366180929195*^9}, {
   3.701366236442749*^9, 3.701366262642271*^9}, {3.7013663812439203`*^9, 
   3.701366386672387*^9}, 3.7013664207384663`*^9, {3.701366463240961*^9, 
   3.701366494775647*^9}, {3.701366745360219*^9, 3.7013667496845217`*^9}, {
   3.701367488473839*^9, 3.701367508849522*^9}, {3.701367581537632*^9, 
   3.701367591147648*^9}, {3.7013676324783697`*^9, 3.701367680214164*^9}, {
   3.701367777800826*^9, 3.701367789957038*^9}, {3.70137091128202*^9, 
   3.7013709623957367`*^9}, {3.701371013285873*^9, 3.7013710420764513`*^9}, {
   3.701371085845829*^9, 3.7013711038955317`*^9}, {3.701371629735093*^9, 
   3.701371723979061*^9}, {3.701371756556575*^9, 3.701371787954565*^9}, {
   3.701371839179922*^9, 3.7013719120437727`*^9}, {3.7013719996473427`*^9, 
   3.701372037786181*^9}, {3.701372083432246*^9, 3.701372085962319*^9}, {
   3.701372268824808*^9, 3.70137227033355*^9}, {3.7013723119392653`*^9, 
   3.701372333503128*^9}, {3.701372485924479*^9, 3.701372490186316*^9}, {
   3.701373731751272*^9, 3.701373790681816*^9}, {3.701374856994772*^9, 
   3.701374946996369*^9}, {3.701375273464879*^9, 3.701375282560062*^9}, {
   3.701375316541099*^9, 3.70137534172976*^9}, {3.701375464393532*^9, 
   3.701375504160945*^9}, {3.701375667370348*^9, 3.7013757082148123`*^9}, {
   3.7013757396998777`*^9, 3.7013757661013317`*^9}, {3.7013758040083113`*^9, 
   3.701375818732024*^9}},ExpressionUUID->"b8a0e96a-1dfb-4e2d-bd03-\
6fcde0aaaf98"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]closeButtonObjectFind\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.701370081157916*^9, 3.7013700973352613`*^9}, {
   3.70137012999164*^9, 3.7013701641402693`*^9}, 
   3.7013702640145206`*^9},ExpressionUUID->"5a9e623e-dd8e-4011-97f6-\
5cb7a9ce07b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"closeButtonObjectFind", "//", "Clear"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", "Automatic", "]"}], ":=", "\n", "\t", 
   RowBox[{"ParentBox", "@", 
    RowBox[{"EvaluationBox", "[", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", "EvaluationBox", "]"}], ":=", "\n", 
   "\t\t", 
   RowBox[{"EvaluationBox", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", "All", "]"}], ":=", "\n", "\t\t", 
   RowBox[{"NestWhile", "[", 
    RowBox[{"ParentBox", ",", "\n", "\t\t\t", 
     RowBox[{"EvaluationBox", "[", "]"}], ",", "\n", "\t\t\t", 
     RowBox[{"MatchQ", "[", "_BoxObject", "]"}], ",", "\n", "\t\t\t", "1", 
     ",", "\n", "\t\t\t", "\[Infinity]", ",", "\n", "\t\t\t", 
     RowBox[{"-", "1"}]}], "\n", "\t\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", 
    RowBox[{"{", 
     RowBox[{"ParentBox", ",", 
      RowBox[{"n_Integer", "?", "Positive"}]}], "}"}], "]"}], ":>", "\n", 
   "\t\t", 
   RowBox[{"Nest", "[", 
    RowBox[{"ParentBox", ",", 
     RowBox[{"EvaluationBox", "[", "]"}], ",", "n"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", 
    RowBox[{"{", 
     RowBox[{"ParentBox", ",", 
      RowBox[{"n_Integer", "?", 
       RowBox[{"(", 
        RowBox[{"Not", "@*", "Positive"}], ")"}]}]}], "}"}], "]"}], ":=", 
   "\n", "\t\t", 
   RowBox[{"NestWhile", "[", 
    RowBox[{"ParentBox", ",", "\n", "\t\t\t", 
     RowBox[{"EvaluationBox", "[", "]"}], ",", "\n", "\t\t\t", 
     RowBox[{"MatchQ", "[", "_BoxObject", "]"}], ",", "\n", "\t\t\t", "1", 
     ",", "\n", "\t\t\t", "\[Infinity]", ",", "\n", "\t\t\t", 
     RowBox[{"(", 
      RowBox[{"n", "-", "1"}], ")"}]}], "\n", "\t\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", "EvaluationCell", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"EvaluationCell", "[", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", 
    RowBox[{"c", ":", 
     RowBox[{"ParentCell", "|", "NextCell", "|", "PreviousCell"}]}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"c", "@", 
    RowBox[{"EvaluationCell", "[", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c", ":", 
       RowBox[{"(", 
        RowBox[{"ParentCell", "|", "NextCell", "|", "PreviousCell"}], ")"}]}],
       ",", "n_"}], "}"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Nest", "[", 
    RowBox[{"c", ",", "\n", "\t\t", 
     RowBox[{"EvaluationCell", "[", "]"}], ",", "\n", "\t\t", "n"}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", "boxType_Symbol", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"NestWhile", "[", 
    RowBox[{"ParentBox", ",", "\n", "\t\t", 
     RowBox[{"EvaluationBox", "[", "]"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"#", ",", "_BoxObject"}], "]"}], "&&", "\n", "\t\t", 
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"NotebookRead", "[", "#", "]"}], ",", "\n", "\t\t\t", 
          RowBox[{"Blank", "[", "boxType", "]"}]}], "\n", "\t\t\t", "]"}]}]}],
       "&"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", 
    RowBox[{"{", 
     RowBox[{"boxType_Symbol", ",", "n_"}], "}"}], "]"}], ":=", "\n", "\t\t", 
   
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"boxTypeCounter", "=", "0"}], "}"}], ",", "\n", "\t\t\t", 
     RowBox[{"NestWhile", "[", 
      RowBox[{"ParentBox", ",", "\n", "\t\t\t\t", 
       RowBox[{"EvaluationBox", "[", "]"}], ",", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#", ",", "_BoxObject"}], "]"}], "&&", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"NotebookRead", "[", "#", "]"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"Blank", "[", "boxType", "]"}]}], "\n", "\t\t\t\t\t\t", 
            "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"boxTypeCounter", "++"}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{"boxTypeCounter", "<", "n"}]}], ",", "\n", "\t\t\t\t\t", 
           "True"}], "\n", "\t\t\t\t\t", "]"}]}], "&"}]}], "\n", "\t\t\t\t", 
      "]"}]}], "\n", "\t\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", "f_Function", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"NestWhile", "[", 
    RowBox[{"ParentBox", ",", "\n", "\t\t", 
     RowBox[{"EvaluationBox", "[", "]"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"#", ",", "_BoxObject"}], "]"}], "&&", "\n", "\t\t", 
       RowBox[{"Not", "@", 
        RowBox[{"f", "[", "#", "]"}]}]}], "&"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", 
    RowBox[{"{", 
     RowBox[{"f_Function", ",", "n_"}], "}"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"boxTypeCounter", "=", "0"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"NestWhile", "[", 
      RowBox[{"ParentBox", ",", "\n", "\t\t\t", 
       RowBox[{"EvaluationBox", "[", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#", ",", "_BoxObject"}], "]"}], "&&", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"f", "[", "#", "]"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"boxTypeCounter", "++"}], ";", "\n", "\t\t\t\t", 
            RowBox[{"boxTypeCounter", "<", "n"}]}], ",", "\n", "\t\t\t\t", 
           "True"}], "\n", "\t\t\t\t", "]"}]}], "&"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", 
    RowBox[{"b", ":", 
     RowBox[{"Except", "[", "_List", "]"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"NestWhile", "[", 
    RowBox[{"ParentBox", ",", "\n", "\t\t", 
     RowBox[{"EvaluationBox", "[", "]"}], ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"#", ",", "_BoxObject"}], "]"}], "&&", "\n", "\t\t", 
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"NotebookRead", "[", "#", "]"}], ",", "\n", "\t\t\t", "b"}],
          "\n", "\t\t\t", "]"}]}]}], "&"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"closeButtonObjectFind", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"b", ":", 
       RowBox[{"Except", "[", "_List", "]"}]}], ",", "n_"}], "}"}], "]"}], ":=",
    "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"boxTypeCounter", "=", "0"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"NestWhile", "[", 
      RowBox[{"ParentBox", ",", "\n", "\t\t\t", 
       RowBox[{"EvaluationBox", "[", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"#", ",", "_BoxObject"}], "]"}], "&&", "\n", "\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"NotebookRead", "[", "#", "]"}], ",", "b"}], "]"}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"boxTypeCounter", "++"}], ";", "\n", "\t\t\t\t", 
            RowBox[{"boxTypeCounter", "<", "n"}]}], ",", "\n", "\t\t\t\t", 
           "True"}], "\n", "\t\t\t\t", "]"}]}], "&"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7013701028974524`*^9, 3.70137012713132*^9}, {
  3.70137024438654*^9, 3.701370444106148*^9}, {3.701370507663207*^9, 
  3.701370590109805*^9}, {3.70137065776965*^9, 3.701370663445228*^9}, {
  3.7013707919429607`*^9, 3.7013708625231543`*^9}, {3.7013708932114983`*^9, 
  3.7013708935287733`*^9}},ExpressionUUID->"40a53414-84ab-4c03-a918-\
10190b3dacff"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]CloseButton\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.701365606718552*^9, 
  3.701365608286709*^9}},ExpressionUUID->"048c868e-60a9-4536-b281-\
1ccba73de7ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CloseButton", "[", 
   RowBox[{"box_:", "Automatic"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Button", "[", 
   RowBox[{"\"\<\>\"", ",", "\n", "\t\t", 
    RowBox[{"NotebookDelete", "@", 
     RowBox[{"closeButtonObjectFind", "[", "box", "]"}]}], ",", "\n", "\t\t", 
    
    RowBox[{"ImageSize", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"14", ",", "14"}], "}"}]}], ",", "\n", "\t", "\t", 
    RowBox[{"Appearance", "\[Rule]", 
     RowBox[{"{", "\n", "\t", "\t\t", 
      RowBox[{
       RowBox[{"\"\<Default\>\"", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"ToExpression", "@", "\n", "\t\t\t\t\t", 
         RowBox[{"FrontEndResource", "[", 
          RowBox[{"\"\<FEBitmaps\>\"", ",", "\"\<CircleXIcon\>\""}], 
          "]"}]}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<Hover\>\"", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"ToExpression", "@", "\n", "\t\t\t\t\t", 
         RowBox[{"FrontEndResource", "[", 
          RowBox[{"\"\<FEBitmaps\>\"", ",", "\"\<CircleXIconHighlight\>\""}], 
          "]"}]}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{"\"\<Pressed\>\"", "\[Rule]", "\n", "\t\t\t\t", 
        RowBox[{"ToExpression", "@", "\n", "\t\t\t\t\t", 
         RowBox[{"FrontEndResource", "[", 
          RowBox[{"\"\<FEBitmaps\>\"", ",", "\"\<CircleXIconPressed\>\""}], 
          "]"}]}]}]}], "\n", "\t", "\t\t", "}"}]}]}], "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7013656104732513`*^9, 3.701365639013467*^9}, {
   3.701366299604046*^9, 3.701366354546062*^9}, {3.701366523828623*^9, 
   3.701366618910861*^9}, {3.701366652599616*^9, 3.701366723798311*^9}, {
   3.701366848702936*^9, 3.701366863108119*^9}, {3.701367029869377*^9, 
   3.7013670717421427`*^9}, {3.7013671737672453`*^9, 
   3.7013672110234013`*^9}, {3.701367284644149*^9, 3.701367343470337*^9}, {
   3.701367385310204*^9, 3.7013674196352787`*^9}, 3.70137007449019*^9, {
   3.70137047882285*^9, 
   3.7013704981229362`*^9}},ExpressionUUID->"ae24c434-d22a-4625-8bbb-\
ef1ec8bf9426"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]IButton\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.702682256075742*^9, 
  3.702682257434596*^9}},ExpressionUUID->"33b5cd37-6f0e-4752-9a69-\
ad52a71cbc32"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "IButton", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "Button", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"IButton", "[", 
   RowBox[{"lab_", ",", "\n", "\t", 
    RowBox[{"cmd", ":", 
     RowBox[{"Except", "[", 
      RowBox[{"_Rule", "|", "_RuleDelayed", "|", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}], ".."}], "}"}]}], 
      "]"}], ":", "Null"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Button", "[", 
   RowBox[{"lab", ",", "cmd", ",", "Null", ",", "\n", "\t\t", 
    RowBox[{"Appearance", "\[Rule]", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Default\>\"", "->", 
        GraphicsBox[
         TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRIz
UFAciAWBmAWI////TzF2qG+gJeYDYnMgdgNiYyDmJEGvCRBvBuKfQPwfCX8F
4mVArIZHLyMQ1wLxPzS96BhkdioOMxqw6cnLy/tfVVWFzaxENP2WuOy/evXq
/+/fv2Mz4wcQKyCZsQuX29va2v7PmTMHl7/mQPULA/EfXP6YNGkS2BwcZrwF
YmZo3GFVc/jw4f8gADIHTxiD4ikKl/yuXbvAZhCIJyt87rh37x44TAmYoQrE
QkD8G5s8CGzcuBFX3ILwa2h4gMJ1J7o8KAxAAOQfPOExGylurdHTB8hukF/w
xOt3IFZ2QE1nlQT8jY6jHbCnd1B++UtALyh9puDQD8P6QLzWAXu+nQ/ESgT0
I2NuINYFYicg1gZidhL0koypUZ4OFgwARdA9WQ==
           "], {{0, 23}, {17, 0}}, {
           0, 255},
           ColorFunction->RGBColor],
          BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
          
          Selectable->False],
         DefaultBaseStyle->"ImageGraphics",
         ImageSizeRaw->{17, 23},
         PlotRange->{{0, 17}, {0, 23}}]}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Hover\>\"", "->", 
        GraphicsBox[
         TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRIz
UFAciAWBmAWI////TznOYKAl5gNicyB2A2JjIOYkQa8JEG8G4p9A/B8JfwXi
ZUCshkcvIxDXAvE/NL3oGGR2Kg4zGrDqKVX5/7/BHptZiWj6LXHaf/3E///f
v2Iz4wcQKyCZsQun23tC/v9fWIHLX3Og+oWB+A9Of0xLh5iD3Yy3QMwMjTvs
ao5t+A8GIHNwhzEonqJwyu9dDDEDfzxZ4XXH/SuQMMVvhioQCwHxb6zyILBl
Gq64BeHX0PAAhetODHlQGIAAyD+4w2M2UtxaY6QPkN0gv+CO1+9ArPwfNZ1V
EvA3Oo7+jz29g/LLXwJ6QekzBYd+GNYH4rX/sefb+UCsREA/MuYGYl0gdgJi
bSBmJ0Ev6Zga5ekgwQD8UXC/
           "], {{0, 23}, {17, 0}}, {0, 255},
           ColorFunction->RGBColor],
          BoxForm`ImageTag[
          "Byte", ColorSpace -> "RGB", Interleaving -> True, MetaInformation -> 
           Association[
            "XMP" -> Association[
              "BasicSchema" -> 
               Association[
                "CreatorTool" -> "Adobe Photoshop CS6 (Macintosh)"], 
               "MediaManagementSchema" -> 
               Association[
                "DerivedFrom" -> 
                 Association[
                  "DerivedFrom" -> 
                   Association[
                    "InstanceID" -> 
                    "xmp.iid:0780117407206811808380FD6B980A1F", "DocumentID" -> 
                    "xmp.did:0E14DB05E12068118A6D8005FF0E4143"]], 
                 "DocumentID" -> "xmp.did:79239F79A90711E2A242D6641682FEA7", 
                 "InstanceID" -> "xmp.iid:79239F78A90711E2A242D6641682FEA7", 
                 "OriginalDocumentID" -> 
                 "xmp.did:0E14DB05E12068118A6D8005FF0E4143"], 
               "RightsManagementSchema" -> 
               Association[
                "DerivedFrom" -> 
                 Association[
                  "DerivedFrom" -> 
                   Association[
                    "InstanceID" -> 
                    "xmp.iid:0780117407206811808380FD6B980A1F", "DocumentID" -> 
                    "xmp.did:0E14DB05E12068118A6D8005FF0E4143"]]], 
               "PagedTextSchema" -> 
               Association[
                "DerivedFrom" -> 
                 Association[
                  "DerivedFrom" -> 
                   Association[
                    "InstanceID" -> 
                    "xmp.iid:0780117407206811808380FD6B980A1F", "DocumentID" -> 
                    "xmp.did:0E14DB05E12068118A6D8005FF0E4143"]]]], 
             "Comments" -> 
             Association[
              "Software" -> "Adobe ImageReady", "XML:com.adobe.xmp" -> 
               "<?xpacket begin=\:feff id=W5M0MpCehiHzreSzNTczkc9d?> \
<x:xmpmeta xmlns:x=adobe:ns:meta/ x:xmptk=Adobe XMP Core 5.3-c011 66.145661, \
2012/02/06-14:56:27> <rdf:RDF \
xmlns:rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns#> <rdf:Description \
rdf:about= xmlns:xmpMM=http://ns.adobe.com/xap/1.0/mm/ \
xmlns:stRef=http://ns.adobe.com/xap/1.0/sType/ResourceRef# \
xmlns:xmp=http://ns.adobe.com/xap/1.0/ \
xmpMM:OriginalDocumentID=xmp.did:0E14DB05E12068118A6D8005FF0E4143 \
xmpMM:DocumentID=xmp.did:79239F79A90711E2A242D6641682FEA7 \
xmpMM:InstanceID=xmp.iid:79239F78A90711E2A242D6641682FEA7 \
xmp:CreatorTool=Adobe Photoshop CS6 (Macintosh)> <xmpMM:DerivedFrom \
stRef:instanceID=xmp.iid:0780117407206811808380FD6B980A1F \
stRef:documentID=xmp.did:0E14DB05E12068118A6D8005FF0E4143/> \
</rdf:Description> </rdf:RDF> </x:xmpmeta> <?xpacket end=r?>"]]],
          Selectable->False],
         DefaultBaseStyle->"ImageGraphics",
         ImageSizeRaw->{17, 23},
         PlotRange->{{0, 17}, {0, 23}}]}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Pressed\>\"", "->", 
        GraphicsBox[
         TagBox[RasterBox[CompressedData["
1:eJxTTMoPSmNiYGAo5gASQYnljkVFiZXBAkBOaF5xZnpeaopnXklqemqRRRIz
UFAciAWBmAWI////TzFOSEigJeYDYnMgdgNiYyDmJEGvCRBvBuKfQPwfCX8F
4mVArIZHLyMQ1wLxPzS96BhkdioOMxqw6cnLy/tfVVWFzaxENP2WuOy/evXq
/+/fv2Mz4wcQKyCZsQuX29va2v7PmTMHl7/mQPULA/EfXP6YNGkS2BwcZrwF
YuYESNxhVXP48OH/IAAyB08Yg+IpCpf8rl27wGYQiCcrfO64d+8eOEwJmKEK
xEJA/BubPAhs3LgRV9yC8GtoeIDCdSe6PCgMQADkHzzhMRspbq3R0wfIbpBf
8MTrdyBWTkBNZ5UE/I2OoxOwp3dQfvlLQC8ofabg0A/D+kC8NgF7vp0PxEoE
9CNjbiDWBWInINYGYnYS9JKMqVGeDhYMAAUuGWI=
           "], {{0, 23}, {17, 0}}, {
           0, 255},
           ColorFunction->RGBColor],
          BoxForm`ImageTag[
          "Byte", ColorSpace -> "RGB", Interleaving -> True, MetaInformation -> 
           Association[
            "XMP" -> Association[
              "BasicSchema" -> 
               Association[
                "CreatorTool" -> "Adobe Photoshop CS6 (Macintosh)"], 
               "MediaManagementSchema" -> 
               Association[
                "DerivedFrom" -> 
                 Association[
                  "DerivedFrom" -> 
                   Association[
                    "InstanceID" -> 
                    "xmp.iid:0780117407206811808380FD6B980A1F", "DocumentID" -> 
                    "xmp.did:0E14DB05E12068118A6D8005FF0E4143"]], 
                 "DocumentID" -> "xmp.did:9DFCAC12A90711E2A242D6641682FEA7", 
                 "InstanceID" -> "xmp.iid:9DFCAC11A90711E2A242D6641682FEA7", 
                 "OriginalDocumentID" -> 
                 "xmp.did:0E14DB05E12068118A6D8005FF0E4143"], 
               "RightsManagementSchema" -> 
               Association[
                "DerivedFrom" -> 
                 Association[
                  "DerivedFrom" -> 
                   Association[
                    "InstanceID" -> 
                    "xmp.iid:0780117407206811808380FD6B980A1F", "DocumentID" -> 
                    "xmp.did:0E14DB05E12068118A6D8005FF0E4143"]]], 
               "PagedTextSchema" -> 
               Association[
                "DerivedFrom" -> 
                 Association[
                  "DerivedFrom" -> 
                   Association[
                    "InstanceID" -> 
                    "xmp.iid:0780117407206811808380FD6B980A1F", "DocumentID" -> 
                    "xmp.did:0E14DB05E12068118A6D8005FF0E4143"]]]], 
             "Comments" -> 
             Association[
              "Software" -> "Adobe ImageReady", "XML:com.adobe.xmp" -> 
               "<?xpacket begin=\:feff id=W5M0MpCehiHzreSzNTczkc9d?> \
<x:xmpmeta xmlns:x=adobe:ns:meta/ x:xmptk=Adobe XMP Core 5.3-c011 66.145661, \
2012/02/06-14:56:27> <rdf:RDF \
xmlns:rdf=http://www.w3.org/1999/02/22-rdf-syntax-ns#> <rdf:Description \
rdf:about= xmlns:xmpMM=http://ns.adobe.com/xap/1.0/mm/ \
xmlns:stRef=http://ns.adobe.com/xap/1.0/sType/ResourceRef# \
xmlns:xmp=http://ns.adobe.com/xap/1.0/ \
xmpMM:OriginalDocumentID=xmp.did:0E14DB05E12068118A6D8005FF0E4143 \
xmpMM:DocumentID=xmp.did:9DFCAC12A90711E2A242D6641682FEA7 \
xmpMM:InstanceID=xmp.iid:9DFCAC11A90711E2A242D6641682FEA7 \
xmp:CreatorTool=Adobe Photoshop CS6 (Macintosh)> <xmpMM:DerivedFrom \
stRef:instanceID=xmp.iid:0780117407206811808380FD6B980A1F \
stRef:documentID=xmp.did:0E14DB05E12068118A6D8005FF0E4143/> \
</rdf:Description> </rdf:RDF> </x:xmpmeta> <?xpacket end=r?>"]]],
          Selectable->False],
         DefaultBaseStyle->"ImageGraphics",
         ImageSizeRaw->{17, 23},
         PlotRange->{{0, 17}, {0, 23}}]}]}], "\n", "\t\t\t", "}"}]}], ",", 
    "\n", "\t\t", "ops"}], "\n", "\t\t", "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7026822598551073`*^9, 3.702682331166497*^9}, {
  3.702682371738077*^9, 
  3.702682382144343*^9}},ExpressionUUID->"30fd3054-aff1-4793-a95b-\
bc5ae8b05fc9"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]DragPaneDynamicModule\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.729096664920339*^9, 3.7290966661837482`*^9}, {
  3.72909670660717*^9, 
  3.729096708703224*^9}},ExpressionUUID->"88ad65a9-40d6-477b-b59a-\
8a2a4ac71c88"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DragPaneDynamicModule", "]"}], " ", "=", "\n", 
   "  ", 
   RowBox[{"Join", "[", "\n", "   ", 
    RowBox[{
     RowBox[{"Options", "[", "Pane", "]"}], ",", "\n", "   ", 
     RowBox[{"{", "\n", "    ", 
      RowBox[{
       RowBox[{"AutoAction", " ", "->", " ", "False"}], ",", "\n", "    ", 
       RowBox[{"\"\<Modifiers\>\"", " ", "\[Rule]", " ", "None"}]}], "\n", 
      "    ", "}"}]}], "\n", "   ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DragPaneDynamicModule", "[", "\n", "   ", 
    RowBox[{"exp_", ",", "\n", "   ", 
     RowBox[{"{", 
      RowBox[{"width_", ",", " ", "height_"}], "}"}], ",", "\n", "   ", 
     RowBox[{"ops", " ", ":", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "   ", "]"}], " ", ":=",
    "\n", "  ", 
   RowBox[{"With", "[", "\n", "   ", 
    RowBox[{
     RowBox[{"{", "\n", "    ", 
      RowBox[{
       RowBox[{"boxSize", " ", "=", "\n", "     ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{"3", " ", "+", " ", 
             RowBox[{"Total", "@", 
              RowBox[{"#", "[", 
               RowBox[{"[", 
                RowBox[{"2", " ", ";;"}], "]"}], "]"}]}]}]}], "}"}], " ", 
          "&"}], "@", 
         RowBox[{"First", "@", "\n", "       ", 
          RowBox[{"FrontEndExecute", "@", "\n", "        ", 
           RowBox[{"GetBoundingBoxSizePacket", "[", "\n", "         ", 
            RowBox[{"Cell", "[", 
             RowBox[{
              RowBox[{"BoxData", "[", 
               RowBox[{"ToBoxes", "[", "exp", "]"}], "]"}], ",", "\n", 
              "          ", "\"\<Output\>\"", ",", "\n", "          ", 
              RowBox[{"PageWidth", " ", "->", " ", "\[Infinity]"}], ",", "\n",
               "          ", 
              RowBox[{"ShowCellBracket", " ", "->", " ", "False"}], ",", "\n",
               "           ", 
              RowBox[{"CellMargins", " ", "->", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "0"}], "}"}]}], "}"}]}]}], "\n", 
             "          ", "]"}], "\n", "         ", "]"}]}]}]}]}], ",", "\n",
        "     ", 
       RowBox[{"mkeys", " ", "=", " ", "\n", "    \t ", 
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"Flatten", "@", 
           RowBox[{"List", "@", 
            RowBox[{"OptionValue", "[", "\"\<Modifiers\>\"", "]"}]}]}], ",", 
          " ", "\n", "    \t \t", 
          RowBox[{
          "\"\<Shift\>\"", "|", "\"\<Control\>\"", "|", "\"\<Alt\>\"", "|", 
           "\"\<Command\>\""}]}], "\n", "    \t \t", "]"}]}]}], "\n", "    ", 
      "}"}], ",", "\n", "   ", 
     RowBox[{"DynamicModule", "[", "\n", "    ", 
      RowBox[{
       RowBox[{"{", "\n", "     ", 
        RowBox[{
         RowBox[{"scrollX", " ", "=", " ", "0."}], ",", " ", 
         RowBox[{"scrollY", " ", "=", " ", "0."}], ",", "\n", "     ", 
         RowBox[{"maxWidth", " ", "=", "\n", "      ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", " ", 
             RowBox[{"NumericQ", "@", "width"}]}], ",", "\n", "       ", 
            RowBox[{"boxSize", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\n", "       ", 
            RowBox[{"Max", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"boxSize", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", "width"}], 
              "}"}]}]}], "\n", "       ", "]"}]}], ",", "\n", "     ", 
         RowBox[{"boxWidth", " ", "=", "\n", "      ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", " ", 
             RowBox[{"NumericQ", "@", "width"}]}], ",", " ", 
            RowBox[{"Min", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"boxSize", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", "360"}], "}"}]}], 
            " ", ",", " ", "width"}], "]"}]}], ",", "\n", "      ", 
         RowBox[{"maxHeight", " ", "=", "\n", "      ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", " ", 
             RowBox[{"NumericQ", "@", "height"}]}], ",", "\n", "       ", 
            RowBox[{"boxSize", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "\n", "       ", 
            RowBox[{"Max", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"boxSize", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", "height"}], 
              "}"}]}]}], "\n", "       ", "]"}]}], ",", "\n", "     ", 
         RowBox[{"boxHeight", " ", "=", "\n", "      ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", " ", 
             RowBox[{"NumericQ", "@", "height"}]}], ",", " ", 
            RowBox[{"Min", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"boxSize", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", " ", "360"}], "}"}]}], 
            " ", ",", " ", "height"}], "]"}]}], ",", "\n", "     ", 
         "setXScroll", ",", "\n", "     ", "setYScroll", ",", "\n", "     ", 
         "getXScroll", ",", "\n", "     ", "getYScroll", ",", "\n", "     ", 
         RowBox[{"scrolling", " ", "=", " ", "False"}], ",", "\n", "     ", 
         "refWidth", ",", " ", "refX", ",", "\n", "     ", "refHeight", ",", 
         " ", "refY", ",", "\n", "     ", "applyEvent", ",", "\n", "     ", 
         RowBox[{"mods", " ", "=", " ", "mkeys"}]}], "\n", "     ", "}"}], 
       ",", "\n", "    ", 
       RowBox[{"Pane", "[", "\n", "     ", 
        RowBox[{
         RowBox[{
          RowBox[{"EventHandler", "[", "\n", "       ", 
           RowBox[{
            RowBox[{"Pane", "[", "\n", "        ", 
             RowBox[{
              RowBox[{"Pane", "[", 
               RowBox[{"exp", ",", " ", 
                RowBox[{"2", "*", "boxSize"}], ",", " ", 
                RowBox[{"Alignment", " ", "->", " ", 
                 RowBox[{"{", 
                  RowBox[{"Left", ",", " ", "Top"}], "}"}]}]}], "]"}], ",", 
              "\n", "        ", "Full", ",", "\n", "        ", 
              RowBox[{"ScrollPosition", " ", "->", "\n", "         ", 
               RowBox[{"Dynamic", "[", "\n", "          ", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"TrueQ", "[", "scrolling", "]"}], ",", "\n", 
                   "           ", 
                   RowBox[{"{", "\n", "            ", 
                    RowBox[{
                    RowBox[{"setXScroll", "[", "]"}], ",", "\n", 
                    "            ", 
                    RowBox[{"setYScroll", "[", "]"}]}], "\n", "            ", 
                    "}"}], ",", "\n", "           ", 
                   RowBox[{"{", 
                    RowBox[{"scrollX", ",", " ", "scrollY"}], "}"}]}], "\n", 
                  "           ", "]"}], ",", "\n", "          ", 
                 RowBox[{"Function", "[", "\n", "           ", 
                  RowBox[{
                   RowBox[{"scrollX", " ", "=", "\n", "            ", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", " ", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"maxWidth", " ", "-", " ", "boxWidth"}], ",", " ",
                     "0."}], "}"}]}]}], "}"}]}], "]"}]}], ";", "\n", 
                   "           ", 
                   RowBox[{"scrollY", " ", "=", "\n", "            ", 
                    RowBox[{"Clip", "[", 
                    RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"{", 
                    RowBox[{"0.", ",", " ", 
                    RowBox[{"Max", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"maxHeight", " ", "-", " ", "boxHeight"}], ",", 
                    " ", "0."}], "}"}]}]}], "}"}]}], "]"}]}], ";"}], "\n", 
                  "           ", "]"}], ",", "\n", "          ", 
                 RowBox[{"TrackedSymbols", " ", ":>", " ", 
                  RowBox[{"{", 
                   RowBox[{"scrollX", ",", " ", "scrollY"}], "}"}]}]}], "\n", 
                "          ", "]"}]}], ",", "\n", "         ", 
              RowBox[{"Alignment", " ", "->", " ", 
               RowBox[{"{", 
                RowBox[{"Left", ",", " ", "Top"}], "}"}]}]}], "\n", 
             "        ", "]"}], ",", "\n", "       ", 
            RowBox[{"{", "\n", "        ", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"TrueQ", "@", 
                  RowBox[{"OptionValue", "[", "AutoAction", "]"}]}], ",", 
                 "\n", "          ", "\"\<MouseEntered\>\"", ",", "\n", 
                 "          ", "\"\<MouseDown\>\""}], "\n", "          ", 
                "]"}], " ", ":>", "\n", "         ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"applyEvent", "[", "]"}], ",", "\n", "          ", 
                 RowBox[{
                  RowBox[{"refX", " ", "=", " ", "scrollX"}], ";", "\n", 
                  "          ", 
                  RowBox[{"refY", " ", "=", " ", "scrollY"}], ";", "\n", 
                  "          ", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"refWidth", ",", " ", "refHeight"}], "}"}], " ", 
                   "=", " ", 
                   RowBox[{
                   "MousePosition", "[", "\"\<ScreenAbsolute\>\"", "]"}]}], 
                  ";", "\n", "          ", 
                  RowBox[{"scrolling", " ", "=", " ", "True"}]}]}], "\n", 
                "          ", "]"}]}], ",", "\n", "        ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"TrueQ", "@", 
                  RowBox[{"OptionValue", "[", "AutoAction", "]"}]}], ",", 
                 "\n", "          ", "\"\<MouseMoved\>\"", ",", "\n", 
                 "          ", "\"\<MouseDragged\>\""}], "\n", "          ", 
                "]"}], " ", ":>", "\n", "         ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"applyEvent", "[", "]"}], ",", "\n", "          ", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"!", " ", 
                    RowBox[{"AllTrue", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"refWidth", ",", " ", "refHeight"}], "}"}], ",", 
                    " ", "NumericQ"}], "]"}]}], ",", "\n", "           ", 
                    RowBox[{
                    RowBox[{"refX", " ", "=", " ", "scrollX"}], ";", "\n", 
                    "           ", 
                    RowBox[{"refY", " ", "=", " ", "scrollY"}], ";", "\n", 
                    "           ", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"refWidth", ",", " ", "refHeight"}], "}"}], " ", 
                    "=", "\n", "          \t ", 
                    RowBox[{
                    "MousePosition", "[", "\"\<ScreenAbsolute\>\"", "]"}]}], 
                    ";", "\n", "           ", 
                    RowBox[{"scrolling", " ", "=", " ", "True"}]}]}], "\n", 
                   "           ", "]"}], ";", "\n", "          ", 
                  RowBox[{"setXScroll", "[", "]"}], ";"}]}], "\n", 
                "          ", "]"}]}], ",", "\n", "        ", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"TrueQ", "@", 
                  RowBox[{"OptionValue", "[", "AutoAction", "]"}]}], ",", 
                 "\n", "          ", "\"\<MouseExited\>\"", ",", "\n", 
                 "          ", "\"\<MouseUp\>\""}], "\n", "          ", "]"}],
                " ", ":>", "\n", "         ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"applyEvent", "[", "]"}], ",", "\n", "          ", 
                 RowBox[{
                  RowBox[{"scrolling", " ", "=", " ", "False"}], ";", "\n", 
                  "          ", 
                  RowBox[{"setXScroll", "[", "]"}], ";", "\n", "          ", 
                  RowBox[{"setYScroll", "[", "]"}], ";", "\n", "          ", 
                  RowBox[{"Clear", "[", 
                   RowBox[{
                   "refWidth", ",", " ", "refHeight", ",", " ", "refX", ",", 
                    " ", "refY"}], "]"}], ";"}]}], "\n", "          ", 
                "]"}]}], ",", "\n", "        ", 
              RowBox[{"PassEventsDown", "\[Rule]", 
               RowBox[{
                RowBox[{"Length", "@", "mods"}], ">", "0"}]}]}], "\n", 
             "        ", "}"}]}], "\n", "       ", "]"}], " ", "//", " ", 
          RowBox[{
           RowBox[{"MouseAppearance", "[", 
            RowBox[{"#", ",", " ", "\"\<PanView\>\""}], "]"}], " ", "&"}]}], 
         ",", "\n", "     ", 
         RowBox[{"FilterRules", "[", "\n", "      ", 
          RowBox[{
           RowBox[{"{", "\n", "       ", 
            RowBox[{
             RowBox[{"ImageSize", " ", "->", "\n", "        ", 
              RowBox[{"Dynamic", "[", 
               RowBox[{"{", 
                RowBox[{"boxWidth", ",", " ", "boxHeight"}], "}"}], "]"}]}], 
             ",", "\n", "       ", "ops"}], "\n", "       ", "}"}], ",", "\n",
            "      ", 
           RowBox[{"Options", "[", "Pane", "]"}]}], "\n", "      ", "]"}]}], 
        "\n", "     ", "]"}], ",", "\n", "    ", 
       RowBox[{"Initialization", " ", ":>", "\n", "     ", 
        RowBox[{"{", "\n", "      ", 
         RowBox[{
          RowBox[{
           RowBox[{"applyEvent", "[", "]"}], ":=", "\n", "       ", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "@", "mods"}], "==", "0"}], "||", "\n", 
            "\t       ", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{"mods", ",", " ", 
               RowBox[{"CurrentValue", "[", "\"\<ModifierKeys\>\"", "]"}]}], 
              "]"}], "\[Equal]", "mods"}]}]}], ",", "\n", "      ", 
          RowBox[{
           RowBox[{
            RowBox[{"getXScroll", "[", "x_", "]"}], " ", ":=", "\n", 
            "       ", 
            RowBox[{"Clip", "[", "\n", "        ", 
             RowBox[{
              RowBox[{"refX", " ", "+", " ", "refWidth", " ", "-", " ", "x"}],
               ",", "\n", "        ", 
              RowBox[{"{", 
               RowBox[{"0.", ",", " ", 
                RowBox[{"Max", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"maxWidth", " ", "-", " ", "boxWidth"}], ",", " ", 
                   "0."}], "}"}]}]}], "}"}]}], "\n", "        ", "]"}]}], ";",
            "\n", "      ", 
           RowBox[{
            RowBox[{"getXScroll", "[", "]"}], " ", ":=", "\n", "       ", 
            RowBox[{"getXScroll", "[", 
             RowBox[{"First", "@", 
              RowBox[{"MousePosition", "[", "\"\<ScreenAbsolute\>\"", "]"}]}],
              "]"}]}]}], ",", "\n", "      ", 
          RowBox[{
           RowBox[{"setXScroll", "[", "x___", "]"}], " ", ":=", "\n", 
           "       ", 
           RowBox[{"scrollX", " ", "=", " ", 
            RowBox[{"getXScroll", "[", "x", "]"}]}]}], ",", "\n", "      ", 
          RowBox[{
           RowBox[{
            RowBox[{"getYScroll", "[", "y_", "]"}], " ", ":=", "\n", 
            "       ", 
            RowBox[{"Clip", "[", "\n", "        ", 
             RowBox[{
              RowBox[{
              "refY", " ", "+", " ", "refHeight", " ", "-", " ", "y"}], ",", 
              "\n", "        ", 
              RowBox[{"{", 
               RowBox[{"0.", ",", " ", 
                RowBox[{"Max", "@", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"maxHeight", " ", "-", " ", "boxHeight"}], ",", 
                   " ", "0."}], "}"}]}]}], "}"}]}], "\n", "        ", "]"}]}],
            ";", "\n", "      ", 
           RowBox[{
            RowBox[{"getYScroll", "[", "]"}], " ", ":=", "\n", "       ", 
            RowBox[{"getYScroll", "[", 
             RowBox[{"Last", "@", 
              RowBox[{"MousePosition", "[", "\"\<ScreenAbsolute\>\"", "]"}]}],
              "]"}]}]}], ",", "\n", "      ", 
          RowBox[{
           RowBox[{"setYScroll", "[", "y___", "]"}], " ", ":=", "\n", 
           "       ", 
           RowBox[{"scrollY", " ", "=", " ", 
            RowBox[{"getYScroll", "[", "y", "]"}]}]}]}], "\n", "      ", 
         "}"}]}]}], "\n", "    ", "]"}]}], "\n", "   ", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.729096719209998*^9, 3.7290967192131567`*^9}, {
  3.729131841774725*^9, 3.729132211209296*^9}, {3.729132253389089*^9, 
  3.729132315003138*^9}, {3.729132623149572*^9, 
  3.7291326239068727`*^9}},ExpressionUUID->"817b8f44-ab04-465b-bf50-\
304f0363a505"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]DragPane\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.729096664920339*^9, 
  3.7290966661837482`*^9}},ExpressionUUID->"594fd3d1-26ab-47a8-a307-\
d6151556200f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "DragPane", "]"}], " ", "=", "\n", "  ", 
   RowBox[{"Options", "[", "DragPaneDynamicModule", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DragPane", "[", "\n", "   ", 
    RowBox[{"exp_", ",", "\n", "   ", 
     RowBox[{"w", " ", ":", " ", 
      RowBox[{
       RowBox[{"_", "?", "NumericQ"}], " ", "|", " ", "Automatic"}]}], ",", 
     "\n", "   ", 
     RowBox[{"ops", " ", ":", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "   ", "]"}], " ", ":=",
    "\n", "  ", 
   RowBox[{"DragPane", "[", 
    RowBox[{"exp", ",", " ", 
     RowBox[{"{", 
      RowBox[{"w", ",", " ", "Automatic"}], "}"}], ",", " ", "ops"}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DragPane", "[", "\n", "   ", 
    RowBox[{"exp_", ",", "\n", "   ", 
     RowBox[{"ops", " ", ":", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "   ", "]"}], " ", ":=",
    "\n", "  ", 
   RowBox[{"DragPane", "[", 
    RowBox[{"exp", ",", "\n", "    ", 
     RowBox[{"OptionValue", "[", "ImageSize", "]"}], ",", "\n", "   ", 
     "ops"}], "\n", "   ", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Format", "[", 
    RowBox[{
     RowBox[{"dp", " ", ":", " ", "\n", "    ", 
      RowBox[{"DragPane", "[", 
       RowBox[{"exp_", ",", " ", 
        RowBox[{"{", 
         RowBox[{"width_", ",", " ", "height_"}], "}"}], ",", " ", 
        RowBox[{"ops", " ", ":", " ", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], ",", " ", "\n", 
     "   ", "StandardForm"}], "]"}], " ", ":=", "\n", "  ", 
   RowBox[{"Interpretation", "[", "\n", "   ", 
    RowBox[{
     RowBox[{"DragPaneDynamicModule", "[", 
      RowBox[{"exp", ",", " ", 
       RowBox[{"{", 
        RowBox[{"width", ",", " ", "height"}], "}"}], ",", " ", "ops"}], 
      "]"}], ",", "\n", "   ", "dp"}], "\n", "   ", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.729096696923121*^9, 
  3.7290967012163143`*^9}},ExpressionUUID->"dd26f6fe-1525-469a-9c23-\
1ffe1e32fa22"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"a65746c6-b987-4d9e-8c3c-\
7000145bef7c"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"b6c76fd0-61bd-4284-8bbd-\
11a623708d91"]
},
WindowSize->{768, 855},
WindowMargins->{{223, Automatic}, {Automatic, 0}},
TaggingRules->{
 "DocuToolsSettingsInternal" -> {"$CondensedBlogMenus" -> "True"}, 
  "SearchTextTranslated" -> "", "LinkTrails" -> ""},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

